"use strict";var __defProp=Object.defineProperty,__name=(target,value)=>__defProp(target,"name",{value,configurable:!0});exports.id=120,exports.ids=[120],exports.modules={71120:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{UserAccountWrapperModule:()=>UserAccountWrapperModule});var core=__webpack_require__(40305),spartacus_cdc_root=__webpack_require__(95834),spartacus_core=__webpack_require__(46167),fesm2020_forms=__webpack_require__(43070),spartacus_storefront=__webpack_require__(25907),BehaviorSubject=__webpack_require__(60403),from=__webpack_require__(66904),of=__webpack_require__(95202),tap=__webpack_require__(85171),withLatestFrom=__webpack_require__(49320),switchMap=__webpack_require__(63714),common=__webpack_require__(89318),router=__webpack_require__(9664),spartacus_user_account_root=__webpack_require__(89693);function LoginFormComponent_cx_spinner_0_Template(rf,ctx){1&rf&&core._UZ(0,"cx-spinner",8)}__name(LoginFormComponent_cx_spinner_0_Template,"LoginFormComponent_cx_spinner_0_Template");const _c0=__name(function(){return{cxRoute:"forgotPassword"}},"_c0"),_c1=__name(function(){return{cxRoute:"register"}},"_c1");function LoginRegisterComponent_ng_container_4_Template(rf,ctx){1&rf&&(core.ynx(0),core.TgZ(1,"a",3),core.ALo(2,"cxUrl"),core._uU(3),core.ALo(4,"cxTranslate"),core.qZA(),core.BQk()),2&rf&&(core.xp6(1),core.Q6J("routerLink",core.lcZ(2,2,core.DdM(6,_c1))),core.xp6(2),core.Oqu(core.lcZ(4,4,"loginForm.register")))}__name(LoginRegisterComponent_ng_container_4_Template,"LoginRegisterComponent_ng_container_4_Template");const _c2=__name(function(){return{cxRoute:"checkoutLogin"}},"_c2");function LoginRegisterComponent_ng_container_5_Template(rf,ctx){1&rf&&(core.ynx(0),core.TgZ(1,"a",4),core.ALo(2,"cxUrl"),core._uU(3),core.ALo(4,"cxTranslate"),core.qZA(),core.BQk()),2&rf&&(core.xp6(1),core.Q6J("routerLink",core.lcZ(2,2,core.DdM(6,_c2))),core.xp6(2),core.Oqu(core.lcZ(4,4,"loginForm.guestCheckout")))}__name(LoginRegisterComponent_ng_container_5_Template,"LoginRegisterComponent_ng_container_5_Template");const _c3=__name(function(a0){return{name:a0}},"_c3");function LoginComponent_ng_container_0_Template(rf,ctx){if(1&rf&&(core.ynx(0),core.TgZ(1,"div",2),core._uU(2),core.ALo(3,"cxTranslate"),core.qZA(),core._UZ(4,"cx-page-slot",3),core.BQk()),2&rf){const user_r3=ctx.ngIf;core.xp6(2),core.hij(" ",core.xi3(3,1,"miniLogin.userGreeting",core.VKq(4,_c3,user_r3.name))," ")}}__name(LoginComponent_ng_container_0_Template,"LoginComponent_ng_container_0_Template");const _c4=__name(function(){return{cxRoute:"login"}},"_c4");function LoginComponent_ng_template_2_Template(rf,ctx){1&rf&&(core.TgZ(0,"a",4),core.ALo(1,"cxUrl"),core._uU(2),core.ALo(3,"cxTranslate"),core.qZA()),2&rf&&(core.Q6J("routerLink",core.lcZ(1,2,core.DdM(6,_c4))),core.xp6(2),core.Oqu(core.lcZ(3,4,"miniLogin.signInRegister")))}__name(LoginComponent_ng_template_2_Template,"LoginComponent_ng_template_2_Template");const _c5=__name(function(){return{cxRoute:"logout"}},"_c5");function MyAccountV2UserComponent_ng_container_1_Template(rf,ctx){if(1&rf&&(core.ynx(0),core.TgZ(1,"div",2),core._uU(2),core.qZA(),core.TgZ(3,"a",3),core.ALo(4,"cxUrl"),core._uU(5),core.ALo(6,"cxTranslate"),core.qZA(),core.BQk()),2&rf){const user_r1=ctx.ngIf;core.xp6(2),core.AsE("",user_r1.title,"",user_r1.name,""),core.xp6(1),core.Q6J("routerLink",core.lcZ(4,4,core.DdM(8,_c5))),core.xp6(2),core.hij("",core.lcZ(6,6,"myAccountV2User.signOut")," ")}}__name(MyAccountV2UserComponent_ng_container_1_Template,"MyAccountV2UserComponent_ng_container_1_Template");class LoginFormComponentService{constructor(auth,globalMessage,winRef){this.auth=auth,this.globalMessage=globalMessage,this.winRef=winRef,this.busy$=new BehaviorSubject.X(!1),this.isUpdating$=this.busy$.pipe((0,tap.b)(state=>{const userId=this.winRef.nativeWindow?.history?.state?.newUid;userId&&this.form.patchValue({userId}),!0===state?this.form.disable():this.form.enable()})),this.form=new fesm2020_forms.nJ({userId:new fesm2020_forms.p4("",[fesm2020_forms.kI.required,spartacus_storefront.kal.emailValidator]),password:new fesm2020_forms.p4("",fesm2020_forms.kI.required)})}login(){this.form.valid?(this.busy$.next(!0),(0,from.D)(this.auth.loginWithCredentials(this.form.value.userId.toLowerCase(),this.form.value.password)).pipe((0,withLatestFrom.M)(this.auth.isUserLoggedIn()),(0,tap.b)(([_,isLoggedIn])=>this.onSuccess(isLoggedIn))).subscribe()):this.form.markAllAsTouched()}onSuccess(isLoggedIn){isLoggedIn&&(this.globalMessage.remove(spartacus_core.xUg.MSG_TYPE_ERROR),this.form.reset()),this.busy$.next(!1)}}__name(LoginFormComponentService,"LoginFormComponentService"),LoginFormComponentService.\u0275fac=__name(function(t){return new(t||LoginFormComponentService)(core.LFG(spartacus_core.e80),core.LFG(spartacus_core.IWp),core.LFG(spartacus_core.X9E))},"LoginFormComponentService_Factory"),LoginFormComponentService.\u0275prov=core.Yz7({token:LoginFormComponentService,factory:LoginFormComponentService.\u0275fac});class LoginFormComponent{constructor(service){this.service=service,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$,this.style=!0}onSubmit(){this.service.login()}}__name(LoginFormComponent,"LoginFormComponent"),LoginFormComponent.\u0275fac=__name(function(t){return new(t||LoginFormComponent)(core.Y36(LoginFormComponentService))},"LoginFormComponent_Factory"),LoginFormComponent.\u0275cmp=core.Xpm({type:LoginFormComponent,selectors:[["cx-login-form"]],hostVars:2,hostBindings:__name(function(rf,ctx){2&rf&&core.ekj("user-form",ctx.style)},"LoginFormComponent_HostBindings"),decls:25,vars:32,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"label-content"],["required","true","type","email","formControlName","userId",1,"form-control",3,"placeholder"],[3,"control"],["required","true","type","password","formControlName","password","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],[1,"btn-link",3,"routerLink"],["type","submit",1,"btn","btn-block","btn-primary",3,"disabled"],[1,"overlay"]],template:__name(function(rf,ctx){1&rf&&(core.YNc(0,LoginFormComponent_cx_spinner_0_Template,1,0,"cx-spinner",0),core.ALo(1,"async"),core.TgZ(2,"form",1),core.NdJ("ngSubmit",__name(function(){return ctx.onSubmit()},"LoginFormComponent_Template_form_ngSubmit_2_listener")),core.TgZ(3,"label")(4,"span",2),core._uU(5),core.ALo(6,"cxTranslate"),core.qZA(),core._UZ(7,"input",3),core.ALo(8,"cxTranslate"),core._UZ(9,"cx-form-errors",4),core.qZA(),core.TgZ(10,"label")(11,"span",2),core._uU(12),core.ALo(13,"cxTranslate"),core.qZA(),core._UZ(14,"input",5),core.ALo(15,"cxTranslate"),core.ALo(16,"cxTranslate"),core._UZ(17,"cx-form-errors",4),core.qZA(),core.TgZ(18,"a",6),core.ALo(19,"cxUrl"),core._uU(20),core.ALo(21,"cxTranslate"),core.qZA(),core.TgZ(22,"button",7),core._uU(23),core.ALo(24,"cxTranslate"),core.qZA()()),2&rf&&(core.Q6J("ngIf",core.lcZ(1,13,ctx.isUpdating$)),core.xp6(2),core.Q6J("formGroup",ctx.form),core.xp6(3),core.Oqu(core.lcZ(6,15,"loginForm.emailAddress.label")),core.xp6(2),core.s9C("placeholder",core.lcZ(8,17,"loginForm.emailAddress.placeholder")),core.xp6(2),core.Q6J("control",ctx.form.get("userId")),core.xp6(3),core.Oqu(core.lcZ(13,19,"loginForm.password.label")),core.xp6(2),core.s9C("placeholder",core.lcZ(15,21,"loginForm.password.placeholder")),core.uIk("aria-label",core.lcZ(16,23,"loginForm.password.placeholder")),core.xp6(3),core.Q6J("control",ctx.form.get("password")),core.xp6(1),core.Q6J("routerLink",core.lcZ(19,25,core.DdM(31,_c0))),core.xp6(2),core.hij(" ",core.lcZ(21,27,"loginForm.forgotPassword")," "),core.xp6(2),core.Q6J("disabled",ctx.form.disabled),core.xp6(1),core.hij(" ",core.lcZ(24,29,"loginForm.signIn")," "))},"LoginFormComponent_Template"),dependencies:[common.O5,fesm2020_forms._Y,fesm2020_forms.Fj,fesm2020_forms.JJ,fesm2020_forms.JL,fesm2020_forms.Q7,fesm2020_forms.sg,fesm2020_forms.u,router.rH,spartacus_storefront.Ahv,spartacus_storefront.ORR,spartacus_storefront.X84,common.Ov,spartacus_core.l2T,spartacus_core.X$D],encapsulation:2,changeDetection:0});class LoginFormModule{}__name(LoginFormModule,"LoginFormModule"),LoginFormModule.\u0275fac=__name(function(t){return new(t||LoginFormModule)},"LoginFormModule_Factory"),LoginFormModule.\u0275mod=core.oAB({type:LoginFormModule}),LoginFormModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({cmsComponents:{ReturningCustomerLoginComponent:{component:LoginFormComponent,guards:[spartacus_core.aOY],providers:[{provide:LoginFormComponentService,useClass:LoginFormComponentService,deps:[spartacus_core.e80,spartacus_core.IWp,spartacus_core.X9E]}]}}})],imports:[common.ez,fesm2020_forms.u5,fesm2020_forms.UX,router.Bz,spartacus_core.bhT,spartacus_core.LUR,spartacus_storefront.Fym,spartacus_storefront.Fme,spartacus_storefront.Ird]});class LoginRegisterComponent{constructor(activatedRoute){this.activatedRoute=activatedRoute,this.loginAsGuest=!1}ngOnInit(){this.loginAsGuest=this.activatedRoute.snapshot.queryParams.forced}}__name(LoginRegisterComponent,"LoginRegisterComponent"),LoginRegisterComponent.\u0275fac=__name(function(t){return new(t||LoginRegisterComponent)(core.Y36(router.gz))},"LoginRegisterComponent_Factory"),LoginRegisterComponent.\u0275cmp=core.Xpm({type:LoginRegisterComponent,selectors:[["cx-login-register"]],decls:6,vars:5,consts:[[1,"register"],[1,"cx-section-title"],[4,"ngIf"],[1,"btn","btn-block","btn-secondary","btn-register",3,"routerLink"],[1,"btn","btn-block","btn-secondary","btn-guest",3,"routerLink"]],template:__name(function(rf,ctx){1&rf&&(core.TgZ(0,"div",0)(1,"p",1),core._uU(2),core.ALo(3,"cxTranslate"),core.qZA(),core.YNc(4,LoginRegisterComponent_ng_container_4_Template,5,7,"ng-container",2),core.YNc(5,LoginRegisterComponent_ng_container_5_Template,5,7,"ng-container",2),core.qZA()),2&rf&&(core.xp6(2),core.hij(" ",core.lcZ(3,3,"loginForm.dontHaveAccount")," "),core.xp6(2),core.Q6J("ngIf",!ctx.loginAsGuest),core.xp6(1),core.Q6J("ngIf",ctx.loginAsGuest))},"LoginRegisterComponent_Template"),dependencies:[common.O5,router.rH,spartacus_core.l2T,spartacus_core.X$D],encapsulation:2});class LoginRegisterModule{}__name(LoginRegisterModule,"LoginRegisterModule"),LoginRegisterModule.\u0275fac=__name(function(t){return new(t||LoginRegisterModule)},"LoginRegisterModule_Factory"),LoginRegisterModule.\u0275mod=core.oAB({type:LoginRegisterModule}),LoginRegisterModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({cmsComponents:{ReturningCustomerRegisterComponent:{component:LoginRegisterComponent,guards:[spartacus_core.aOY]}}})],imports:[common.ez,router.Bz,spartacus_core.bhT,spartacus_storefront.ISW,spartacus_core.LUR]});class LoginComponent{constructor(auth,userAccount){this.auth=auth,this.userAccount=userAccount}ngOnInit(){this.user$=this.auth.isUserLoggedIn().pipe((0,switchMap.w)(isUserLoggedIn=>isUserLoggedIn?this.userAccount.get():(0,of.of)(void 0)))}}__name(LoginComponent,"LoginComponent"),LoginComponent.\u0275fac=__name(function(t){return new(t||LoginComponent)(core.Y36(spartacus_core.e80),core.Y36(spartacus_user_account_root.gf))},"LoginComponent_Factory"),LoginComponent.\u0275cmp=core.Xpm({type:LoginComponent,selectors:[["cx-login"]],decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["login",""],[1,"cx-login-greet"],["id","account-nav","position","HeaderLinks"],["role","link",3,"routerLink"]],template:__name(function(rf,ctx){if(1&rf&&(core.YNc(0,LoginComponent_ng_container_0_Template,5,6,"ng-container",0),core.ALo(1,"async"),core.YNc(2,LoginComponent_ng_template_2_Template,4,7,"ng-template",null,1,core.W1O)),2&rf){const _r1=core.MAs(3);core.Q6J("ngIf",core.lcZ(1,2,ctx.user$))("ngIfElse",_r1)}},"LoginComponent_Template"),dependencies:[common.O5,router.rH,spartacus_storefront.JSc,common.Ov,spartacus_core.l2T,spartacus_core.X$D],encapsulation:2});class LoginModule{}__name(LoginModule,"LoginModule"),LoginModule.\u0275fac=__name(function(t){return new(t||LoginModule)},"LoginModule_Factory"),LoginModule.\u0275mod=core.oAB({type:LoginModule}),LoginModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({cmsComponents:{LoginComponent:{component:LoginComponent}}})],imports:[common.ez,router.Bz,spartacus_core.bhT,spartacus_storefront.ISW,spartacus_core.LUR]});class MyAccountV2UserComponent extends LoginComponent{}__name(MyAccountV2UserComponent,"MyAccountV2UserComponent"),MyAccountV2UserComponent.\u0275fac=function(){let \u0275MyAccountV2UserComponent_BaseFactory;return __name(function(t){return(\u0275MyAccountV2UserComponent_BaseFactory||(\u0275MyAccountV2UserComponent_BaseFactory=core.n5z(MyAccountV2UserComponent)))(t||MyAccountV2UserComponent)},"MyAccountV2UserComponent_Factory")}(),MyAccountV2UserComponent.\u0275cmp=core.Xpm({type:MyAccountV2UserComponent,selectors:[["cx-my-account-v2-user"]],features:[core.qOj],decls:3,vars:3,consts:[[1,"cx-my-account-v2-user"],[4,"ngIf"],[1,"cx-name"],[1,"cx-sign-out",3,"routerLink"]],template:__name(function(rf,ctx){1&rf&&(core.TgZ(0,"div",0),core.YNc(1,MyAccountV2UserComponent_ng_container_1_Template,7,9,"ng-container",1),core.ALo(2,"async"),core.qZA()),2&rf&&(core.xp6(1),core.Q6J("ngIf",core.lcZ(2,1,ctx.user$)))},"MyAccountV2UserComponent_Template"),dependencies:[common.O5,router.rH,common.Ov,spartacus_core.l2T,spartacus_core.X$D],encapsulation:2});class MyAccountV2UserModule{}__name(MyAccountV2UserModule,"MyAccountV2UserModule"),MyAccountV2UserModule.\u0275fac=__name(function(t){return new(t||MyAccountV2UserModule)},"MyAccountV2UserModule_Factory"),MyAccountV2UserModule.\u0275mod=core.oAB({type:MyAccountV2UserModule}),MyAccountV2UserModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({cmsComponents:{MyAccountViewUserComponent:{component:MyAccountV2UserComponent,guards:[spartacus_core.a1M]}}})],imports:[common.ez,router.Bz,spartacus_core.bhT,spartacus_core.LUR]});class UserAccountComponentsModule{}__name(UserAccountComponentsModule,"UserAccountComponentsModule"),UserAccountComponentsModule.\u0275fac=__name(function(t){return new(t||UserAccountComponentsModule)},"UserAccountComponentsModule_Factory"),UserAccountComponentsModule.\u0275mod=core.oAB({type:UserAccountComponentsModule}),UserAccountComponentsModule.\u0275inj=core.cJS({imports:[LoginModule,LoginFormModule,LoginRegisterModule,MyAccountV2UserModule]});var Subscription=__webpack_require__(31765),take=__webpack_require__(95426),map=__webpack_require__(86466);function CdcReconsentComponent_ng_container_2_div_14_div_1_Template(rf,ctx){if(1&rf){const _r8=core.EpF();core.TgZ(0,"div",15)(1,"cx-consent-management-form",16),core.NdJ("consentChanged",__name(function($event){core.CHM(_r8);const ctx_r7=core.oxw(3);return core.KtG(ctx_r7.onConsentChange($event))},"CdcReconsentComponent_ng_container_2_div_14_div_1_Template_cx_consent_management_form_consentChanged_1_listener")),core.qZA()()}if(2&rf){const consentTemplate_r6=ctx.$implicit;core.xp6(1),core.Q6J("consentTemplate",consentTemplate_r6)}}function CdcReconsentComponent_ng_container_2_div_14_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",13),core.YNc(1,CdcReconsentComponent_ng_container_2_div_14_div_1_Template,2,1,"div",14),core.qZA()),2&rf){const templateList_r4=ctx.ngIf;core.xp6(1),core.Q6J("ngForOf",templateList_r4)}}function CdcReconsentComponent_ng_container_2_Template(rf,ctx){if(1&rf){const _r10=core.EpF();core.ynx(0),core.TgZ(1,"div",4)(2,"h3"),core._uU(3),core.ALo(4,"cxTranslate"),core.qZA(),core.TgZ(5,"button",5),core.NdJ("click",__name(function(){core.CHM(_r10);const ctx_r9=core.oxw();return core.KtG(ctx_r9.dismissDialog("Cross click",ctx_r9.reconsentEvent.errorMessage))},"CdcReconsentComponent_ng_container_2_Template_button_click_5_listener")),core.ALo(6,"cxTranslate"),core.TgZ(7,"span",6),core._UZ(8,"cx-icon",7),core.qZA()()(),core.TgZ(9,"div",8),core._uU(10),core.ALo(11,"cxTranslate"),core._UZ(12,"div",9),core.qZA(),core._UZ(13,"div",10),core.YNc(14,CdcReconsentComponent_ng_container_2_div_14_Template,2,1,"div",11),core.ALo(15,"async"),core.TgZ(16,"div",10)(17,"a",12),core.NdJ("click",__name(function(){core.CHM(_r10);const ctx_r11=core.oxw();return core.KtG(ctx_r11.dismissDialog("Proceed To Login",ctx_r11.reconsentEvent.errorMessage))},"CdcReconsentComponent_ng_container_2_Template_a_click_17_listener")),core._uU(18),core.ALo(19,"cxTranslate"),core.qZA()(),core.BQk()}if(2&rf){const ctx_r0=core.oxw();core.xp6(3),core.hij(" ",core.lcZ(4,8,"reconsent.dialog.title")," "),core.xp6(2),core.uIk("aria-label",core.lcZ(6,10,"common.close")),core.xp6(3),core.Q6J("type",ctx_r0.iconTypes.CLOSE),core.xp6(2),core.hij(" ",core.lcZ(11,12,"reconsent.dialog.description")," "),core.xp6(4),core.Q6J("ngIf",core.lcZ(15,14,ctx_r0.templateList$)),core.xp6(3),core.ekj("disabled",ctx_r0.disableSubmitButton),core.xp6(1),core.Oqu(core.lcZ(19,16,"common.submit"))}}function CdcReconsentComponent_ng_template_4_Template(rf,ctx){1&rf&&core._UZ(0,"cx-spinner")}__name(CdcReconsentComponent_ng_container_2_div_14_div_1_Template,"CdcReconsentComponent_ng_container_2_div_14_div_1_Template"),__name(CdcReconsentComponent_ng_container_2_div_14_Template,"CdcReconsentComponent_ng_container_2_div_14_Template"),__name(CdcReconsentComponent_ng_container_2_Template,"CdcReconsentComponent_ng_container_2_Template"),__name(CdcReconsentComponent_ng_template_4_Template,"CdcReconsentComponent_ng_template_4_Template");class CdcLoginFormComponentService extends LoginFormComponentService{constructor(auth,globalMessageService,winRef,cdcJsService){super(auth,globalMessageService,winRef),this.auth=auth,this.globalMessageService=globalMessageService,this.winRef=winRef,this.cdcJsService=cdcJsService,this.subscription=new Subscription.w}login(){this.form.valid?(this.busy$.next(!0),this.subscription.add(this.cdcJsService.didLoad().subscribe(cdcLoaded=>{cdcLoaded?this.cdcJsService.loginUserWithoutScreenSet(this.form.value.userId.toLowerCase(),this.form.value.password).subscribe({next:()=>this.busy$.next(!1),error:()=>this.busy$.next(!1)}):(this.globalMessageService.add({key:"errorHandlers.scriptFailedToLoad"},spartacus_core.xUg.MSG_TYPE_ERROR),this.busy$.next(!1))}))):this.form.markAllAsTouched()}ngOnDestroy(){this.subscription.unsubscribe()}}__name(CdcLoginFormComponentService,"CdcLoginFormComponentService"),CdcLoginFormComponentService.\u0275fac=__name(function(t){return new(t||CdcLoginFormComponentService)(core.LFG(spartacus_core.e80),core.LFG(spartacus_core.IWp),core.LFG(spartacus_core.X9E),core.LFG(spartacus_cdc_root.bF))},"CdcLoginFormComponentService_Factory"),CdcLoginFormComponentService.\u0275prov=core.Yz7({token:CdcLoginFormComponentService,factory:CdcLoginFormComponentService.\u0275fac});class CdcReconsentDialogEventListener{constructor(eventService,launchDialogService){this.eventService=eventService,this.launchDialogService=launchDialogService,this.subscription=new Subscription.w,this.onReconsent()}onReconsent(){this.subscription.add(this.eventService.get(spartacus_cdc_root.P8).subscribe(event=>{this.openDialog(event)}))}openDialog(event){const reconsentData={user:event.user,password:event.password,consentIds:event.consentIds,errorMessage:event.errorMessage,regToken:event.regToken},dialog=this.launchDialogService.openDialog("CDC_RECONSENT",void 0,void 0,reconsentData);dialog&&dialog.pipe((0,take.q)(1)).subscribe()}ngOnDestroy(){this.subscription?.unsubscribe()}}__name(CdcReconsentDialogEventListener,"CdcReconsentDialogEventListener"),CdcReconsentDialogEventListener.\u0275fac=__name(function(t){return new(t||CdcReconsentDialogEventListener)(core.LFG(spartacus_core.POd),core.LFG(spartacus_storefront.Q3W))},"CdcReconsentDialogEventListener_Factory"),CdcReconsentDialogEventListener.\u0275prov=core.Yz7({token:CdcReconsentDialogEventListener,factory:CdcReconsentDialogEventListener.\u0275fac,providedIn:"root"});class CdcReconsentComponentService{constructor(cdcUserConsentService,cdcJsService,globalMessageService,launchDialogService){this.cdcUserConsentService=cdcUserConsentService,this.cdcJsService=cdcJsService,this.globalMessageService=globalMessageService,this.launchDialogService=launchDialogService,this.subscription=new Subscription.w}saveConsentAndLogin(consentId,userParams){this.subscription.add(this.cdcJsService.didLoad().subscribe(cdcLoaded=>{cdcLoaded?this.cdcUserConsentService.updateCdcConsent(!0,consentId,userParams?.user,userParams?.regToken).subscribe({next:result=>{0===result?.errorCode&&this.cdcJsService.loginUserWithoutScreenSet(userParams.user,userParams.password).subscribe(()=>{this.launchDialogService.closeDialog("relogin triggered")})},error:error=>{this.handleReconsentUpdateError("Reconsent Error",error?.message)}}):this.globalMessageService.add({key:"errorHandlers.scriptFailedToLoad"},spartacus_core.xUg.MSG_TYPE_ERROR)}))}handleReconsentUpdateError(reason,errorMessage){this.launchDialogService.closeDialog(reason),errorMessage&&this.globalMessageService.add({key:"httpHandlers.badRequestPleaseLoginAgain",params:{errorMessage}},spartacus_core.xUg.MSG_TYPE_ERROR)}ngOnDestroy(){this.subscription.unsubscribe()}}__name(CdcReconsentComponentService,"CdcReconsentComponentService"),CdcReconsentComponentService.\u0275fac=__name(function(t){return new(t||CdcReconsentComponentService)(core.LFG(spartacus_cdc_root.i_),core.LFG(spartacus_cdc_root.bF),core.LFG(spartacus_core.IWp),core.LFG(spartacus_storefront.Q3W))},"CdcReconsentComponentService_Factory"),CdcReconsentComponentService.\u0275prov=core.Yz7({token:CdcReconsentComponentService,factory:CdcReconsentComponentService.\u0275fac,providedIn:"root"});class CdcReconsentComponent{constructor(launchDialogService,anonymousConsentsService,cdcReconsentService){this.launchDialogService=launchDialogService,this.anonymousConsentsService=anonymousConsentsService,this.cdcReconsentService=cdcReconsentService,this.subscription=new Subscription.w,this.form=new fesm2020_forms.nJ({}),this.iconTypes=spartacus_storefront.e1G,this.loaded$=(0,of.of)(!1),this.reconsentEvent={},this.selectedConsents=[],this.disableSubmitButton=!0,this.totalConsents=0,this.focusConfig={trap:!0,block:!0,autofocus:"button",focusOnEscape:!0}}ngOnInit(){this.subscription.add(this.launchDialogService.data$.subscribe(data=>{this.reconsentEvent.user=data.user,this.reconsentEvent.password=data.password,this.reconsentEvent.regToken=data.regToken,this.reconsentEvent.errorMessage=data.errorMessage,this.loadConsents(data.consentIds)}))}loadConsents(reconsentIds){this.templateList$=this.anonymousConsentsService.getTemplates(!0).pipe((0,map.U)(templateList=>{const output=[];return templateList.forEach(template=>{template.id&&reconsentIds.includes(template.id)&&output.push(template)}),this.totalConsents=output.length,output})),this.loaded$=(0,of.of)(!0)}onConsentChange(event){if(!1===event.given&&event.template?.id){const index=this.selectedConsents.indexOf(event.template.id);-1!==index&&this.selectedConsents.splice(index,1)}else!0===event.given&&event.template?.id&&this.selectedConsents.push(event.template.id);this.totalConsents===this.selectedConsents.length?this.disableSubmitButton=!1:this.disableSubmitButton=!0}dismissDialog(reason,message){"Proceed To Login"===reason?(this.loaded$=(0,of.of)(!1),this.cdcReconsentService.saveConsentAndLogin(this.selectedConsents,this.reconsentEvent)):this.cdcReconsentService.handleReconsentUpdateError(reason,message)}ngOnDestroy(){this.subscription?.unsubscribe()}}__name(CdcReconsentComponent,"CdcReconsentComponent"),CdcReconsentComponent.\u0275fac=__name(function(t){return new(t||CdcReconsentComponent)(core.Y36(spartacus_storefront.Q3W),core.Y36(spartacus_core.NpW),core.Y36(CdcReconsentComponentService))},"CdcReconsentComponent_Factory"),CdcReconsentComponent.\u0275cmp=core.Xpm({type:CdcReconsentComponent,selectors:[["cx-anonymous-consent-dialog"]],decls:6,vars:5,consts:[[1,"cx-anonymous-consent-dialog",3,"cxFocus","esc"],[1,"cx-dialog-content"],[4,"ngIf","ngIfElse"],["loading",""],[1,"cx-dialog-header"],["type","button",1,"close",3,"click"],["aria-hidden","true"],[3,"type"],[1,"cx-dialog-description"],[1,"cx-dialog-separator","col-sm-12","d-xs-block","d-sm-block","d-md-none"],[1,"cx-dialog-buttons"],["class","cx-dialog-body",4,"ngIf"],["autofocus","",1,"btn","btn-primary",3,"click"],[1,"cx-dialog-body"],["class","cx-dialog-row col-sm-12 col-md-6",4,"ngFor","ngForOf"],[1,"cx-dialog-row","col-sm-12","col-md-6"],[3,"consentTemplate","consentChanged"]],template:__name(function(rf,ctx){if(1&rf&&(core.TgZ(0,"div",0),core.NdJ("esc",__name(function(){return ctx.dismissDialog("Escape pressed",ctx.reconsentEvent.errorMessage)},"CdcReconsentComponent_Template_div_esc_0_listener")),core.TgZ(1,"div",1),core.YNc(2,CdcReconsentComponent_ng_container_2_Template,20,18,"ng-container",2),core.ALo(3,"async"),core.qZA(),core.YNc(4,CdcReconsentComponent_ng_template_4_Template,1,0,"ng-template",null,3,core.W1O),core.qZA()),2&rf){const _r1=core.MAs(5);core.Q6J("cxFocus",ctx.focusConfig),core.xp6(2),core.Q6J("ngIf",core.lcZ(3,3,ctx.loaded$))("ngIfElse",_r1)}},"CdcReconsentComponent_Template"),dependencies:[common.sg,common.O5,spartacus_storefront.ORR,spartacus_storefront.oJW,spartacus_storefront.RRe,spartacus_storefront.UW2,common.Ov,spartacus_core.X$D],encapsulation:2,changeDetection:0});const defaultCdcReconsentLayoutConfig={launch:{CDC_RECONSENT:{inlineRoot:!0,component:CdcReconsentComponent,dialogType:spartacus_storefront.Myk.DIALOG}}};class CdcReconsentModule{constructor(_cdcReconsentDialogEventListener){}}__name(CdcReconsentModule,"CdcReconsentModule"),CdcReconsentModule.\u0275fac=__name(function(t){return new(t||CdcReconsentModule)(core.LFG(CdcReconsentDialogEventListener))},"CdcReconsentModule_Factory"),CdcReconsentModule.\u0275mod=core.oAB({type:CdcReconsentModule}),CdcReconsentModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)(defaultCdcReconsentLayoutConfig)],imports:[common.ez,spartacus_storefront.Fme,spartacus_storefront.QX1,spartacus_core.LUR,spartacus_storefront.oPH,spartacus_storefront.T2n]});class CDCLoginFormModule{}__name(CDCLoginFormModule,"CDCLoginFormModule"),CDCLoginFormModule.\u0275fac=__name(function(t){return new(t||CDCLoginFormModule)},"CDCLoginFormModule_Factory"),CDCLoginFormModule.\u0275mod=core.oAB({type:CDCLoginFormModule}),CDCLoginFormModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({cmsComponents:{ReturningCustomerLoginComponent:{component:LoginFormComponent,providers:[{provide:LoginFormComponentService,useClass:CdcLoginFormComponentService,deps:[spartacus_core.e80,spartacus_core.IWp,spartacus_core.X9E,spartacus_cdc_root.bF]}]}}})],imports:[common.ez,fesm2020_forms.u5,fesm2020_forms.UX,router.Bz,spartacus_core.bhT,spartacus_core.LUR,spartacus_storefront.Fym,spartacus_storefront.Fme,CdcReconsentModule]});class CDCUserAccountModule{}__name(CDCUserAccountModule,"CDCUserAccountModule"),CDCUserAccountModule.\u0275fac=__name(function(t){return new(t||CDCUserAccountModule)},"CDCUserAccountModule_Factory"),CDCUserAccountModule.\u0275mod=core.oAB({type:CDCUserAccountModule}),CDCUserAccountModule.\u0275inj=core.cJS({imports:[CDCLoginFormModule]});const USER_ACCOUNT_NORMALIZER=new core.OlP("UserAccountNormalizer");new core.OlP("UserAccountSerializer");class UserAccountAdapter{}__name(UserAccountAdapter,"UserAccountAdapter");class UserAccountConnector{constructor(adapter){this.adapter=adapter}get(userId){return this.adapter.load(userId)}}__name(UserAccountConnector,"UserAccountConnector"),UserAccountConnector.\u0275fac=__name(function(t){return new(t||UserAccountConnector)(core.LFG(UserAccountAdapter))},"UserAccountConnector_Factory"),UserAccountConnector.\u0275prov=core.Yz7({token:UserAccountConnector,factory:UserAccountConnector.\u0275fac});class UserAccountService{constructor(userAccountConnector,userIdService,query){this.userAccountConnector=userAccountConnector,this.userIdService=userIdService,this.query=query,this.userQuery=this.query.create(()=>this.userIdService.takeUserId(!0).pipe((0,switchMap.w)(userId=>this.userAccountConnector.get(userId))),{reloadOn:[spartacus_user_account_root.x7],resetOn:[spartacus_core.p1J,spartacus_core.rX_]})}getById(userId){return this.userAccountConnector.get(userId)}get(){return this.userQuery.get()}}__name(UserAccountService,"UserAccountService"),UserAccountService.\u0275fac=__name(function(t){return new(t||UserAccountService)(core.LFG(UserAccountConnector),core.LFG(spartacus_core.XBV),core.LFG(spartacus_core._7J))},"UserAccountService_Factory"),UserAccountService.\u0275prov=core.Yz7({token:UserAccountService,factory:UserAccountService.\u0275fac});const facadeProviders=[UserAccountService,{provide:spartacus_user_account_root.gf,useExisting:UserAccountService}];class UserAccountCoreModule{}__name(UserAccountCoreModule,"UserAccountCoreModule"),UserAccountCoreModule.\u0275fac=__name(function(t){return new(t||UserAccountCoreModule)},"UserAccountCoreModule_Factory"),UserAccountCoreModule.\u0275mod=core.oAB({type:UserAccountCoreModule}),UserAccountCoreModule.\u0275inj=core.cJS({providers:[UserAccountConnector,...facadeProviders]});var throwError=__webpack_require__(84724),catchError=__webpack_require__(2155),http=__webpack_require__(48664);class OccUserAccountAdapter{constructor(http2,occEndpoints,converter){this.http=http2,this.occEndpoints=occEndpoints,this.converter=converter,this.logger=(0,core.f3M)(spartacus_core.mQy)}load(userId){const url=this.occEndpoints.buildUrl("user",{urlParams:{userId}});return this.http.get(url).pipe((0,catchError.K)(error=>(0,throwError._)((0,spartacus_core.cxH)(error,this.logger))),this.converter.pipeable(USER_ACCOUNT_NORMALIZER))}}__name(OccUserAccountAdapter,"OccUserAccountAdapter"),OccUserAccountAdapter.\u0275fac=__name(function(t){return new(t||OccUserAccountAdapter)(core.LFG(http.eN),core.LFG(spartacus_core.Lz0),core.LFG(spartacus_core.IXI))},"OccUserAccountAdapter_Factory"),OccUserAccountAdapter.\u0275prov=core.Yz7({token:OccUserAccountAdapter,factory:OccUserAccountAdapter.\u0275fac});class UserAccountOccModule{}__name(UserAccountOccModule,"UserAccountOccModule"),UserAccountOccModule.\u0275fac=__name(function(t){return new(t||UserAccountOccModule)},"UserAccountOccModule_Factory"),UserAccountOccModule.\u0275mod=core.oAB({type:UserAccountOccModule}),UserAccountOccModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({backend:{occ:{endpoints:{user:"users/${userId}"}}}}),{provide:UserAccountAdapter,useClass:OccUserAccountAdapter}]});class UserAccountModule{}__name(UserAccountModule,"UserAccountModule"),UserAccountModule.\u0275fac=__name(function(t){return new(t||UserAccountModule)},"UserAccountModule_Factory"),UserAccountModule.\u0275mod=core.oAB({type:UserAccountModule}),UserAccountModule.\u0275inj=core.cJS({imports:[UserAccountCoreModule,UserAccountOccModule,UserAccountComponentsModule]});const extensions=[];__webpack_require__(90595).N.cdc&&extensions.push(CDCUserAccountModule);class UserAccountWrapperModule{}__name(UserAccountWrapperModule,"UserAccountWrapperModule"),UserAccountWrapperModule.\u0275fac=__name(function(t){return new(t||UserAccountWrapperModule)},"UserAccountWrapperModule_Factory"),UserAccountWrapperModule.\u0275mod=core.oAB({type:UserAccountWrapperModule}),UserAccountWrapperModule.\u0275inj=core.cJS({imports:[UserAccountModule,extensions]})}};