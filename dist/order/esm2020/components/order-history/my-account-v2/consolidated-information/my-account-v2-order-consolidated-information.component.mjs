/*
 * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>
 *
 * SPDX-License-Identifier: Apache-2.0
 */
import { Component, ChangeDetectionStrategy, Input, inject, } from '@angular/core';
import { MyAccountV2OrderConsignmentsService } from '../../../order-details';
import { OrderCriticalStatus } from '../my-account-v2-order-history.model';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "@angular/router";
import * as i3 from "@spartacus/storefront";
import * as i4 from "../consignment-entries/my-account-v2-consignment-entries.component";
import * as i5 from "@spartacus/core";
export class MyAccountV2OrderConsolidatedInformationComponent {
    constructor() {
        this.orderConsignmentsService = inject(MyAccountV2OrderConsignmentsService);
        this.criticalStatuses = Object.values(OrderCriticalStatus);
        this.IMAGE_COUNT = 4; //showing fixed no.of images, without using carousel
    }
    getConsignmentsCount(consignments) {
        let count = 0;
        if (consignments) {
            for (const consignment of consignments) {
                if (consignment.entries) {
                    count = count + consignment.entries.length;
                }
            }
        }
        return count;
    }
    getOrderEntriesCount(orderEntries) {
        return orderEntries?.length ?? 0;
    }
    isStatusCritical(status) {
        return this.criticalStatuses.includes(status.toUpperCase());
    }
    getPickupConsignments(consignments) {
        const orderDetail = {};
        orderDetail.consignments = consignments;
        return (this.orderConsignmentsService.getGroupedConsignments(orderDetail, true) ??
            []);
    }
    getDeliveryConsignments(consignments) {
        const orderDetail = {};
        orderDetail.consignments = consignments;
        return (this.orderConsignmentsService.getGroupedConsignments(orderDetail, false) ?? []);
    }
    getDeliveryUnconsignedEntries(unconsignedEntries) {
        const orderDetail = {};
        orderDetail.unconsignedEntries = unconsignedEntries;
        return (this.orderConsignmentsService.getUnconsignedEntries(orderDetail, false) ??
            []);
    }
    getPickupUnconsignedEntries(unconsignedEntries) {
        const orderDetail = {};
        orderDetail.unconsignedEntries = unconsignedEntries;
        return (this.orderConsignmentsService.getUnconsignedEntries(orderDetail, true) ??
            []);
    }
    getProductImages(entries) {
        const images = [];
        let index = 0;
        for (const item of entries) {
            if (item.product?.images) {
                if (index >= this.IMAGE_COUNT) {
                    break;
                }
                index++;
                images.push(item.product?.images);
            }
        }
        return images;
    }
}
MyAccountV2OrderConsolidatedInformationComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: MyAccountV2OrderConsolidatedInformationComponent, deps: [], target: i0.ɵɵFactoryTarget.Component });
MyAccountV2OrderConsolidatedInformationComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.9", type: MyAccountV2OrderConsolidatedInformationComponent, selector: "cx-my-account-v2-order-consolidated-information", inputs: { order: "order" }, ngImport: i0, template: "<div class=\"cx-consolidated-order-info\" *ngIf=\"order\">\n  <div class=\"cx-order-info\">\n    <!-- pickup consigned entries \n  eg: To Be Picked Up - 3 Items\n  -->\n    <div\n      *ngIf=\"\n        getConsignmentsCount(getPickupConsignments(order.consignments ?? [])) >\n        0\n      \"\n    >\n      <div class=\"cx-order-status\">\n        {{\n          'myAccountV2OrderHistory.deliveryPointOfServiceDetails.itemsToBePickUp'\n            | cxTranslate\n        }}\n        <ng-container\n          *ngTemplateOutlet=\"\n            showManyItems;\n            context: {\n              count: getConsignmentsCount(\n                getPickupConsignments(order.consignments ?? [])\n              )\n            }\n          \"\n        ></ng-container>\n      </div>\n      <cx-my-account-v2-consignment-entries\n        [orderCode]=\"order.code ?? ''\"\n        [consignments]=\"getPickupConsignments(order.consignments ?? [])\"\n      ></cx-my-account-v2-consignment-entries>\n    </div>\n\n    <!-- delivery consigned entries\n  eg: To Be Shipped - 6 Items\n  -->\n    <div\n      *ngIf=\"\n        getConsignmentsCount(\n          getDeliveryConsignments(order.consignments ?? [])\n        ) > 0\n      \"\n    >\n      <!--heading taken from feature-libs/order/components/order-confirmation/order-confirmation-shipping/order-confirmation-shipping.component.html-->\n      <!--instead of [cxOutlet]=\"OrderOutlets.CONSIGNMENT_DELIVERY_INFO\"-->\n      <div class=\"cx-order-status\">\n        {{\n          'myAccountV2OrderHistory.checkoutMode.deliveryEntries' | cxTranslate\n        }}\n        <ng-container\n          *ngTemplateOutlet=\"\n            showManyItems;\n            context: {\n              count: getConsignmentsCount(\n                getDeliveryConsignments(order.consignments ?? [])\n              )\n            }\n          \"\n        ></ng-container>\n      </div>\n      <cx-my-account-v2-consignment-entries\n        [orderCode]=\"order.code ?? ''\"\n        [consignments]=\"getDeliveryConsignments(order.consignments ?? [])\"\n      ></cx-my-account-v2-consignment-entries>\n    </div>\n\n    <!-- unconsigned entries \n  eg: Some_Status - 1 Item\n  -->\n    <div *ngIf=\"getOrderEntriesCount(order.unconsignedEntries) > 0\">\n      <div *ngIf=\"order.statusDisplay\">\n        <div\n          class=\"cx-order-status-critical\"\n          *ngIf=\"isStatusCritical(order.statusDisplay); else nonCritical\"\n        >\n          {{\n            'orderDetails.statusDisplay_' + order.statusDisplay | cxTranslate\n          }}\n          -\n          <ng-container\n            *ngTemplateOutlet=\"\n              showManyItems;\n              context: { count: getOrderEntriesCount(order.unconsignedEntries) }\n            \"\n          ></ng-container>\n        </div>\n        <ng-template #nonCritical>\n          <div class=\"cx-order-status\">\n            {{\n              'orderDetails.statusDisplay_' + order.statusDisplay | cxTranslate\n            }}\n            -\n            <ng-container\n              *ngTemplateOutlet=\"\n                showManyItems;\n                context: {\n                  count: getOrderEntriesCount(order.unconsignedEntries)\n                }\n              \"\n            ></ng-container>\n          </div>\n        </ng-template>\n      </div>\n\n      <!-- delivery unconsigned entries \n      eg: To Be Shipped - 6 Items //showing this is in extra information format\n    -->\n      <div\n        class=\"cx-consignment-info\"\n        *ngIf=\"\n          getOrderEntriesCount(\n            getDeliveryUnconsignedEntries(order.unconsignedEntries ?? [])\n          ) > 0\n        \"\n      >\n        {{\n          'myAccountV2OrderHistory.checkoutMode.deliveryEntries' | cxTranslate\n        }}\n        <ng-container\n          *ngTemplateOutlet=\"\n            showManyItems;\n            context: {\n              count: getOrderEntriesCount(\n                getDeliveryUnconsignedEntries(order.unconsignedEntries ?? [])\n              )\n            }\n          \"\n        ></ng-container>\n      </div>\n\n      <!-- pickup unconsigned entries, b2b does not have pickup items\n      eg: To Be Picked Up - 7 Items //showing this is as an extra information format\n    -->\n      <div\n        class=\"cx-consignment-info\"\n        *ngIf=\"\n          getOrderEntriesCount(\n            getPickupUnconsignedEntries(order.unconsignedEntries ?? [])\n          ) > 0\n        \"\n      >\n        {{\n          'myAccountV2OrderHistory.checkoutPickupInStore.heading' | cxTranslate\n        }}\n        <ng-container\n          *ngTemplateOutlet=\"\n            showManyItems;\n            context: {\n              count: getOrderEntriesCount(\n                getPickupUnconsignedEntries(order.unconsignedEntries ?? [])\n              )\n            }\n          \"\n        ></ng-container>\n      </div>\n    </div>\n\n    <!--return request details\n  eg: Returned: 2 Items\n      Return Processed: 15, September, 2022\n  -->\n    <div *ngFor=\"let returnRequest of order.returnRequests\">\n      <div class=\"cx-order-status-critical\">\n        {{ 'returnRequestList.returnRequestId' | cxTranslate }}\n        <a\n          *ngIf=\"returnRequest.rma; else showReturnCode\"\n          [routerLink]=\"\n            {\n              cxRoute: 'returnRequestDetails',\n              params: returnRequest\n            } | cxUrl\n          \"\n          class=\"cx-order-status-critical-link\"\n        >\n          {{ returnRequest.rma }}</a\n        >\n      </div>\n      <ng-template #showReturnCode>\n        {{ returnRequest.code }}\n      </ng-template>\n      <div\n        class=\"cx-consignment-info\"\n        *ngIf=\"returnRequest.creationTime as creationTime\"\n      >\n        {{\n          'myAccountV2OrderHistory.returnProcessed'\n            | cxTranslate: { param: creationTime | cxDate: 'd, MMMM, yyyy' }\n        }}\n      </div>\n    </div>\n  </div>\n  <div class=\"cx-order-images-container\">\n    <ng-container *ngIf=\"order.entries\">\n      <ng-container *ngFor=\"let item of getProductImages(order.entries)\">\n        <cx-media\n          [container]=\"item.PRIMARY\"\n          class=\"cx-order-img\"\n          format=\"thumbnail\"\n          role=\"presentation\"\n        ></cx-media>\n      </ng-container>\n    </ng-container>\n  </div>\n</div>\n\n<ng-template #showManyItems let-count=\"count\">\n  <ng-container *ngIf=\"count > 1; else showOneItem\">\n    {{ 'myAccountV2OrderHistory.items' | cxTranslate: { param: count } }}\n  </ng-container>\n</ng-template>\n<ng-template #showOneItem>\n  {{ 'myAccountV2OrderHistory.item' | cxTranslate: { param: 1 } }}\n</ng-template>\n", dependencies: [{ kind: "directive", type: i1.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i1.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "directive", type: i2.RouterLink, selector: "[routerLink]", inputs: ["target", "queryParams", "fragment", "queryParamsHandling", "state", "relativeTo", "preserveFragment", "skipLocationChange", "replaceUrl", "routerLink"] }, { kind: "component", type: i3.MediaComponent, selector: "cx-media", inputs: ["container", "format", "alt", "role", "loading"], outputs: ["loaded"] }, { kind: "component", type: i4.MyAccountV2ConsignmentEntriesComponent, selector: "cx-my-account-v2-consignment-entries", inputs: ["consignments", "orderCode"] }, { kind: "pipe", type: i5.UrlPipe, name: "cxUrl" }, { kind: "pipe", type: i5.TranslatePipe, name: "cxTranslate" }, { kind: "pipe", type: i5.CxDatePipe, name: "cxDate" }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: MyAccountV2OrderConsolidatedInformationComponent, decorators: [{
            type: Component,
            args: [{ selector: 'cx-my-account-v2-order-consolidated-information', changeDetection: ChangeDetectionStrategy.OnPush, template: "<div class=\"cx-consolidated-order-info\" *ngIf=\"order\">\n  <div class=\"cx-order-info\">\n    <!-- pickup consigned entries \n  eg: To Be Picked Up - 3 Items\n  -->\n    <div\n      *ngIf=\"\n        getConsignmentsCount(getPickupConsignments(order.consignments ?? [])) >\n        0\n      \"\n    >\n      <div class=\"cx-order-status\">\n        {{\n          'myAccountV2OrderHistory.deliveryPointOfServiceDetails.itemsToBePickUp'\n            | cxTranslate\n        }}\n        <ng-container\n          *ngTemplateOutlet=\"\n            showManyItems;\n            context: {\n              count: getConsignmentsCount(\n                getPickupConsignments(order.consignments ?? [])\n              )\n            }\n          \"\n        ></ng-container>\n      </div>\n      <cx-my-account-v2-consignment-entries\n        [orderCode]=\"order.code ?? ''\"\n        [consignments]=\"getPickupConsignments(order.consignments ?? [])\"\n      ></cx-my-account-v2-consignment-entries>\n    </div>\n\n    <!-- delivery consigned entries\n  eg: To Be Shipped - 6 Items\n  -->\n    <div\n      *ngIf=\"\n        getConsignmentsCount(\n          getDeliveryConsignments(order.consignments ?? [])\n        ) > 0\n      \"\n    >\n      <!--heading taken from feature-libs/order/components/order-confirmation/order-confirmation-shipping/order-confirmation-shipping.component.html-->\n      <!--instead of [cxOutlet]=\"OrderOutlets.CONSIGNMENT_DELIVERY_INFO\"-->\n      <div class=\"cx-order-status\">\n        {{\n          'myAccountV2OrderHistory.checkoutMode.deliveryEntries' | cxTranslate\n        }}\n        <ng-container\n          *ngTemplateOutlet=\"\n            showManyItems;\n            context: {\n              count: getConsignmentsCount(\n                getDeliveryConsignments(order.consignments ?? [])\n              )\n            }\n          \"\n        ></ng-container>\n      </div>\n      <cx-my-account-v2-consignment-entries\n        [orderCode]=\"order.code ?? ''\"\n        [consignments]=\"getDeliveryConsignments(order.consignments ?? [])\"\n      ></cx-my-account-v2-consignment-entries>\n    </div>\n\n    <!-- unconsigned entries \n  eg: Some_Status - 1 Item\n  -->\n    <div *ngIf=\"getOrderEntriesCount(order.unconsignedEntries) > 0\">\n      <div *ngIf=\"order.statusDisplay\">\n        <div\n          class=\"cx-order-status-critical\"\n          *ngIf=\"isStatusCritical(order.statusDisplay); else nonCritical\"\n        >\n          {{\n            'orderDetails.statusDisplay_' + order.statusDisplay | cxTranslate\n          }}\n          -\n          <ng-container\n            *ngTemplateOutlet=\"\n              showManyItems;\n              context: { count: getOrderEntriesCount(order.unconsignedEntries) }\n            \"\n          ></ng-container>\n        </div>\n        <ng-template #nonCritical>\n          <div class=\"cx-order-status\">\n            {{\n              'orderDetails.statusDisplay_' + order.statusDisplay | cxTranslate\n            }}\n            -\n            <ng-container\n              *ngTemplateOutlet=\"\n                showManyItems;\n                context: {\n                  count: getOrderEntriesCount(order.unconsignedEntries)\n                }\n              \"\n            ></ng-container>\n          </div>\n        </ng-template>\n      </div>\n\n      <!-- delivery unconsigned entries \n      eg: To Be Shipped - 6 Items //showing this is in extra information format\n    -->\n      <div\n        class=\"cx-consignment-info\"\n        *ngIf=\"\n          getOrderEntriesCount(\n            getDeliveryUnconsignedEntries(order.unconsignedEntries ?? [])\n          ) > 0\n        \"\n      >\n        {{\n          'myAccountV2OrderHistory.checkoutMode.deliveryEntries' | cxTranslate\n        }}\n        <ng-container\n          *ngTemplateOutlet=\"\n            showManyItems;\n            context: {\n              count: getOrderEntriesCount(\n                getDeliveryUnconsignedEntries(order.unconsignedEntries ?? [])\n              )\n            }\n          \"\n        ></ng-container>\n      </div>\n\n      <!-- pickup unconsigned entries, b2b does not have pickup items\n      eg: To Be Picked Up - 7 Items //showing this is as an extra information format\n    -->\n      <div\n        class=\"cx-consignment-info\"\n        *ngIf=\"\n          getOrderEntriesCount(\n            getPickupUnconsignedEntries(order.unconsignedEntries ?? [])\n          ) > 0\n        \"\n      >\n        {{\n          'myAccountV2OrderHistory.checkoutPickupInStore.heading' | cxTranslate\n        }}\n        <ng-container\n          *ngTemplateOutlet=\"\n            showManyItems;\n            context: {\n              count: getOrderEntriesCount(\n                getPickupUnconsignedEntries(order.unconsignedEntries ?? [])\n              )\n            }\n          \"\n        ></ng-container>\n      </div>\n    </div>\n\n    <!--return request details\n  eg: Returned: 2 Items\n      Return Processed: 15, September, 2022\n  -->\n    <div *ngFor=\"let returnRequest of order.returnRequests\">\n      <div class=\"cx-order-status-critical\">\n        {{ 'returnRequestList.returnRequestId' | cxTranslate }}\n        <a\n          *ngIf=\"returnRequest.rma; else showReturnCode\"\n          [routerLink]=\"\n            {\n              cxRoute: 'returnRequestDetails',\n              params: returnRequest\n            } | cxUrl\n          \"\n          class=\"cx-order-status-critical-link\"\n        >\n          {{ returnRequest.rma }}</a\n        >\n      </div>\n      <ng-template #showReturnCode>\n        {{ returnRequest.code }}\n      </ng-template>\n      <div\n        class=\"cx-consignment-info\"\n        *ngIf=\"returnRequest.creationTime as creationTime\"\n      >\n        {{\n          'myAccountV2OrderHistory.returnProcessed'\n            | cxTranslate: { param: creationTime | cxDate: 'd, MMMM, yyyy' }\n        }}\n      </div>\n    </div>\n  </div>\n  <div class=\"cx-order-images-container\">\n    <ng-container *ngIf=\"order.entries\">\n      <ng-container *ngFor=\"let item of getProductImages(order.entries)\">\n        <cx-media\n          [container]=\"item.PRIMARY\"\n          class=\"cx-order-img\"\n          format=\"thumbnail\"\n          role=\"presentation\"\n        ></cx-media>\n      </ng-container>\n    </ng-container>\n  </div>\n</div>\n\n<ng-template #showManyItems let-count=\"count\">\n  <ng-container *ngIf=\"count > 1; else showOneItem\">\n    {{ 'myAccountV2OrderHistory.items' | cxTranslate: { param: count } }}\n  </ng-container>\n</ng-template>\n<ng-template #showOneItem>\n  {{ 'myAccountV2OrderHistory.item' | cxTranslate: { param: 1 } }}\n</ng-template>\n" }]
        }], propDecorators: { order: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXktYWNjb3VudC12Mi1vcmRlci1jb25zb2xpZGF0ZWQtaW5mb3JtYXRpb24uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vZmVhdHVyZS1saWJzL29yZGVyL2NvbXBvbmVudHMvb3JkZXItaGlzdG9yeS9teS1hY2NvdW50LXYyL2NvbnNvbGlkYXRlZC1pbmZvcm1hdGlvbi9teS1hY2NvdW50LXYyLW9yZGVyLWNvbnNvbGlkYXRlZC1pbmZvcm1hdGlvbi5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi8uLi9mZWF0dXJlLWxpYnMvb3JkZXIvY29tcG9uZW50cy9vcmRlci1oaXN0b3J5L215LWFjY291bnQtdjIvY29uc29saWRhdGVkLWluZm9ybWF0aW9uL215LWFjY291bnQtdjItb3JkZXItY29uc29saWRhdGVkLWluZm9ybWF0aW9uLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7O0dBSUc7QUFFSCxPQUFPLEVBQ0wsU0FBUyxFQUNULHVCQUF1QixFQUN2QixLQUFLLEVBQ0wsTUFBTSxHQUNQLE1BQU0sZUFBZSxDQUFDO0FBR3ZCLE9BQU8sRUFBRSxtQ0FBbUMsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBTTdFLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLHNDQUFzQyxDQUFDOzs7Ozs7O0FBTzNFLE1BQU0sT0FBTyxnREFBZ0Q7SUFMN0Q7UUFNWSw2QkFBd0IsR0FBRyxNQUFNLENBQ3pDLG1DQUFtQyxDQUNwQyxDQUFDO1FBQ1EscUJBQWdCLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO1FBRzdDLGdCQUFXLEdBQUcsQ0FBQyxDQUFDLENBQUMsb0RBQW9EO0tBd0V6RjtJQXZFQyxvQkFBb0IsQ0FBQyxZQUEyQztRQUM5RCxJQUFJLEtBQUssR0FBRyxDQUFDLENBQUM7UUFDZCxJQUFJLFlBQVksRUFBRTtZQUNoQixLQUFLLE1BQU0sV0FBVyxJQUFJLFlBQVksRUFBRTtnQkFDdEMsSUFBSSxXQUFXLENBQUMsT0FBTyxFQUFFO29CQUN2QixLQUFLLEdBQUcsS0FBSyxHQUFHLFdBQVcsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDO2lCQUM1QzthQUNGO1NBQ0Y7UUFDRCxPQUFPLEtBQUssQ0FBQztJQUNmLENBQUM7SUFFRCxvQkFBb0IsQ0FBQyxZQUFzQztRQUN6RCxPQUFPLFlBQVksRUFBRSxNQUFNLElBQUksQ0FBQyxDQUFDO0lBQ25DLENBQUM7SUFFRCxnQkFBZ0IsQ0FBQyxNQUFjO1FBQzdCLE9BQU8sSUFBSSxDQUFDLGdCQUFnQixDQUFDLFFBQVEsQ0FDbkMsTUFBTSxDQUFDLFdBQVcsRUFBeUIsQ0FDNUMsQ0FBQztJQUNKLENBQUM7SUFDRCxxQkFBcUIsQ0FBQyxZQUErQjtRQUNuRCxNQUFNLFdBQVcsR0FBYyxFQUFFLENBQUM7UUFDbEMsV0FBVyxDQUFDLFlBQVksR0FBRyxZQUFZLENBQUM7UUFDeEMsT0FBTyxDQUNMLElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxzQkFBc0IsQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDO1lBQ3ZFLEVBQUUsQ0FDSCxDQUFDO0lBQ0osQ0FBQztJQUNELHVCQUF1QixDQUFDLFlBQStCO1FBQ3JELE1BQU0sV0FBVyxHQUFjLEVBQUUsQ0FBQztRQUNsQyxXQUFXLENBQUMsWUFBWSxHQUFHLFlBQVksQ0FBQztRQUN4QyxPQUFPLENBQ0wsSUFBSSxDQUFDLHdCQUF3QixDQUFDLHNCQUFzQixDQUNsRCxXQUFXLEVBQ1gsS0FBSyxDQUNOLElBQUksRUFBRSxDQUNSLENBQUM7SUFDSixDQUFDO0lBQ0QsNkJBQTZCLENBQzNCLGtCQUFnQztRQUVoQyxNQUFNLFdBQVcsR0FBYyxFQUFFLENBQUM7UUFDbEMsV0FBVyxDQUFDLGtCQUFrQixHQUFHLGtCQUFrQixDQUFDO1FBQ3BELE9BQU8sQ0FDTCxJQUFJLENBQUMsd0JBQXdCLENBQUMscUJBQXFCLENBQUMsV0FBVyxFQUFFLEtBQUssQ0FBQztZQUN2RSxFQUFFLENBQ0gsQ0FBQztJQUNKLENBQUM7SUFDRCwyQkFBMkIsQ0FBQyxrQkFBZ0M7UUFDMUQsTUFBTSxXQUFXLEdBQWMsRUFBRSxDQUFDO1FBQ2xDLFdBQVcsQ0FBQyxrQkFBa0IsR0FBRyxrQkFBa0IsQ0FBQztRQUNwRCxPQUFPLENBQ0wsSUFBSSxDQUFDLHdCQUF3QixDQUFDLHFCQUFxQixDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUM7WUFDdEUsRUFBRSxDQUNILENBQUM7SUFDSixDQUFDO0lBQ0QsZ0JBQWdCLENBQUMsT0FBcUI7UUFDcEMsTUFBTSxNQUFNLEdBQWEsRUFBRSxDQUFDO1FBQzVCLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQztRQUNkLEtBQUssTUFBTSxJQUFJLElBQUksT0FBTyxFQUFFO1lBQzFCLElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUU7Z0JBQ3hCLElBQUksS0FBSyxJQUFJLElBQUksQ0FBQyxXQUFXLEVBQUU7b0JBQzdCLE1BQU07aUJBQ1A7Z0JBQ0QsS0FBSyxFQUFFLENBQUM7Z0JBQ1IsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLE1BQU0sQ0FBQyxDQUFDO2FBQ25DO1NBQ0Y7UUFDRCxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDOzs2SUE5RVUsZ0RBQWdEO2lJQUFoRCxnREFBZ0QsbUhDM0I3RCw2ak5BcU5BOzJGRDFMYSxnREFBZ0Q7a0JBTDVELFNBQVM7K0JBQ0UsaURBQWlELG1CQUUxQyx1QkFBdUIsQ0FBQyxNQUFNOzhCQVEvQyxLQUFLO3NCQURKLEtBQUsiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogU1BEWC1GaWxlQ29weXJpZ2h0VGV4dDogMjAyMyBTQVAgU3BhcnRhY3VzIHRlYW0gPHNwYXJ0YWN1cy10ZWFtQHNhcC5jb20+XG4gKlxuICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEFwYWNoZS0yLjBcbiAqL1xuXG5pbXBvcnQge1xuICBDb21wb25lbnQsXG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICBJbnB1dCxcbiAgaW5qZWN0LFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IE9yZGVyRW50cnkgfSBmcm9tICdAc3BhcnRhY3VzL2NhcnQvYmFzZS9yb290JztcbmltcG9ydCB7IEltYWdlcyB9IGZyb20gJ0BzcGFydGFjdXMvY29yZSc7XG5pbXBvcnQgeyBNeUFjY291bnRWMk9yZGVyQ29uc2lnbm1lbnRzU2VydmljZSB9IGZyb20gJy4uLy4uLy4uL29yZGVyLWRldGFpbHMnO1xuaW1wb3J0IHtcbiAgQ29uc2lnbm1lbnRWaWV3LFxuICBPcmRlclZpZXcsXG4gIE9yZGVySGlzdG9yeVZpZXcsXG59IGZyb20gJ0BzcGFydGFjdXMvb3JkZXIvcm9vdCc7XG5pbXBvcnQgeyBPcmRlckNyaXRpY2FsU3RhdHVzIH0gZnJvbSAnLi4vbXktYWNjb3VudC12Mi1vcmRlci1oaXN0b3J5Lm1vZGVsJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnY3gtbXktYWNjb3VudC12Mi1vcmRlci1jb25zb2xpZGF0ZWQtaW5mb3JtYXRpb24nLFxuICB0ZW1wbGF0ZVVybDogJy4vbXktYWNjb3VudC12Mi1vcmRlci1jb25zb2xpZGF0ZWQtaW5mb3JtYXRpb24uY29tcG9uZW50Lmh0bWwnLFxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbn0pXG5leHBvcnQgY2xhc3MgTXlBY2NvdW50VjJPcmRlckNvbnNvbGlkYXRlZEluZm9ybWF0aW9uQ29tcG9uZW50IHtcbiAgcHJvdGVjdGVkIG9yZGVyQ29uc2lnbm1lbnRzU2VydmljZSA9IGluamVjdChcbiAgICBNeUFjY291bnRWMk9yZGVyQ29uc2lnbm1lbnRzU2VydmljZVxuICApO1xuICBwcm90ZWN0ZWQgY3JpdGljYWxTdGF0dXNlcyA9IE9iamVjdC52YWx1ZXMoT3JkZXJDcml0aWNhbFN0YXR1cyk7XG4gIEBJbnB1dCgpXG4gIG9yZGVyPzogT3JkZXJIaXN0b3J5VmlldztcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IElNQUdFX0NPVU5UID0gNDsgLy9zaG93aW5nIGZpeGVkIG5vLm9mIGltYWdlcywgd2l0aG91dCB1c2luZyBjYXJvdXNlbFxuICBnZXRDb25zaWdubWVudHNDb3VudChjb25zaWdubWVudHM6IENvbnNpZ25tZW50Vmlld1tdIHwgdW5kZWZpbmVkKTogbnVtYmVyIHtcbiAgICBsZXQgY291bnQgPSAwO1xuICAgIGlmIChjb25zaWdubWVudHMpIHtcbiAgICAgIGZvciAoY29uc3QgY29uc2lnbm1lbnQgb2YgY29uc2lnbm1lbnRzKSB7XG4gICAgICAgIGlmIChjb25zaWdubWVudC5lbnRyaWVzKSB7XG4gICAgICAgICAgY291bnQgPSBjb3VudCArIGNvbnNpZ25tZW50LmVudHJpZXMubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjb3VudDtcbiAgfVxuXG4gIGdldE9yZGVyRW50cmllc0NvdW50KG9yZGVyRW50cmllczogT3JkZXJFbnRyeVtdIHwgdW5kZWZpbmVkKTogbnVtYmVyIHtcbiAgICByZXR1cm4gb3JkZXJFbnRyaWVzPy5sZW5ndGggPz8gMDtcbiAgfVxuXG4gIGlzU3RhdHVzQ3JpdGljYWwoc3RhdHVzOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5jcml0aWNhbFN0YXR1c2VzLmluY2x1ZGVzKFxuICAgICAgc3RhdHVzLnRvVXBwZXJDYXNlKCkgYXMgT3JkZXJDcml0aWNhbFN0YXR1c1xuICAgICk7XG4gIH1cbiAgZ2V0UGlja3VwQ29uc2lnbm1lbnRzKGNvbnNpZ25tZW50czogQ29uc2lnbm1lbnRWaWV3W10pOiBDb25zaWdubWVudFZpZXdbXSB7XG4gICAgY29uc3Qgb3JkZXJEZXRhaWw6IE9yZGVyVmlldyA9IHt9O1xuICAgIG9yZGVyRGV0YWlsLmNvbnNpZ25tZW50cyA9IGNvbnNpZ25tZW50cztcbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy5vcmRlckNvbnNpZ25tZW50c1NlcnZpY2UuZ2V0R3JvdXBlZENvbnNpZ25tZW50cyhvcmRlckRldGFpbCwgdHJ1ZSkgPz9cbiAgICAgIFtdXG4gICAgKTtcbiAgfVxuICBnZXREZWxpdmVyeUNvbnNpZ25tZW50cyhjb25zaWdubWVudHM6IENvbnNpZ25tZW50Vmlld1tdKTogQ29uc2lnbm1lbnRWaWV3W10ge1xuICAgIGNvbnN0IG9yZGVyRGV0YWlsOiBPcmRlclZpZXcgPSB7fTtcbiAgICBvcmRlckRldGFpbC5jb25zaWdubWVudHMgPSBjb25zaWdubWVudHM7XG4gICAgcmV0dXJuIChcbiAgICAgIHRoaXMub3JkZXJDb25zaWdubWVudHNTZXJ2aWNlLmdldEdyb3VwZWRDb25zaWdubWVudHMoXG4gICAgICAgIG9yZGVyRGV0YWlsLFxuICAgICAgICBmYWxzZVxuICAgICAgKSA/PyBbXVxuICAgICk7XG4gIH1cbiAgZ2V0RGVsaXZlcnlVbmNvbnNpZ25lZEVudHJpZXMoXG4gICAgdW5jb25zaWduZWRFbnRyaWVzOiBPcmRlckVudHJ5W11cbiAgKTogT3JkZXJFbnRyeVtdIHtcbiAgICBjb25zdCBvcmRlckRldGFpbDogT3JkZXJWaWV3ID0ge307XG4gICAgb3JkZXJEZXRhaWwudW5jb25zaWduZWRFbnRyaWVzID0gdW5jb25zaWduZWRFbnRyaWVzO1xuICAgIHJldHVybiAoXG4gICAgICB0aGlzLm9yZGVyQ29uc2lnbm1lbnRzU2VydmljZS5nZXRVbmNvbnNpZ25lZEVudHJpZXMob3JkZXJEZXRhaWwsIGZhbHNlKSA/P1xuICAgICAgW11cbiAgICApO1xuICB9XG4gIGdldFBpY2t1cFVuY29uc2lnbmVkRW50cmllcyh1bmNvbnNpZ25lZEVudHJpZXM6IE9yZGVyRW50cnlbXSk6IE9yZGVyRW50cnlbXSB7XG4gICAgY29uc3Qgb3JkZXJEZXRhaWw6IE9yZGVyVmlldyA9IHt9O1xuICAgIG9yZGVyRGV0YWlsLnVuY29uc2lnbmVkRW50cmllcyA9IHVuY29uc2lnbmVkRW50cmllcztcbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy5vcmRlckNvbnNpZ25tZW50c1NlcnZpY2UuZ2V0VW5jb25zaWduZWRFbnRyaWVzKG9yZGVyRGV0YWlsLCB0cnVlKSA/P1xuICAgICAgW11cbiAgICApO1xuICB9XG4gIGdldFByb2R1Y3RJbWFnZXMoZW50cmllczogT3JkZXJFbnRyeVtdKTogSW1hZ2VzW10ge1xuICAgIGNvbnN0IGltYWdlczogSW1hZ2VzW10gPSBbXTtcbiAgICBsZXQgaW5kZXggPSAwO1xuICAgIGZvciAoY29uc3QgaXRlbSBvZiBlbnRyaWVzKSB7XG4gICAgICBpZiAoaXRlbS5wcm9kdWN0Py5pbWFnZXMpIHtcbiAgICAgICAgaWYgKGluZGV4ID49IHRoaXMuSU1BR0VfQ09VTlQpIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBpbmRleCsrO1xuICAgICAgICBpbWFnZXMucHVzaChpdGVtLnByb2R1Y3Q/LmltYWdlcyk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpbWFnZXM7XG4gIH1cbn1cbiIsIjxkaXYgY2xhc3M9XCJjeC1jb25zb2xpZGF0ZWQtb3JkZXItaW5mb1wiICpuZ0lmPVwib3JkZXJcIj5cbiAgPGRpdiBjbGFzcz1cImN4LW9yZGVyLWluZm9cIj5cbiAgICA8IS0tIHBpY2t1cCBjb25zaWduZWQgZW50cmllcyBcbiAgZWc6IFRvIEJlIFBpY2tlZCBVcCAtIDMgSXRlbXNcbiAgLS0+XG4gICAgPGRpdlxuICAgICAgKm5nSWY9XCJcbiAgICAgICAgZ2V0Q29uc2lnbm1lbnRzQ291bnQoZ2V0UGlja3VwQ29uc2lnbm1lbnRzKG9yZGVyLmNvbnNpZ25tZW50cyA/PyBbXSkpID5cbiAgICAgICAgMFxuICAgICAgXCJcbiAgICA+XG4gICAgICA8ZGl2IGNsYXNzPVwiY3gtb3JkZXItc3RhdHVzXCI+XG4gICAgICAgIHt7XG4gICAgICAgICAgJ215QWNjb3VudFYyT3JkZXJIaXN0b3J5LmRlbGl2ZXJ5UG9pbnRPZlNlcnZpY2VEZXRhaWxzLml0ZW1zVG9CZVBpY2tVcCdcbiAgICAgICAgICAgIHwgY3hUcmFuc2xhdGVcbiAgICAgICAgfX1cbiAgICAgICAgPG5nLWNvbnRhaW5lclxuICAgICAgICAgICpuZ1RlbXBsYXRlT3V0bGV0PVwiXG4gICAgICAgICAgICBzaG93TWFueUl0ZW1zO1xuICAgICAgICAgICAgY29udGV4dDoge1xuICAgICAgICAgICAgICBjb3VudDogZ2V0Q29uc2lnbm1lbnRzQ291bnQoXG4gICAgICAgICAgICAgICAgZ2V0UGlja3VwQ29uc2lnbm1lbnRzKG9yZGVyLmNvbnNpZ25tZW50cyA/PyBbXSlcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIFwiXG4gICAgICAgID48L25nLWNvbnRhaW5lcj5cbiAgICAgIDwvZGl2PlxuICAgICAgPGN4LW15LWFjY291bnQtdjItY29uc2lnbm1lbnQtZW50cmllc1xuICAgICAgICBbb3JkZXJDb2RlXT1cIm9yZGVyLmNvZGUgPz8gJydcIlxuICAgICAgICBbY29uc2lnbm1lbnRzXT1cImdldFBpY2t1cENvbnNpZ25tZW50cyhvcmRlci5jb25zaWdubWVudHMgPz8gW10pXCJcbiAgICAgID48L2N4LW15LWFjY291bnQtdjItY29uc2lnbm1lbnQtZW50cmllcz5cbiAgICA8L2Rpdj5cblxuICAgIDwhLS0gZGVsaXZlcnkgY29uc2lnbmVkIGVudHJpZXNcbiAgZWc6IFRvIEJlIFNoaXBwZWQgLSA2IEl0ZW1zXG4gIC0tPlxuICAgIDxkaXZcbiAgICAgICpuZ0lmPVwiXG4gICAgICAgIGdldENvbnNpZ25tZW50c0NvdW50KFxuICAgICAgICAgIGdldERlbGl2ZXJ5Q29uc2lnbm1lbnRzKG9yZGVyLmNvbnNpZ25tZW50cyA/PyBbXSlcbiAgICAgICAgKSA+IDBcbiAgICAgIFwiXG4gICAgPlxuICAgICAgPCEtLWhlYWRpbmcgdGFrZW4gZnJvbSBmZWF0dXJlLWxpYnMvb3JkZXIvY29tcG9uZW50cy9vcmRlci1jb25maXJtYXRpb24vb3JkZXItY29uZmlybWF0aW9uLXNoaXBwaW5nL29yZGVyLWNvbmZpcm1hdGlvbi1zaGlwcGluZy5jb21wb25lbnQuaHRtbC0tPlxuICAgICAgPCEtLWluc3RlYWQgb2YgW2N4T3V0bGV0XT1cIk9yZGVyT3V0bGV0cy5DT05TSUdOTUVOVF9ERUxJVkVSWV9JTkZPXCItLT5cbiAgICAgIDxkaXYgY2xhc3M9XCJjeC1vcmRlci1zdGF0dXNcIj5cbiAgICAgICAge3tcbiAgICAgICAgICAnbXlBY2NvdW50VjJPcmRlckhpc3RvcnkuY2hlY2tvdXRNb2RlLmRlbGl2ZXJ5RW50cmllcycgfCBjeFRyYW5zbGF0ZVxuICAgICAgICB9fVxuICAgICAgICA8bmctY29udGFpbmVyXG4gICAgICAgICAgKm5nVGVtcGxhdGVPdXRsZXQ9XCJcbiAgICAgICAgICAgIHNob3dNYW55SXRlbXM7XG4gICAgICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgICAgIGNvdW50OiBnZXRDb25zaWdubWVudHNDb3VudChcbiAgICAgICAgICAgICAgICBnZXREZWxpdmVyeUNvbnNpZ25tZW50cyhvcmRlci5jb25zaWdubWVudHMgPz8gW10pXG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBcIlxuICAgICAgICA+PC9uZy1jb250YWluZXI+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxjeC1teS1hY2NvdW50LXYyLWNvbnNpZ25tZW50LWVudHJpZXNcbiAgICAgICAgW29yZGVyQ29kZV09XCJvcmRlci5jb2RlID8/ICcnXCJcbiAgICAgICAgW2NvbnNpZ25tZW50c109XCJnZXREZWxpdmVyeUNvbnNpZ25tZW50cyhvcmRlci5jb25zaWdubWVudHMgPz8gW10pXCJcbiAgICAgID48L2N4LW15LWFjY291bnQtdjItY29uc2lnbm1lbnQtZW50cmllcz5cbiAgICA8L2Rpdj5cblxuICAgIDwhLS0gdW5jb25zaWduZWQgZW50cmllcyBcbiAgZWc6IFNvbWVfU3RhdHVzIC0gMSBJdGVtXG4gIC0tPlxuICAgIDxkaXYgKm5nSWY9XCJnZXRPcmRlckVudHJpZXNDb3VudChvcmRlci51bmNvbnNpZ25lZEVudHJpZXMpID4gMFwiPlxuICAgICAgPGRpdiAqbmdJZj1cIm9yZGVyLnN0YXR1c0Rpc3BsYXlcIj5cbiAgICAgICAgPGRpdlxuICAgICAgICAgIGNsYXNzPVwiY3gtb3JkZXItc3RhdHVzLWNyaXRpY2FsXCJcbiAgICAgICAgICAqbmdJZj1cImlzU3RhdHVzQ3JpdGljYWwob3JkZXIuc3RhdHVzRGlzcGxheSk7IGVsc2Ugbm9uQ3JpdGljYWxcIlxuICAgICAgICA+XG4gICAgICAgICAge3tcbiAgICAgICAgICAgICdvcmRlckRldGFpbHMuc3RhdHVzRGlzcGxheV8nICsgb3JkZXIuc3RhdHVzRGlzcGxheSB8IGN4VHJhbnNsYXRlXG4gICAgICAgICAgfX1cbiAgICAgICAgICAtXG4gICAgICAgICAgPG5nLWNvbnRhaW5lclxuICAgICAgICAgICAgKm5nVGVtcGxhdGVPdXRsZXQ9XCJcbiAgICAgICAgICAgICAgc2hvd01hbnlJdGVtcztcbiAgICAgICAgICAgICAgY29udGV4dDogeyBjb3VudDogZ2V0T3JkZXJFbnRyaWVzQ291bnQob3JkZXIudW5jb25zaWduZWRFbnRyaWVzKSB9XG4gICAgICAgICAgICBcIlxuICAgICAgICAgID48L25nLWNvbnRhaW5lcj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxuZy10ZW1wbGF0ZSAjbm9uQ3JpdGljYWw+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cImN4LW9yZGVyLXN0YXR1c1wiPlxuICAgICAgICAgICAge3tcbiAgICAgICAgICAgICAgJ29yZGVyRGV0YWlscy5zdGF0dXNEaXNwbGF5XycgKyBvcmRlci5zdGF0dXNEaXNwbGF5IHwgY3hUcmFuc2xhdGVcbiAgICAgICAgICAgIH19XG4gICAgICAgICAgICAtXG4gICAgICAgICAgICA8bmctY29udGFpbmVyXG4gICAgICAgICAgICAgICpuZ1RlbXBsYXRlT3V0bGV0PVwiXG4gICAgICAgICAgICAgICAgc2hvd01hbnlJdGVtcztcbiAgICAgICAgICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgICAgICAgICBjb3VudDogZ2V0T3JkZXJFbnRyaWVzQ291bnQob3JkZXIudW5jb25zaWduZWRFbnRyaWVzKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgXCJcbiAgICAgICAgICAgID48L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgIDwvZGl2PlxuXG4gICAgICA8IS0tIGRlbGl2ZXJ5IHVuY29uc2lnbmVkIGVudHJpZXMgXG4gICAgICBlZzogVG8gQmUgU2hpcHBlZCAtIDYgSXRlbXMgLy9zaG93aW5nIHRoaXMgaXMgaW4gZXh0cmEgaW5mb3JtYXRpb24gZm9ybWF0XG4gICAgLS0+XG4gICAgICA8ZGl2XG4gICAgICAgIGNsYXNzPVwiY3gtY29uc2lnbm1lbnQtaW5mb1wiXG4gICAgICAgICpuZ0lmPVwiXG4gICAgICAgICAgZ2V0T3JkZXJFbnRyaWVzQ291bnQoXG4gICAgICAgICAgICBnZXREZWxpdmVyeVVuY29uc2lnbmVkRW50cmllcyhvcmRlci51bmNvbnNpZ25lZEVudHJpZXMgPz8gW10pXG4gICAgICAgICAgKSA+IDBcbiAgICAgICAgXCJcbiAgICAgID5cbiAgICAgICAge3tcbiAgICAgICAgICAnbXlBY2NvdW50VjJPcmRlckhpc3RvcnkuY2hlY2tvdXRNb2RlLmRlbGl2ZXJ5RW50cmllcycgfCBjeFRyYW5zbGF0ZVxuICAgICAgICB9fVxuICAgICAgICA8bmctY29udGFpbmVyXG4gICAgICAgICAgKm5nVGVtcGxhdGVPdXRsZXQ9XCJcbiAgICAgICAgICAgIHNob3dNYW55SXRlbXM7XG4gICAgICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgICAgIGNvdW50OiBnZXRPcmRlckVudHJpZXNDb3VudChcbiAgICAgICAgICAgICAgICBnZXREZWxpdmVyeVVuY29uc2lnbmVkRW50cmllcyhvcmRlci51bmNvbnNpZ25lZEVudHJpZXMgPz8gW10pXG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBcIlxuICAgICAgICA+PC9uZy1jb250YWluZXI+XG4gICAgICA8L2Rpdj5cblxuICAgICAgPCEtLSBwaWNrdXAgdW5jb25zaWduZWQgZW50cmllcywgYjJiIGRvZXMgbm90IGhhdmUgcGlja3VwIGl0ZW1zXG4gICAgICBlZzogVG8gQmUgUGlja2VkIFVwIC0gNyBJdGVtcyAvL3Nob3dpbmcgdGhpcyBpcyBhcyBhbiBleHRyYSBpbmZvcm1hdGlvbiBmb3JtYXRcbiAgICAtLT5cbiAgICAgIDxkaXZcbiAgICAgICAgY2xhc3M9XCJjeC1jb25zaWdubWVudC1pbmZvXCJcbiAgICAgICAgKm5nSWY9XCJcbiAgICAgICAgICBnZXRPcmRlckVudHJpZXNDb3VudChcbiAgICAgICAgICAgIGdldFBpY2t1cFVuY29uc2lnbmVkRW50cmllcyhvcmRlci51bmNvbnNpZ25lZEVudHJpZXMgPz8gW10pXG4gICAgICAgICAgKSA+IDBcbiAgICAgICAgXCJcbiAgICAgID5cbiAgICAgICAge3tcbiAgICAgICAgICAnbXlBY2NvdW50VjJPcmRlckhpc3RvcnkuY2hlY2tvdXRQaWNrdXBJblN0b3JlLmhlYWRpbmcnIHwgY3hUcmFuc2xhdGVcbiAgICAgICAgfX1cbiAgICAgICAgPG5nLWNvbnRhaW5lclxuICAgICAgICAgICpuZ1RlbXBsYXRlT3V0bGV0PVwiXG4gICAgICAgICAgICBzaG93TWFueUl0ZW1zO1xuICAgICAgICAgICAgY29udGV4dDoge1xuICAgICAgICAgICAgICBjb3VudDogZ2V0T3JkZXJFbnRyaWVzQ291bnQoXG4gICAgICAgICAgICAgICAgZ2V0UGlja3VwVW5jb25zaWduZWRFbnRyaWVzKG9yZGVyLnVuY29uc2lnbmVkRW50cmllcyA/PyBbXSlcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIFwiXG4gICAgICAgID48L25nLWNvbnRhaW5lcj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuXG4gICAgPCEtLXJldHVybiByZXF1ZXN0IGRldGFpbHNcbiAgZWc6IFJldHVybmVkOiAyIEl0ZW1zXG4gICAgICBSZXR1cm4gUHJvY2Vzc2VkOiAxNSwgU2VwdGVtYmVyLCAyMDIyXG4gIC0tPlxuICAgIDxkaXYgKm5nRm9yPVwibGV0IHJldHVyblJlcXVlc3Qgb2Ygb3JkZXIucmV0dXJuUmVxdWVzdHNcIj5cbiAgICAgIDxkaXYgY2xhc3M9XCJjeC1vcmRlci1zdGF0dXMtY3JpdGljYWxcIj5cbiAgICAgICAge3sgJ3JldHVyblJlcXVlc3RMaXN0LnJldHVyblJlcXVlc3RJZCcgfCBjeFRyYW5zbGF0ZSB9fVxuICAgICAgICA8YVxuICAgICAgICAgICpuZ0lmPVwicmV0dXJuUmVxdWVzdC5ybWE7IGVsc2Ugc2hvd1JldHVybkNvZGVcIlxuICAgICAgICAgIFtyb3V0ZXJMaW5rXT1cIlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBjeFJvdXRlOiAncmV0dXJuUmVxdWVzdERldGFpbHMnLFxuICAgICAgICAgICAgICBwYXJhbXM6IHJldHVyblJlcXVlc3RcbiAgICAgICAgICAgIH0gfCBjeFVybFxuICAgICAgICAgIFwiXG4gICAgICAgICAgY2xhc3M9XCJjeC1vcmRlci1zdGF0dXMtY3JpdGljYWwtbGlua1wiXG4gICAgICAgID5cbiAgICAgICAgICB7eyByZXR1cm5SZXF1ZXN0LnJtYSB9fTwvYVxuICAgICAgICA+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxuZy10ZW1wbGF0ZSAjc2hvd1JldHVybkNvZGU+XG4gICAgICAgIHt7IHJldHVyblJlcXVlc3QuY29kZSB9fVxuICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgIDxkaXZcbiAgICAgICAgY2xhc3M9XCJjeC1jb25zaWdubWVudC1pbmZvXCJcbiAgICAgICAgKm5nSWY9XCJyZXR1cm5SZXF1ZXN0LmNyZWF0aW9uVGltZSBhcyBjcmVhdGlvblRpbWVcIlxuICAgICAgPlxuICAgICAgICB7e1xuICAgICAgICAgICdteUFjY291bnRWMk9yZGVySGlzdG9yeS5yZXR1cm5Qcm9jZXNzZWQnXG4gICAgICAgICAgICB8IGN4VHJhbnNsYXRlOiB7IHBhcmFtOiBjcmVhdGlvblRpbWUgfCBjeERhdGU6ICdkLCBNTU1NLCB5eXl5JyB9XG4gICAgICAgIH19XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG4gIDxkaXYgY2xhc3M9XCJjeC1vcmRlci1pbWFnZXMtY29udGFpbmVyXCI+XG4gICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cIm9yZGVyLmVudHJpZXNcIj5cbiAgICAgIDxuZy1jb250YWluZXIgKm5nRm9yPVwibGV0IGl0ZW0gb2YgZ2V0UHJvZHVjdEltYWdlcyhvcmRlci5lbnRyaWVzKVwiPlxuICAgICAgICA8Y3gtbWVkaWFcbiAgICAgICAgICBbY29udGFpbmVyXT1cIml0ZW0uUFJJTUFSWVwiXG4gICAgICAgICAgY2xhc3M9XCJjeC1vcmRlci1pbWdcIlxuICAgICAgICAgIGZvcm1hdD1cInRodW1ibmFpbFwiXG4gICAgICAgICAgcm9sZT1cInByZXNlbnRhdGlvblwiXG4gICAgICAgID48L2N4LW1lZGlhPlxuICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgPC9uZy1jb250YWluZXI+XG4gIDwvZGl2PlxuPC9kaXY+XG5cbjxuZy10ZW1wbGF0ZSAjc2hvd01hbnlJdGVtcyBsZXQtY291bnQ9XCJjb3VudFwiPlxuICA8bmctY29udGFpbmVyICpuZ0lmPVwiY291bnQgPiAxOyBlbHNlIHNob3dPbmVJdGVtXCI+XG4gICAge3sgJ215QWNjb3VudFYyT3JkZXJIaXN0b3J5Lml0ZW1zJyB8IGN4VHJhbnNsYXRlOiB7IHBhcmFtOiBjb3VudCB9IH19XG4gIDwvbmctY29udGFpbmVyPlxuPC9uZy10ZW1wbGF0ZT5cbjxuZy10ZW1wbGF0ZSAjc2hvd09uZUl0ZW0+XG4gIHt7ICdteUFjY291bnRWMk9yZGVySGlzdG9yeS5pdGVtJyB8IGN4VHJhbnNsYXRlOiB7IHBhcmFtOiAxIH0gfX1cbjwvbmctdGVtcGxhdGU+XG4iXX0=