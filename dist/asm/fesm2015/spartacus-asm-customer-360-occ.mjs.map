{"version":3,"file":"spartacus-asm-customer-360-occ.mjs","sources":["../../../feature-libs/asm/customer-360/occ/adapters/occ-asm-customer-360.adapter.ts","../../../feature-libs/asm/customer-360/occ/adapters/index.ts","../../../feature-libs/asm/customer-360/occ/adapters/default-occ-asm-customer-360-config.ts","../../../feature-libs/asm/customer-360/occ/asm-customer-360-occ.module.ts","../../../feature-libs/asm/customer-360/occ/model/index.ts","../../../feature-libs/asm/customer-360/occ/public_api.ts","../../../feature-libs/asm/customer-360/occ/spartacus-asm-customer-360-occ.ts"],"sourcesContent":["/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport {\n  AsmCustomer360Adapter,\n  ASM_CUSTOMER_360_NORMALIZER,\n} from '@spartacus/asm/customer-360/core';\nimport {\n  AsmCustomer360Request,\n  AsmCustomer360Response,\n} from '@spartacus/asm/customer-360/root';\nimport {\n  BaseSiteService,\n  ConverterService,\n  InterceptorUtil,\n  normalizeHttpError,\n  OccEndpointsService,\n  USE_CUSTOMER_SUPPORT_AGENT_TOKEN,\n} from '@spartacus/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\n\n@Injectable()\nexport class OccAsmCustomer360Adapter implements AsmCustomer360Adapter {\n  private activeBaseSite: string;\n\n  constructor(\n    protected http: HttpClient,\n    protected occEndpointsService: OccEndpointsService,\n    protected converterService: ConverterService,\n    protected baseSiteService: BaseSiteService\n  ) {\n    this.baseSiteService\n      .getActive()\n      .subscribe((value) => (this.activeBaseSite = value));\n  }\n\n  protected getHeaders(): HttpHeaders {\n    return InterceptorUtil.createHeader(\n      USE_CUSTOMER_SUPPORT_AGENT_TOKEN,\n      true,\n      new HttpHeaders()\n    );\n  }\n\n  getAsmCustomer360Data(\n    request: AsmCustomer360Request\n  ): Observable<AsmCustomer360Response> {\n    const headers = InterceptorUtil.createHeader(\n      USE_CUSTOMER_SUPPORT_AGENT_TOKEN,\n      true,\n      new HttpHeaders()\n    );\n\n    const url = this.occEndpointsService.buildUrl(\n      'asmCustomer360',\n      {\n        urlParams: {\n          baseSiteId: this.activeBaseSite,\n          userId: request.options.userId ?? '',\n        },\n      },\n      {\n        baseSite: false,\n        prefix: false,\n      }\n    );\n\n    const requestBody = {\n      customer360Queries: request.queries,\n    };\n\n    return this.http\n      .post<AsmCustomer360Response>(url, requestBody, { headers })\n      .pipe(\n        catchError((error) => throwError(normalizeHttpError(error))),\n        this.converterService.pipeable(ASM_CUSTOMER_360_NORMALIZER)\n      );\n  }\n}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from './occ-asm-customer-360.adapter';\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { OccConfig } from '@spartacus/core';\n\nexport const defaultOccAsmCustomer360Config: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        asmCustomer360:\n          '/assistedservicewebservices/${baseSiteId}/users/${userId}/customer360',\n      },\n    },\n  },\n};\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { AsmCustomer360Adapter } from '@spartacus/asm/customer-360/core';\nimport { provideDefaultConfig } from '@spartacus/core';\nimport { defaultOccAsmCustomer360Config } from './adapters/default-occ-asm-customer-360-config';\nimport { OccAsmCustomer360Adapter } from './adapters/occ-asm-customer-360.adapter';\n\n@NgModule({\n  imports: [CommonModule],\n  providers: [\n    provideDefaultConfig(defaultOccAsmCustomer360Config),\n    {\n      provide: AsmCustomer360Adapter,\n      useClass: OccAsmCustomer360Adapter,\n    },\n  ],\n})\nexport class AsmCustomer360OccModule {}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from './occ-asm-customer-360-endpoints.model';\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from './adapters/index';\nexport * from './asm-customer-360-occ.module';\nexport * from './model/index';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}