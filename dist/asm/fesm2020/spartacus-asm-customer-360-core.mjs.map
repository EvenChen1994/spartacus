{"version":3,"file":"spartacus-asm-customer-360-core.mjs","sources":["../../../feature-libs/asm/customer-360/core/connectors/converters.ts","../../../feature-libs/asm/customer-360/core/connectors/asm-customer-360.adapter.ts","../../../feature-libs/asm/customer-360/core/connectors/asm-customer-360.connector.ts","../../../feature-libs/asm/customer-360/core/connectors/index.ts","../../../feature-libs/asm/customer-360/core/services/asm-customer-360.service.ts","../../../feature-libs/asm/customer-360/core/services/index.ts","../../../feature-libs/asm/customer-360/core/facade/facade-providers.ts","../../../feature-libs/asm/customer-360/core/asm-customer-360-core.module.ts","../../../feature-libs/asm/customer-360/core/utils.ts","../../../feature-libs/asm/customer-360/core/public_api.ts","../../../feature-libs/asm/customer-360/core/spartacus-asm-customer-360-core.ts"],"sourcesContent":["/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { InjectionToken } from '@angular/core';\nimport { AsmCustomer360Response } from '@spartacus/asm/customer-360/root';\nimport { Converter } from '@spartacus/core';\n\nexport const ASM_CUSTOMER_360_NORMALIZER = new InjectionToken<\n  Converter<any, AsmCustomer360Response>\n>('AsmCustomer360Normalizer');\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {\n  AsmCustomer360Request,\n  AsmCustomer360Response,\n} from '@spartacus/asm/customer-360/root';\nimport { Observable } from 'rxjs';\n\nexport abstract class AsmCustomer360Adapter {\n  /**\n   * Fetches data needed for certain ASM components.\n   */\n  abstract getAsmCustomer360Data(\n    request: AsmCustomer360Request\n  ): Observable<AsmCustomer360Response>;\n}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Injectable } from '@angular/core';\nimport {\n  AsmCustomer360Request,\n  AsmCustomer360Response,\n} from '@spartacus/asm/customer-360/root';\nimport { Observable } from 'rxjs';\n\nimport { AsmCustomer360Adapter } from './asm-customer-360.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AsmCustomer360Connector {\n  constructor(protected asmCustomer360Adapter: AsmCustomer360Adapter) {}\n\n  getAsmCustomer360Data(\n    request: AsmCustomer360Request\n  ): Observable<AsmCustomer360Response> {\n    return this.asmCustomer360Adapter.getAsmCustomer360Data(request);\n  }\n}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from './converters';\nexport * from './asm-customer-360.adapter';\nexport * from './asm-customer-360.connector';\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Injectable } from '@angular/core';\nimport {\n  AsmCustomer360Facade,\n  AsmCustomer360Query,\n  AsmCustomer360Request,\n  AsmCustomer360Response,\n  AsmCustomer360TabComponent,\n} from '@spartacus/asm/customer-360/root';\nimport { Command, CommandService } from '@spartacus/core';\nimport { UserAccountFacade } from '@spartacus/user/account/root';\nimport { Observable, of } from 'rxjs';\nimport { concatMap, take } from 'rxjs/operators';\nimport { AsmCustomer360Connector } from '../connectors/asm-customer-360.connector';\n\n@Injectable()\nexport class AsmCustomer360Service implements AsmCustomer360Facade {\n  protected asmCustomer360Command$: Command<\n    Array<AsmCustomer360TabComponent>,\n    AsmCustomer360Response\n  >;\n\n  constructor(\n    protected commandService: CommandService,\n    protected asmCustomer360Connector: AsmCustomer360Connector,\n    protected userAccountFacade: UserAccountFacade\n  ) {\n    this.asmCustomer360Command$ = this.commandService.create(\n      (tabComponents) => {\n        return this.userAccountFacade.get().pipe(\n          take(1),\n          concatMap((customer) => {\n            const queries = tabComponents.reduce(\n              (requests: Array<AsmCustomer360Query>, component) => {\n                if (component.requestData) {\n                  return requests.concat(component.requestData);\n                }\n                return requests;\n              },\n              []\n            );\n\n            if (queries.length > 0) {\n              const request: AsmCustomer360Request = {\n                queries,\n                options: {\n                  userId: customer?.customerId ?? '',\n                },\n              };\n              return this.asmCustomer360Connector.getAsmCustomer360Data(\n                request\n              );\n            } else {\n              return of({\n                value: [],\n              });\n            }\n          })\n        );\n      }\n    );\n  }\n\n  get360Data(\n    components: Array<AsmCustomer360TabComponent>\n  ): Observable<AsmCustomer360Response | undefined> {\n    return this.asmCustomer360Command$.execute(components);\n  }\n}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from './asm-customer-360.service';\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Provider } from '@angular/core';\n\nimport { AsmCustomer360Facade } from '@spartacus/asm/customer-360/root';\nimport { AsmCustomer360Service } from '../services';\n\nexport const facadeProviders: Provider[] = [\n  AsmCustomer360Service,\n  {\n    provide: AsmCustomer360Facade,\n    useExisting: AsmCustomer360Service,\n  },\n];\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { NgModule } from '@angular/core';\nimport { AsmCustomer360Connector } from './connectors';\nimport { facadeProviders } from './facade/facade-providers';\nimport { StoreFinderModule } from '@spartacus/storefinder';\n\n@NgModule({\n  imports: [StoreFinderModule],\n  providers: [AsmCustomer360Connector, ...facadeProviders],\n})\nexport class AsmCustomer360CoreModule {}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {\n  AsmDialogActionEvent,\n  AsmDialogActionType,\n} from '@spartacus/asm/customer-360/root';\nimport { UrlCommand, User } from '@spartacus/core';\n\n/**\n * Return event from ASM dialog action\n */\nexport function getAsmDialogActionEvent(\n  customerEntry: User,\n  action: AsmDialogActionType,\n  route?: UrlCommand\n): AsmDialogActionEvent {\n  const event: AsmDialogActionEvent = {\n    actionType: action,\n    selectedUser: customerEntry,\n    route: route,\n  };\n  return event;\n}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from './connectors';\nexport * from './asm-customer-360-core.module';\nexport * from './services';\nexport * from './utils';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["i1.AsmCustomer360Adapter","i2.AsmCustomer360Connector"],"mappings":"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"}