/*
 * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>
 *
 * SPDX-License-Identifier: Apache-2.0
 */
import { Injectable } from '@angular/core';
import { Configurator, } from '@spartacus/product-configurator/rulebased';
import { of } from 'rxjs';
import { map, switchMap } from 'rxjs/operators';
import * as i0 from "@angular/core";
import * as i1 from "./cpq-configurator-rest.service";
import * as i2 from "./../occ/cpq-configurator-occ.service";
export class CpqConfiguratorRestAdapter {
    constructor(cpqRestService, cpqOccService) {
        this.cpqRestService = cpqRestService;
        this.cpqOccService = cpqOccService;
    }
    getConfiguratorType() {
        return "CLOUDCPQCONFIGURATOR" /* ConfiguratorType.CPQ */;
    }
    supportsCpqOverOcc() {
        return false;
    }
    createConfiguration(owner) {
        // no error handling for missing owner id needed, as it's a
        // mandatory attribute in owner
        return this.cpqRestService.createConfiguration(owner.id).pipe(map((configResponse) => {
            configResponse.owner = owner;
            return configResponse;
        }));
    }
    readConfiguration(configId, groupId, owner) {
        return this.cpqRestService.readConfiguration(configId, groupId).pipe(map((configResponse) => {
            configResponse.owner = owner;
            return configResponse;
        }));
    }
    updateConfiguration(configuration) {
        const updateMethod = configuration.updateType === Configurator.UpdateType.VALUE_QUANTITY
            ? this.cpqRestService.updateValueQuantity
            : this.cpqRestService.updateAttribute;
        return updateMethod.call(this.cpqRestService, configuration).pipe(map((configResponse) => {
            configResponse.owner = configuration.owner;
            return configResponse;
        }));
    }
    updateConfigurationOverview() {
        throw new Error('Update the configuration overview is not supported for the CPQ configurator');
    }
    addToCart(parameters) {
        return this.cpqOccService.addToCart(parameters);
    }
    readConfigurationForCartEntry(parameters) {
        return this.cpqOccService.getConfigIdForCartEntry(parameters).pipe(switchMap((configId) => {
            return this.cpqRestService.readConfiguration(configId).pipe(map((configResponse) => {
                configResponse.owner = parameters.owner;
                return configResponse;
            }));
        }));
    }
    updateConfigurationForCartEntry(parameters) {
        return this.cpqOccService.updateCartEntry(parameters);
    }
    readConfigurationForOrderEntry(parameters) {
        return this.cpqOccService.getConfigIdForOrderEntry(parameters).pipe(switchMap((configId) => {
            return this.cpqRestService.readConfiguration(configId).pipe(map((configResponse) => {
                configResponse.owner = parameters.owner;
                return configResponse;
            }));
        }));
    }
    readPriceSummary(configuration) {
        return of(configuration); // so that UI does not run into exception
    }
    getConfigurationOverview(configId) {
        return this.cpqRestService.readConfigurationOverview(configId);
    }
    searchVariants() {
        throw new Error('searchVariants is not supported for the CPQ configurator');
    }
}
CpqConfiguratorRestAdapter.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: CpqConfiguratorRestAdapter, deps: [{ token: i1.CpqConfiguratorRestService }, { token: i2.CpqConfiguratorOccService }], target: i0.ɵɵFactoryTarget.Injectable });
CpqConfiguratorRestAdapter.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: CpqConfiguratorRestAdapter });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: CpqConfiguratorRestAdapter, decorators: [{
            type: Injectable
        }], ctorParameters: function () { return [{ type: i1.CpqConfiguratorRestService }, { type: i2.CpqConfiguratorOccService }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3BxLWNvbmZpZ3VyYXRvci1yZXN0LmFkYXB0ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9mZWF0dXJlLWxpYnMvcHJvZHVjdC1jb25maWd1cmF0b3IvcnVsZWJhc2VkL2NwcS9yZXN0L2NwcS1jb25maWd1cmF0b3ItcmVzdC5hZGFwdGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7O0dBSUc7QUFFSCxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBTTNDLE9BQU8sRUFDTCxZQUFZLEdBRWIsTUFBTSwyQ0FBMkMsQ0FBQztBQUNuRCxPQUFPLEVBQWMsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3RDLE9BQU8sRUFBRSxHQUFHLEVBQUUsU0FBUyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7Ozs7QUFLaEQsTUFBTSxPQUFPLDBCQUEwQjtJQUdyQyxZQUNZLGNBQTBDLEVBQzFDLGFBQXdDO1FBRHhDLG1CQUFjLEdBQWQsY0FBYyxDQUE0QjtRQUMxQyxrQkFBYSxHQUFiLGFBQWEsQ0FBMkI7SUFDakQsQ0FBQztJQUVKLG1CQUFtQjtRQUNqQix5REFBNEI7SUFDOUIsQ0FBQztJQUVELGtCQUFrQjtRQUNoQixPQUFPLEtBQUssQ0FBQztJQUNmLENBQUM7SUFFRCxtQkFBbUIsQ0FDakIsS0FBK0I7UUFFL0IsMkRBQTJEO1FBQzNELCtCQUErQjtRQUMvQixPQUFPLElBQUksQ0FBQyxjQUFjLENBQUMsbUJBQW1CLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FDM0QsR0FBRyxDQUFDLENBQUMsY0FBYyxFQUFFLEVBQUU7WUFDckIsY0FBYyxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7WUFDN0IsT0FBTyxjQUFjLENBQUM7UUFDeEIsQ0FBQyxDQUFDLENBQ0gsQ0FBQztJQUNKLENBQUM7SUFFRCxpQkFBaUIsQ0FDZixRQUFnQixFQUNoQixPQUFlLEVBQ2YsS0FBK0I7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QiwwQkFBMEI7MkZBQTFCLDBCQUEwQjtrQkFEdEMsVUFBVSIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBTUERYLUZpbGVDb3B5cmlnaHRUZXh0OiAyMDIzIFNBUCBTcGFydGFjdXMgdGVhbSA8c3BhcnRhY3VzLXRlYW1Ac2FwLmNvbT5cbiAqXG4gKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogQXBhY2hlLTIuMFxuICovXG5cbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IENhcnRNb2RpZmljYXRpb24gfSBmcm9tICdAc3BhcnRhY3VzL2NhcnQvYmFzZS9yb290JztcbmltcG9ydCB7XG4gIENvbW1vbkNvbmZpZ3VyYXRvcixcbiAgQ29uZmlndXJhdG9yVHlwZSxcbn0gZnJvbSAnQHNwYXJ0YWN1cy9wcm9kdWN0LWNvbmZpZ3VyYXRvci9jb21tb24nO1xuaW1wb3J0IHtcbiAgQ29uZmlndXJhdG9yLFxuICBSdWxlYmFzZWRDb25maWd1cmF0b3JBZGFwdGVyLFxufSBmcm9tICdAc3BhcnRhY3VzL3Byb2R1Y3QtY29uZmlndXJhdG9yL3J1bGViYXNlZCc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBvZiB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgbWFwLCBzd2l0Y2hNYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBDcHFDb25maWd1cmF0b3JPY2NTZXJ2aWNlIH0gZnJvbSAnLi8uLi9vY2MvY3BxLWNvbmZpZ3VyYXRvci1vY2Muc2VydmljZSc7XG5pbXBvcnQgeyBDcHFDb25maWd1cmF0b3JSZXN0U2VydmljZSB9IGZyb20gJy4vY3BxLWNvbmZpZ3VyYXRvci1yZXN0LnNlcnZpY2UnO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgQ3BxQ29uZmlndXJhdG9yUmVzdEFkYXB0ZXJcbiAgaW1wbGVtZW50cyBSdWxlYmFzZWRDb25maWd1cmF0b3JBZGFwdGVyXG57XG4gIGNvbnN0cnVjdG9yKFxuICAgIHByb3RlY3RlZCBjcHFSZXN0U2VydmljZTogQ3BxQ29uZmlndXJhdG9yUmVzdFNlcnZpY2UsXG4gICAgcHJvdGVjdGVkIGNwcU9jY1NlcnZpY2U6IENwcUNvbmZpZ3VyYXRvck9jY1NlcnZpY2VcbiAgKSB7fVxuXG4gIGdldENvbmZpZ3VyYXRvclR5cGUoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gQ29uZmlndXJhdG9yVHlwZS5DUFE7XG4gIH1cblxuICBzdXBwb3J0c0NwcU92ZXJPY2MoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgY3JlYXRlQ29uZmlndXJhdGlvbihcbiAgICBvd25lcjogQ29tbW9uQ29uZmlndXJhdG9yLk93bmVyXG4gICk6IE9ic2VydmFibGU8Q29uZmlndXJhdG9yLkNvbmZpZ3VyYXRpb24+IHtcbiAgICAvLyBubyBlcnJvciBoYW5kbGluZyBmb3IgbWlzc2luZyBvd25lciBpZCBuZWVkZWQsIGFzIGl0J3MgYVxuICAgIC8vIG1hbmRhdG9yeSBhdHRyaWJ1dGUgaW4gb3duZXJcbiAgICByZXR1cm4gdGhpcy5jcHFSZXN0U2VydmljZS5jcmVhdGVDb25maWd1cmF0aW9uKG93bmVyLmlkKS5waXBlKFxuICAgICAgbWFwKChjb25maWdSZXNwb25zZSkgPT4ge1xuICAgICAgICBjb25maWdSZXNwb25zZS5vd25lciA9IG93bmVyO1xuICAgICAgICByZXR1cm4gY29uZmlnUmVzcG9uc2U7XG4gICAgICB9KVxuICAgICk7XG4gIH1cblxuICByZWFkQ29uZmlndXJhdGlvbihcbiAgICBjb25maWdJZDogc3RyaW5nLFxuICAgIGdyb3VwSWQ6IHN0cmluZyxcbiAgICBvd25lcjogQ29tbW9uQ29uZmlndXJhdG9yLk93bmVyXG4gICk6IE9ic2VydmFibGU8Q29uZmlndXJhdG9yLkNvbmZpZ3VyYXRpb24+IHtcbiAgICByZXR1cm4gdGhpcy5jcHFSZXN0U2VydmljZS5yZWFkQ29uZmlndXJhdGlvbihjb25maWdJZCwgZ3JvdXBJZCkucGlwZShcbiAgICAgIG1hcCgoY29uZmlnUmVzcG9uc2UpID0+IHtcbiAgICAgICAgY29uZmlnUmVzcG9uc2Uub3duZXIgPSBvd25lcjtcbiAgICAgICAgcmV0dXJuIGNvbmZpZ1Jlc3BvbnNlO1xuICAgICAgfSlcbiAgICApO1xuICB9XG5cbiAgdXBkYXRlQ29uZmlndXJhdGlvbihcbiAgICBjb25maWd1cmF0aW9uOiBDb25maWd1cmF0b3IuQ29uZmlndXJhdGlvblxuICApOiBPYnNlcnZhYmxlPENvbmZpZ3VyYXRvci5Db25maWd1cmF0aW9uPiB7XG4gICAgY29uc3QgdXBkYXRlTWV0aG9kID1cbiAgICAgIGNvbmZpZ3VyYXRpb24udXBkYXRlVHlwZSA9PT0gQ29uZmlndXJhdG9yLlVwZGF0ZVR5cGUuVkFMVUVfUVVBTlRJVFlcbiAgICAgICAgPyB0aGlzLmNwcVJlc3RTZXJ2aWNlLnVwZGF0ZVZhbHVlUXVhbnRpdHlcbiAgICAgICAgOiB0aGlzLmNwcVJlc3RTZXJ2aWNlLnVwZGF0ZUF0dHJpYnV0ZTtcbiAgICByZXR1cm4gdXBkYXRlTWV0aG9kLmNhbGwodGhpcy5jcHFSZXN0U2VydmljZSwgY29uZmlndXJhdGlvbikucGlwZShcbiAgICAgIG1hcCgoY29uZmlnUmVzcG9uc2U6IENvbmZpZ3VyYXRvci5Db25maWd1cmF0aW9uKSA9PiB7XG4gICAgICAgIGNvbmZpZ1Jlc3BvbnNlLm93bmVyID0gY29uZmlndXJhdGlvbi5vd25lcjtcbiAgICAgICAgcmV0dXJuIGNvbmZpZ1Jlc3BvbnNlO1xuICAgICAgfSlcbiAgICApO1xuICB9XG5cbiAgdXBkYXRlQ29uZmlndXJhdGlvbk92ZXJ2aWV3KCk6IE9ic2VydmFibGU8Q29uZmlndXJhdG9yLk92ZXJ2aWV3PiB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgJ1VwZGF0ZSB0aGUgY29uZmlndXJhdGlvbiBvdmVydmlldyBpcyBub3Qgc3VwcG9ydGVkIGZvciB0aGUgQ1BRIGNvbmZpZ3VyYXRvcidcbiAgICApO1xuICB9XG5cbiAgYWRkVG9DYXJ0KFxuICAgIHBhcmFtZXRlcnM6IENvbmZpZ3VyYXRvci5BZGRUb0NhcnRQYXJhbWV0ZXJzXG4gICk6IE9ic2VydmFibGU8Q2FydE1vZGlmaWNhdGlvbj4ge1xuICAgIHJldHVybiB0aGlzLmNwcU9jY1NlcnZpY2UuYWRkVG9DYXJ0KHBhcmFtZXRlcnMpO1xuICB9XG5cbiAgcmVhZENvbmZpZ3VyYXRpb25Gb3JDYXJ0RW50cnkoXG4gICAgcGFyYW1ldGVyczogQ29tbW9uQ29uZmlndXJhdG9yLlJlYWRDb25maWd1cmF0aW9uRnJvbUNhcnRFbnRyeVBhcmFtZXRlcnNcbiAgKTogT2JzZXJ2YWJsZTxDb25maWd1cmF0b3IuQ29uZmlndXJhdGlvbj4ge1xuICAgIHJldHVybiB0aGlzLmNwcU9jY1NlcnZpY2UuZ2V0Q29uZmlnSWRGb3JDYXJ0RW50cnkocGFyYW1ldGVycykucGlwZShcbiAgICAgIHN3aXRjaE1hcCgoY29uZmlnSWQpID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3BxUmVzdFNlcnZpY2UucmVhZENvbmZpZ3VyYXRpb24oY29uZmlnSWQpLnBpcGUoXG4gICAgICAgICAgbWFwKChjb25maWdSZXNwb25zZSkgPT4ge1xuICAgICAgICAgICAgY29uZmlnUmVzcG9uc2Uub3duZXIgPSBwYXJhbWV0ZXJzLm93bmVyO1xuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZ1Jlc3BvbnNlO1xuICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgICB9KVxuICAgICk7XG4gIH1cblxuICB1cGRhdGVDb25maWd1cmF0aW9uRm9yQ2FydEVudHJ5KFxuICAgIHBhcmFtZXRlcnM6IENvbmZpZ3VyYXRvci5VcGRhdGVDb25maWd1cmF0aW9uRm9yQ2FydEVudHJ5UGFyYW1ldGVyc1xuICApOiBPYnNlcnZhYmxlPENhcnRNb2RpZmljYXRpb24+IHtcbiAgICByZXR1cm4gdGhpcy5jcHFPY2NTZXJ2aWNlLnVwZGF0ZUNhcnRFbnRyeShwYXJhbWV0ZXJzKTtcbiAgfVxuXG4gIHJlYWRDb25maWd1cmF0aW9uRm9yT3JkZXJFbnRyeShcbiAgICBwYXJhbWV0ZXJzOiBDb21tb25Db25maWd1cmF0b3IuUmVhZENvbmZpZ3VyYXRpb25Gcm9tT3JkZXJFbnRyeVBhcmFtZXRlcnNcbiAgKTogT2JzZXJ2YWJsZTxDb25maWd1cmF0b3IuQ29uZmlndXJhdGlvbj4ge1xuICAgIHJldHVybiB0aGlzLmNwcU9jY1NlcnZpY2UuZ2V0Q29uZmlnSWRGb3JPcmRlckVudHJ5KHBhcmFtZXRlcnMpLnBpcGUoXG4gICAgICBzd2l0Y2hNYXAoKGNvbmZpZ0lkKSA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmNwcVJlc3RTZXJ2aWNlLnJlYWRDb25maWd1cmF0aW9uKGNvbmZpZ0lkKS5waXBlKFxuICAgICAgICAgIG1hcCgoY29uZmlnUmVzcG9uc2UpID0+IHtcbiAgICAgICAgICAgIGNvbmZpZ1Jlc3BvbnNlLm93bmVyID0gcGFyYW1ldGVycy5vd25lcjtcbiAgICAgICAgICAgIHJldHVybiBjb25maWdSZXNwb25zZTtcbiAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgfSlcbiAgICApO1xuICB9XG5cbiAgcmVhZFByaWNlU3VtbWFyeShcbiAgICBjb25maWd1cmF0aW9uOiBDb25maWd1cmF0b3IuQ29uZmlndXJhdGlvblxuICApOiBPYnNlcnZhYmxlPENvbmZpZ3VyYXRvci5Db25maWd1cmF0aW9uPiB7XG4gICAgcmV0dXJuIG9mKGNvbmZpZ3VyYXRpb24pOyAvLyBzbyB0aGF0IFVJIGRvZXMgbm90IHJ1biBpbnRvIGV4Y2VwdGlvblxuICB9XG5cbiAgZ2V0Q29uZmlndXJhdGlvbk92ZXJ2aWV3KFxuICAgIGNvbmZpZ0lkOiBzdHJpbmdcbiAgKTogT2JzZXJ2YWJsZTxDb25maWd1cmF0b3IuT3ZlcnZpZXc+IHtcbiAgICByZXR1cm4gdGhpcy5jcHFSZXN0U2VydmljZS5yZWFkQ29uZmlndXJhdGlvbk92ZXJ2aWV3KGNvbmZpZ0lkKTtcbiAgfVxuXG4gIHNlYXJjaFZhcmlhbnRzKCk6IE9ic2VydmFibGU8Q29uZmlndXJhdG9yLlZhcmlhbnRbXT4ge1xuICAgIHRocm93IG5ldyBFcnJvcignc2VhcmNoVmFyaWFudHMgaXMgbm90IHN1cHBvcnRlZCBmb3IgdGhlIENQUSBjb25maWd1cmF0b3InKTtcbiAgfVxufVxuIl19