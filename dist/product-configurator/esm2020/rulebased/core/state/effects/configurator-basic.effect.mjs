/*
 * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>
 *
 * SPDX-License-Identifier: Apache-2.0
 */
import { Injectable, inject } from '@angular/core';
import { createEffect, ofType } from '@ngrx/effects';
import { select } from '@ngrx/store';
import { LoggerService, normalizeHttpError } from '@spartacus/core';
import { CommonConfigurator, } from '@spartacus/product-configurator/common';
import { catchError, filter, map, mergeMap, switchMap, take, } from 'rxjs/operators';
import { ConfiguratorActions } from '../actions/index';
import { ConfiguratorSelectors } from '../selectors/index';
import * as i0 from "@angular/core";
import * as i1 from "@ngrx/effects";
import * as i2 from "../../connectors/rulebased-configurator.connector";
import * as i3 from "@spartacus/product-configurator/common";
import * as i4 from "../../facade/utils/configurator-utils.service";
import * as i5 from "../../facade/configurator-group-status.service";
import * as i6 from "@ngrx/store";
import * as i7 from "./configurator-basic-effect.service";
/**
 * Common configurator effects, used for complex configurators like variant configurator
 * and CPQ
 */
export class ConfiguratorBasicEffects {
    constructor(actions$, configuratorCommonsConnector, commonConfigUtilsService, configuratorGroupUtilsService, configuratorGroupStatusService, store, configuratorBasicEffectService) {
        this.actions$ = actions$;
        this.configuratorCommonsConnector = configuratorCommonsConnector;
        this.commonConfigUtilsService = commonConfigUtilsService;
        this.configuratorGroupUtilsService = configuratorGroupUtilsService;
        this.configuratorGroupStatusService = configuratorGroupStatusService;
        this.store = store;
        this.configuratorBasicEffectService = configuratorBasicEffectService;
        this.logger = inject(LoggerService);
        this.createConfiguration$ = createEffect(() => this.actions$.pipe(ofType(ConfiguratorActions.CREATE_CONFIGURATION), mergeMap((action) => {
            return this.configuratorCommonsConnector
                .createConfiguration(action.payload.owner, action.payload.configIdTemplate, action.payload.forceReset)
                .pipe(switchMap((configuration) => {
                const currentGroup = this.configuratorBasicEffectService.getFirstGroupWithAttributes(configuration);
                this.store.dispatch(new ConfiguratorActions.UpdatePriceSummary({
                    ...configuration,
                    interactionState: { currentGroup: currentGroup },
                }));
                return [
                    new ConfiguratorActions.CreateConfigurationSuccess(configuration),
                    new ConfiguratorActions.SearchVariants(configuration),
                ];
            }), catchError((error) => [
                new ConfiguratorActions.CreateConfigurationFail({
                    ownerKey: action.payload.owner.key,
                    error: normalizeHttpError(error, this.logger),
                }),
            ]));
        })));
        this.readConfiguration$ = createEffect(() => this.actions$.pipe(ofType(ConfiguratorActions.READ_CONFIGURATION), mergeMap((action) => {
            return this.configuratorCommonsConnector
                .readConfiguration(action.payload.configuration.configId, action.payload.groupId, action.payload.configuration.owner)
                .pipe(switchMap((configuration) => [
                new ConfiguratorActions.ReadConfigurationSuccess(configuration),
            ]), catchError((error) => [
                new ConfiguratorActions.ReadConfigurationFail({
                    ownerKey: action.payload.configuration.owner.key,
                    error: normalizeHttpError(error, this.logger),
                }),
            ]));
        })));
        this.updateConfiguration$ = createEffect(() => this.actions$.pipe(ofType(ConfiguratorActions.UPDATE_CONFIGURATION), map((action) => action.payload), 
        //mergeMap here as we need to process each update
        //(which only sends one changed attribute at a time),
        //so we must not cancel inner emissions
        mergeMap((payload) => {
            return this.configuratorCommonsConnector
                .updateConfiguration(payload)
                .pipe(map((configuration) => {
                return new ConfiguratorActions.UpdateConfigurationSuccess({
                    ...configuration,
                    interactionState: {
                        isConflictResolutionMode: payload.interactionState.isConflictResolutionMode,
                    },
                });
            }), catchError((error) => {
                const errorPayload = normalizeHttpError(error, this.logger);
                return [
                    new ConfiguratorActions.UpdateConfigurationFail({
                        configuration: payload,
                        error: errorPayload,
                    }),
                ];
            }));
        })));
        this.updatePriceSummary$ = createEffect(() => this.actions$.pipe(ofType(ConfiguratorActions.UPDATE_PRICE_SUMMARY), map((action) => action.payload), filter((configuration) => configuration.pricingEnabled === true), mergeMap((payload) => {
            return this.configuratorCommonsConnector.readPriceSummary(payload).pipe(map((configuration) => {
                return new ConfiguratorActions.UpdatePriceSummarySuccess(configuration);
            }), catchError((error) => {
                const errorPayload = normalizeHttpError(error, this.logger);
                return [
                    new ConfiguratorActions.UpdatePriceSummaryFail({
                        ownerKey: payload.owner.key,
                        error: errorPayload,
                    }),
                ];
            }));
        })));
        this.getOverview$ = createEffect(() => this.actions$.pipe(ofType(ConfiguratorActions.GET_CONFIGURATION_OVERVIEW), map((action) => action.payload), mergeMap((payload) => {
            return this.configuratorCommonsConnector
                .getConfigurationOverview(payload)
                .pipe(map((overview) => {
                return new ConfiguratorActions.GetConfigurationOverviewSuccess({
                    ownerKey: payload.owner.key,
                    overview: overview,
                });
            }), catchError((error) => {
                const errorPayload = normalizeHttpError(error, this.logger);
                return [
                    new ConfiguratorActions.GetConfigurationOverviewFail({
                        ownerKey: payload.owner.key,
                        error: errorPayload,
                    }),
                ];
            }));
        })));
        this.updateOverview$ = createEffect(() => this.actions$.pipe(ofType(ConfiguratorActions.UPDATE_CONFIGURATION_OVERVIEW), map((action) => action.payload), mergeMap((payload) => {
            return this.configuratorCommonsConnector
                .updateConfigurationOverview(payload)
                .pipe(map((overview) => {
                return new ConfiguratorActions.UpdateConfigurationOverviewSuccess({
                    ownerKey: payload.owner.key,
                    overview: overview,
                });
            }), catchError((error) => {
                const errorPayload = normalizeHttpError(error, this.logger);
                return [
                    new ConfiguratorActions.UpdateConfigurationOverviewFail({
                        ownerKey: payload.owner.key,
                        error: errorPayload,
                    }),
                ];
            }));
        })));
        this.updateConfigurationSuccess$ = createEffect(() => this.actions$.pipe(ofType(ConfiguratorActions.UPDATE_CONFIGURATION_SUCCESS), map((action) => action.payload), mergeMap((payload) => {
            return this.store.pipe(select(ConfiguratorSelectors.hasPendingChanges(payload.owner.key)), take(1), filter((hasPendingChanges) => hasPendingChanges === false), switchMap(() => this.store.pipe(select(ConfiguratorSelectors.getCurrentGroup(payload.owner.key)), take(1), map((currentGroupId) => {
                // Group ids of conflict groups (Configurator.GroupType.CONFLICT_GROUP) always start with 'CONFLICT'
                const groupIdFromPayload = this.configuratorBasicEffectService.getFirstGroupWithAttributes(payload, payload.interactionState.isConflictResolutionMode);
                const parentGroupFromPayload = this.configuratorGroupUtilsService.getParentGroup(payload.groups, this.configuratorGroupUtilsService.getGroupById(payload.groups, groupIdFromPayload), undefined);
                return {
                    currentGroupId,
                    groupIdFromPayload,
                    parentGroupFromPayload,
                };
            }), switchMap((container) => {
                //changeGroup because in cases where a queue of updates exists with a group navigation in between,
                //we need to ensure that the last update determines the current group.
                const updateFinalizeSuccessAction = new ConfiguratorActions.UpdateConfigurationFinalizeSuccess(payload);
                const updatePriceSummaryAction = new ConfiguratorActions.UpdatePriceSummary({
                    ...payload,
                    interactionState: {
                        currentGroup: container.groupIdFromPayload,
                    },
                });
                const searchVariantsAction = new ConfiguratorActions.SearchVariants(payload);
                return container.currentGroupId ===
                    container.groupIdFromPayload
                    ? [
                        updateFinalizeSuccessAction,
                        updatePriceSummaryAction,
                        searchVariantsAction,
                    ]
                    : [
                        updateFinalizeSuccessAction,
                        updatePriceSummaryAction,
                        searchVariantsAction,
                        new ConfiguratorActions.ChangeGroup({
                            configuration: payload,
                            groupId: container.groupIdFromPayload,
                            parentGroupId: container.parentGroupFromPayload?.id,
                        }),
                    ];
            }))));
        })));
        this.updateConfigurationFail$ = createEffect(() => this.actions$.pipe(ofType(ConfiguratorActions.UPDATE_CONFIGURATION_FAIL), map((action) => action.payload), mergeMap((payload) => {
            return this.store.pipe(select(ConfiguratorSelectors.hasPendingChanges(payload.configuration.owner.key)), take(1), filter((hasPendingChanges) => hasPendingChanges === false), map(() => new ConfiguratorActions.UpdateConfigurationFinalizeFail(payload.configuration)));
        })));
        this.handleErrorOnUpdate$ = createEffect(() => this.actions$.pipe(ofType(ConfiguratorActions.UPDATE_CONFIGURATION_FINALIZE_FAIL), map((action) => action.payload), map((payload) => new ConfiguratorActions.ReadConfiguration({
            configuration: payload,
            groupId: this.configuratorBasicEffectService.getFirstGroupWithAttributes(payload),
        }))));
        this.groupChange$ = createEffect(() => this.actions$.pipe(ofType(ConfiguratorActions.CHANGE_GROUP), switchMap((action) => {
            return this.store.pipe(select(ConfiguratorSelectors.hasPendingChanges(action.payload.configuration.owner.key)), take(1), filter((hasPendingChanges) => hasPendingChanges === false), switchMap(() => {
                return this.configuratorCommonsConnector
                    .readConfiguration(action.payload.configuration.configId, action.payload.groupId, action.payload.configuration.owner)
                    .pipe(switchMap((configuration) => {
                    return [
                        new ConfiguratorActions.SetCurrentGroup({
                            entityKey: action.payload.configuration.owner.key,
                            currentGroup: action.payload.groupId,
                        }),
                        new ConfiguratorActions.SetMenuParentGroup({
                            entityKey: action.payload.configuration.owner.key,
                            menuParentGroup: action.payload.parentGroupId,
                        }),
                        new ConfiguratorActions.ReadConfigurationSuccess(configuration),
                        new ConfiguratorActions.UpdatePriceSummary({
                            ...configuration,
                            interactionState: {
                                currentGroup: action.payload.groupId,
                            },
                        }),
                    ];
                }), catchError((error) => [
                    new ConfiguratorActions.ReadConfigurationFail({
                        ownerKey: action.payload.configuration.owner.key,
                        error: normalizeHttpError(error, this.logger),
                    }),
                ]));
            }));
        })));
        this.removeProductBoundConfigurations$ = createEffect(() => this.actions$.pipe(ofType(ConfiguratorActions.REMOVE_PRODUCT_BOUND_CONFIGURATIONS), switchMap(() => {
            return this.store.pipe(select(ConfiguratorSelectors.getConfigurationsState), take(1), map((configuratorState) => {
                const entities = configuratorState.configurations.entities;
                const ownerKeysToRemove = [];
                for (const ownerKey in entities) {
                    if (ownerKey.includes(CommonConfigurator.OwnerType.PRODUCT)) {
                        ownerKeysToRemove.push(ownerKey);
                    }
                }
                return new ConfiguratorActions.RemoveConfiguration({
                    ownerKey: ownerKeysToRemove,
                });
            }));
        })));
    }
}
ConfiguratorBasicEffects.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: ConfiguratorBasicEffects, deps: [{ token: i1.Actions }, { token: i2.RulebasedConfiguratorConnector }, { token: i3.CommonConfiguratorUtilsService }, { token: i4.ConfiguratorUtilsService }, { token: i5.ConfiguratorGroupStatusService }, { token: i6.Store }, { token: i7.ConfiguratorBasicEffectService }], target: i0.ɵɵFactoryTarget.Injectable });
ConfiguratorBasicEffects.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: ConfiguratorBasicEffects });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: ConfiguratorBasicEffects, decorators: [{
            type: Injectable
        }], ctorParameters: function () { return [{ type: i1.Actions }, { type: i2.RulebasedConfiguratorConnector }, { type: i3.CommonConfiguratorUtilsService }, { type: i4.ConfiguratorUtilsService }, { type: i5.ConfiguratorGroupStatusService }, { type: i6.Store }, { type: i7.ConfiguratorBasicEffectService }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZmlndXJhdG9yLWJhc2ljLmVmZmVjdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL2ZlYXR1cmUtbGlicy9wcm9kdWN0LWNvbmZpZ3VyYXRvci9ydWxlYmFzZWQvY29yZS9zdGF0ZS9lZmZlY3RzL2NvbmZpZ3VyYXRvci1iYXNpYy5lZmZlY3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7R0FJRztBQUVILE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ25ELE9BQU8sRUFBVyxZQUFZLEVBQUUsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzlELE9BQU8sRUFBUyxNQUFNLEVBQUUsTUFBTSxhQUFhLENBQUM7QUFDNUMsT0FBTyxFQUFFLGFBQWEsRUFBRSxrQkFBa0IsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ3BFLE9BQU8sRUFDTCxrQkFBa0IsR0FFbkIsTUFBTSx3Q0FBd0MsQ0FBQztBQUVoRCxPQUFPLEVBQ0wsVUFBVSxFQUNWLE1BQU0sRUFDTixHQUFHLEVBQ0gsUUFBUSxFQUNSLFNBQVMsRUFDVCxJQUFJLEdBQ0wsTUFBTSxnQkFBZ0IsQ0FBQztBQUt4QixPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUV2RCxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQzs7Ozs7Ozs7O0FBVTNEOzs7R0FHRztBQUNILE1BQU0sT0FBTyx3QkFBd0I7SUFpYm5DLFlBQ1ksUUFBaUIsRUFDakIsNEJBQTRELEVBQzVELHdCQUF3RCxFQUN4RCw2QkFBdUQsRUFDdkQsOEJBQThELEVBQzlELEtBQW1DLEVBQ25DLDhCQUE4RDtRQU45RCxhQUFRLEdBQVIsUUFBUSxDQUFTO1FBQ2pCLGlDQUE0QixHQUE1Qiw0QkFBNEIsQ0FBZ0M7UUFDNUQsNkJBQXdCLEdBQXhCLHdCQUF3QixDQUFnQztRQUN4RCxrQ0FBNkIsR0FB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Q0FBQyxDQUFDLEVBQ1AsR0FBRyxDQUFDLENBQUMsaUJBQWlCLEVBQUUsRUFBRTtnQkFDeEIsTUFBTSxRQUFRLEdBQUcsaUJBQWlCLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQztnQkFFM0QsTUFBTSxpQkFBaUIsR0FBYSxFQUFFLENBQUM7Z0JBQ3ZDLEtBQUssTUFBTSxRQUFRLElBQUksUUFBUSxFQUFFO29CQUMvQixJQUFJLFFBQVEsQ0FBQyxRQUFRLENBQUMsa0JBQWtCLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxFQUFFO3dCQUMzRCxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7cUJBQ2xDO2lCQUNGO2dCQUVELE9BQU8sSUFBSSxtQkFBbUIsQ0FBQyxtQkFBbUIsQ0FBQztvQkFDakQsUUFBUSxFQUFFLGlCQUFpQjtpQkFDNUIsQ0FBQyxDQUFDO1lBQ0wsQ0FBQyxDQUFDLENBQ0gsQ0FBQztRQUNKLENBQUMsQ0FBQyxDQUNILENBQ0YsQ0FBQztJQVVELENBQUM7O3FIQXpiTyx3QkFBd0I7eUhBQXhCLHdCQUF3QjsyRkFBeEIsd0JBQXdCO2tCQUxwQyxVQUFVIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIFNQRFgtRmlsZUNvcHlyaWdodFRleHQ6IDIwMjMgU0FQIFNwYXJ0YWN1cyB0ZWFtIDxzcGFydGFjdXMtdGVhbUBzYXAuY29tPlxuICpcbiAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBBcGFjaGUtMi4wXG4gKi9cblxuaW1wb3J0IHsgSW5qZWN0YWJsZSwgaW5qZWN0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBBY3Rpb25zLCBjcmVhdGVFZmZlY3QsIG9mVHlwZSB9IGZyb20gJ0BuZ3J4L2VmZmVjdHMnO1xuaW1wb3J0IHsgU3RvcmUsIHNlbGVjdCB9IGZyb20gJ0BuZ3J4L3N0b3JlJztcbmltcG9ydCB7IExvZ2dlclNlcnZpY2UsIG5vcm1hbGl6ZUh0dHBFcnJvciB9IGZyb20gJ0BzcGFydGFjdXMvY29yZSc7XG5pbXBvcnQge1xuICBDb21tb25Db25maWd1cmF0b3IsXG4gIENvbW1vbkNvbmZpZ3VyYXRvclV0aWxzU2VydmljZSxcbn0gZnJvbSAnQHNwYXJ0YWN1cy9wcm9kdWN0LWNvbmZpZ3VyYXRvci9jb21tb24nO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHtcbiAgY2F0Y2hFcnJvcixcbiAgZmlsdGVyLFxuICBtYXAsXG4gIG1lcmdlTWFwLFxuICBzd2l0Y2hNYXAsXG4gIHRha2UsXG59IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IFJ1bGViYXNlZENvbmZpZ3VyYXRvckNvbm5lY3RvciB9IGZyb20gJy4uLy4uL2Nvbm5lY3RvcnMvcnVsZWJhc2VkLWNvbmZpZ3VyYXRvci5jb25uZWN0b3InO1xuaW1wb3J0IHsgQ29uZmlndXJhdG9yR3JvdXBTdGF0dXNTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vZmFjYWRlL2NvbmZpZ3VyYXRvci1ncm91cC1zdGF0dXMuc2VydmljZSc7XG5pbXBvcnQgeyBDb25maWd1cmF0b3JVdGlsc1NlcnZpY2UgfSBmcm9tICcuLi8uLi9mYWNhZGUvdXRpbHMvY29uZmlndXJhdG9yLXV0aWxzLnNlcnZpY2UnO1xuaW1wb3J0IHsgQ29uZmlndXJhdG9yIH0gZnJvbSAnLi4vLi4vbW9kZWwvY29uZmlndXJhdG9yLm1vZGVsJztcbmltcG9ydCB7IENvbmZpZ3VyYXRvckFjdGlvbnMgfSBmcm9tICcuLi9hY3Rpb25zL2luZGV4JztcbmltcG9ydCB7IFN0YXRlV2l0aENvbmZpZ3VyYXRvciB9IGZyb20gJy4uL2NvbmZpZ3VyYXRvci1zdGF0ZSc7XG5pbXBvcnQgeyBDb25maWd1cmF0b3JTZWxlY3RvcnMgfSBmcm9tICcuLi9zZWxlY3RvcnMvaW5kZXgnO1xuaW1wb3J0IHsgQ29uZmlndXJhdG9yQmFzaWNFZmZlY3RTZXJ2aWNlIH0gZnJvbSAnLi9jb25maWd1cmF0b3ItYmFzaWMtZWZmZWN0LnNlcnZpY2UnO1xuXG50eXBlIHVwZGF0ZUNvbmZpZ3VyYXRpb25TdWNjZXNzUmVzdWx0VHlwZSA9XG4gIHwgQ29uZmlndXJhdG9yQWN0aW9ucy5VcGRhdGVDb25maWd1cmF0aW9uRmluYWxpemVTdWNjZXNzXG4gIHwgQ29uZmlndXJhdG9yQWN0aW9ucy5VcGRhdGVQcmljZVN1bW1hcnlcbiAgfCBDb25maWd1cmF0b3JBY3Rpb25zLlNlYXJjaFZhcmlhbnRzXG4gIHwgQ29uZmlndXJhdG9yQWN0aW9ucy5DaGFuZ2VHcm91cDtcblxuQEluamVjdGFibGUoKVxuLyoqXG4gKiBDb21tb24gY29uZmlndXJhdG9yIGVmZmVjdHMsIHVzZWQgZm9yIGNvbXBsZXggY29uZmlndXJhdG9ycyBsaWtlIHZhcmlhbnQgY29uZmlndXJhdG9yXG4gKiBhbmQgQ1BRXG4gKi9cbmV4cG9ydCBjbGFzcyBDb25maWd1cmF0b3JCYXNpY0VmZmVjdHMge1xuICBwcm90ZWN0ZWQgbG9nZ2VyID0gaW5qZWN0KExvZ2dlclNlcnZpY2UpO1xuXG4gIGNyZWF0ZUNvbmZpZ3VyYXRpb24kOiBPYnNlcnZhYmxlPFxuICAgIHwgQ29uZmlndXJhdG9yQWN0aW9ucy5DcmVhdGVDb25maWd1cmF0aW9uU3VjY2Vzc1xuICAgIHwgQ29uZmlndXJhdG9yQWN0aW9ucy5TZWFyY2hWYXJpYW50c1xuICAgIHwgQ29uZmlndXJhdG9yQWN0aW9ucy5DcmVhdGVDb25maWd1cmF0aW9uRmFpbFxuICA+ID0gY3JlYXRlRWZmZWN0KCgpID0+XG4gICAgdGhpcy5hY3Rpb25zJC5waXBlKFxuICAgICAgb2ZUeXBlKENvbmZpZ3VyYXRvckFjdGlvbnMuQ1JFQVRFX0NPTkZJR1VSQVRJT04pLFxuICAgICAgbWVyZ2VNYXAoKGFjdGlvbjogQ29uZmlndXJhdG9yQWN0aW9ucy5DcmVhdGVDb25maWd1cmF0aW9uKSA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbmZpZ3VyYXRvckNvbW1vbnNDb25uZWN0b3JcbiAgICAgICAgICAuY3JlYXRlQ29uZmlndXJhdGlvbihcbiAgICAgICAgICAgIGFjdGlvbi5wYXlsb2FkLm93bmVyLFxuICAgICAgICAgICAgYWN0aW9uLnBheWxvYWQuY29uZmlnSWRUZW1wbGF0ZSxcbiAgICAgICAgICAgIGFjdGlvbi5wYXlsb2FkLmZvcmNlUmVzZXRcbiAgICAgICAgICApXG4gICAgICAgICAgLnBpcGUoXG4gICAgICAgICAgICBzd2l0Y2hNYXAoKGNvbmZpZ3VyYXRpb246IENvbmZpZ3VyYXRvci5Db25maWd1cmF0aW9uKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRHcm91cCA9XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWd1cmF0b3JCYXNpY0VmZmVjdFNlcnZpY2UuZ2V0Rmlyc3RHcm91cFdpdGhBdHRyaWJ1dGVzKFxuICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvblxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIHRoaXMuc3RvcmUuZGlzcGF0Y2goXG4gICAgICAgICAgICAgICAgbmV3IENvbmZpZ3VyYXRvckFjdGlvbnMuVXBkYXRlUHJpY2VTdW1tYXJ5KHtcbiAgICAgICAgICAgICAgICAgIC4uLmNvbmZpZ3VyYXRpb24sXG4gICAgICAgICAgICAgICAgICBpbnRlcmFjdGlvblN0YXRlOiB7IGN1cnJlbnRHcm91cDogY3VycmVudEdyb3VwIH0sXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgICAgIG5ldyBDb25maWd1cmF0b3JBY3Rpb25zLkNyZWF0ZUNvbmZpZ3VyYXRpb25TdWNjZXNzKFxuICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvblxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgbmV3IENvbmZpZ3VyYXRvckFjdGlvbnMuU2VhcmNoVmFyaWFudHMoY29uZmlndXJhdGlvbiksXG4gICAgICAgICAgICAgIF07XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGNhdGNoRXJyb3IoKGVycm9yKSA9PiBbXG4gICAgICAgICAgICAgIG5ldyBDb25maWd1cmF0b3JBY3Rpb25zLkNyZWF0ZUNvbmZpZ3VyYXRpb25GYWlsKHtcbiAgICAgICAgICAgICAgICBvd25lcktleTogYWN0aW9uLnBheWxvYWQub3duZXIua2V5LFxuICAgICAgICAgICAgICAgIGVycm9yOiBub3JtYWxpemVIdHRwRXJyb3IoZXJyb3IsIHRoaXMubG9nZ2VyKSxcbiAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBdKVxuICAgICAgICAgICk7XG4gICAgICB9KVxuICAgIClcbiAgKTtcblxuICByZWFkQ29uZmlndXJhdGlvbiQ6IE9ic2VydmFibGU8XG4gICAgfCBDb25maWd1cmF0b3JBY3Rpb25zLlJlYWRDb25maWd1cmF0aW9uU3VjY2Vzc1xuICAgIHwgQ29uZmlndXJhdG9yQWN0aW9ucy5SZWFkQ29uZmlndXJhdGlvbkZhaWxcbiAgPiA9IGNyZWF0ZUVmZmVjdCgoKSA9PlxuICAgIHRoaXMuYWN0aW9ucyQucGlwZShcbiAgICAgIG9mVHlwZShDb25maWd1cmF0b3JBY3Rpb25zLlJFQURfQ09ORklHVVJBVElPTiksXG5cbiAgICAgIG1lcmdlTWFwKChhY3Rpb246IENvbmZpZ3VyYXRvckFjdGlvbnMuUmVhZENvbmZpZ3VyYXRpb24pID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uZmlndXJhdG9yQ29tbW9uc0Nvbm5lY3RvclxuICAgICAgICAgIC5yZWFkQ29uZmlndXJhdGlvbihcbiAgICAgICAgICAgIGFjdGlvbi5wYXlsb2FkLmNvbmZpZ3VyYXRpb24uY29uZmlnSWQsXG4gICAgICAgICAgICBhY3Rpb24ucGF5bG9hZC5ncm91cElkLFxuICAgICAgICAgICAgYWN0aW9uLnBheWxvYWQuY29uZmlndXJhdGlvbi5vd25lclxuICAgICAgICAgIClcbiAgICAgICAgICAucGlwZShcbiAgICAgICAgICAgIHN3aXRjaE1hcCgoY29uZmlndXJhdGlvbjogQ29uZmlndXJhdG9yLkNvbmZpZ3VyYXRpb24pID0+IFtcbiAgICAgICAgICAgICAgbmV3IENvbmZpZ3VyYXRvckFjdGlvbnMuUmVhZENvbmZpZ3VyYXRpb25TdWNjZXNzKGNvbmZpZ3VyYXRpb24pLFxuICAgICAgICAgICAgXSksXG4gICAgICAgICAgICBjYXRjaEVycm9yKChlcnJvcikgPT4gW1xuICAgICAgICAgICAgICBuZXcgQ29uZmlndXJhdG9yQWN0aW9ucy5SZWFkQ29uZmlndXJhdGlvbkZhaWwoe1xuICAgICAgICAgICAgICAgIG93bmVyS2V5OiBhY3Rpb24ucGF5bG9hZC5jb25maWd1cmF0aW9uLm93bmVyLmtleSxcbiAgICAgICAgICAgICAgICBlcnJvcjogbm9ybWFsaXplSHR0cEVycm9yKGVycm9yLCB0aGlzLmxvZ2dlciksXG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgXSlcbiAgICAgICAgICApO1xuICAgICAgfSlcbiAgICApXG4gICk7XG5cbiAgdXBkYXRlQ29uZmlndXJhdGlvbiQ6IE9ic2VydmFibGU8XG4gICAgfCBDb25maWd1cmF0b3JBY3Rpb25zLlVwZGF0ZUNvbmZpZ3VyYXRpb25TdWNjZXNzXG4gICAgfCBDb25maWd1cmF0b3JBY3Rpb25zLlVwZGF0ZUNvbmZpZ3VyYXRpb25GYWlsXG4gID4gPSBjcmVhdGVFZmZlY3QoKCkgPT5cbiAgICB0aGlzLmFjdGlvbnMkLnBpcGUoXG4gICAgICBvZlR5cGUoQ29uZmlndXJhdG9yQWN0aW9ucy5VUERBVEVfQ09ORklHVVJBVElPTiksXG4gICAgICBtYXAoKGFjdGlvbjogQ29uZmlndXJhdG9yQWN0aW9ucy5VcGRhdGVDb25maWd1cmF0aW9uKSA9PiBhY3Rpb24ucGF5bG9hZCksXG4gICAgICAvL21lcmdlTWFwIGhlcmUgYXMgd2UgbmVlZCB0byBwcm9jZXNzIGVhY2ggdXBkYXRlXG4gICAgICAvLyh3aGljaCBvbmx5IHNlbmRzIG9uZSBjaGFuZ2VkIGF0dHJpYnV0ZSBhdCBhIHRpbWUpLFxuICAgICAgLy9zbyB3ZSBtdXN0IG5vdCBjYW5jZWwgaW5uZXIgZW1pc3Npb25zXG4gICAgICBtZXJnZU1hcCgocGF5bG9hZDogQ29uZmlndXJhdG9yLkNvbmZpZ3VyYXRpb24pID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uZmlndXJhdG9yQ29tbW9uc0Nvbm5lY3RvclxuICAgICAgICAgIC51cGRhdGVDb25maWd1cmF0aW9uKHBheWxvYWQpXG4gICAgICAgICAgLnBpcGUoXG4gICAgICAgICAgICBtYXAoKGNvbmZpZ3VyYXRpb246IENvbmZpZ3VyYXRvci5Db25maWd1cmF0aW9uKSA9PiB7XG4gICAgICAgICAgICAgIHJldHVybiBuZXcgQ29uZmlndXJhdG9yQWN0aW9ucy5VcGRhdGVDb25maWd1cmF0aW9uU3VjY2Vzcyh7XG4gICAgICAgICAgICAgICAgLi4uY29uZmlndXJhdGlvbixcbiAgICAgICAgICAgICAgICBpbnRlcmFjdGlvblN0YXRlOiB7XG4gICAgICAgICAgICAgICAgICBpc0NvbmZsaWN0UmVzb2x1dGlvbk1vZGU6XG4gICAgICAgICAgICAgICAgICAgIHBheWxvYWQuaW50ZXJhY3Rpb25TdGF0ZS5pc0NvbmZsaWN0UmVzb2x1dGlvbk1vZGUsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGNhdGNoRXJyb3IoKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IGVycm9yUGF5bG9hZCA9IG5vcm1hbGl6ZUh0dHBFcnJvcihlcnJvciwgdGhpcy5sb2dnZXIpO1xuICAgICAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgICAgIG5ldyBDb25maWd1cmF0b3JBY3Rpb25zLlVwZGF0ZUNvbmZpZ3VyYXRpb25GYWlsKHtcbiAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb246IHBheWxvYWQsXG4gICAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3JQYXlsb2FkLFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICApO1xuICAgICAgfSlcbiAgICApXG4gICk7XG5cbiAgdXBkYXRlUHJpY2VTdW1tYXJ5JDogT2JzZXJ2YWJsZTxcbiAgICB8IENvbmZpZ3VyYXRvckFjdGlvbnMuVXBkYXRlUHJpY2VTdW1tYXJ5U3VjY2Vzc1xuICAgIHwgQ29uZmlndXJhdG9yQWN0aW9ucy5VcGRhdGVQcmljZVN1bW1hcnlGYWlsXG4gID4gPSBjcmVhdGVFZmZlY3QoKCkgPT5cbiAgICB0aGlzLmFjdGlvbnMkLnBpcGUoXG4gICAgICBvZlR5cGUoQ29uZmlndXJhdG9yQWN0aW9ucy5VUERBVEVfUFJJQ0VfU1VNTUFSWSksXG4gICAgICBtYXAoXG4gICAgICAgIChhY3Rpb246IHsgdHlwZTogc3RyaW5nOyBwYXlsb2FkOiBDb25maWd1cmF0b3IuQ29uZmlndXJhdGlvbiB9KSA9PlxuICAgICAgICAgIGFjdGlvbi5wYXlsb2FkXG4gICAgICApLFxuICAgICAgZmlsdGVyKChjb25maWd1cmF0aW9uKSA9PiBjb25maWd1cmF0aW9uLnByaWNpbmdFbmFibGVkID09PSB0cnVlKSxcbiAgICAgIG1lcmdlTWFwKChwYXlsb2FkKSA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbmZpZ3VyYXRvckNvbW1vbnNDb25uZWN0b3IucmVhZFByaWNlU3VtbWFyeShwYXlsb2FkKS5waXBlKFxuICAgICAgICAgIG1hcCgoY29uZmlndXJhdGlvbjogQ29uZmlndXJhdG9yLkNvbmZpZ3VyYXRpb24pID0+IHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQ29uZmlndXJhdG9yQWN0aW9ucy5VcGRhdGVQcmljZVN1bW1hcnlTdWNjZXNzKFxuICAgICAgICAgICAgICBjb25maWd1cmF0aW9uXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH0pLFxuICAgICAgICAgIGNhdGNoRXJyb3IoKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlcnJvclBheWxvYWQgPSBub3JtYWxpemVIdHRwRXJyb3IoZXJyb3IsIHRoaXMubG9nZ2VyKTtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgIG5ldyBDb25maWd1cmF0b3JBY3Rpb25zLlVwZGF0ZVByaWNlU3VtbWFyeUZhaWwoe1xuICAgICAgICAgICAgICAgIG93bmVyS2V5OiBwYXlsb2FkLm93bmVyLmtleSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3JQYXlsb2FkLFxuICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgIH0pXG4gICAgKVxuICApO1xuXG4gIGdldE92ZXJ2aWV3JDogT2JzZXJ2YWJsZTxcbiAgICB8IENvbmZpZ3VyYXRvckFjdGlvbnMuR2V0Q29uZmlndXJhdGlvbk92ZXJ2aWV3U3VjY2Vzc1xuICAgIHwgQ29uZmlndXJhdG9yQWN0aW9ucy5HZXRDb25maWd1cmF0aW9uT3ZlcnZpZXdGYWlsXG4gID4gPSBjcmVhdGVFZmZlY3QoKCkgPT5cbiAgICB0aGlzLmFjdGlvbnMkLnBpcGUoXG4gICAgICBvZlR5cGUoQ29uZmlndXJhdG9yQWN0aW9ucy5HRVRfQ09ORklHVVJBVElPTl9PVkVSVklFVyksXG4gICAgICBtYXAoXG4gICAgICAgIChhY3Rpb246IENvbmZpZ3VyYXRvckFjdGlvbnMuR2V0Q29uZmlndXJhdGlvbk92ZXJ2aWV3KSA9PiBhY3Rpb24ucGF5bG9hZFxuICAgICAgKSxcbiAgICAgIG1lcmdlTWFwKChwYXlsb2FkKSA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbmZpZ3VyYXRvckNvbW1vbnNDb25uZWN0b3JcbiAgICAgICAgICAuZ2V0Q29uZmlndXJhdGlvbk92ZXJ2aWV3KHBheWxvYWQpXG4gICAgICAgICAgLnBpcGUoXG4gICAgICAgICAgICBtYXAoKG92ZXJ2aWV3OiBDb25maWd1cmF0b3IuT3ZlcnZpZXcpID0+IHtcbiAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb25maWd1cmF0b3JBY3Rpb25zLkdldENvbmZpZ3VyYXRpb25PdmVydmlld1N1Y2Nlc3Moe1xuICAgICAgICAgICAgICAgIG93bmVyS2V5OiBwYXlsb2FkLm93bmVyLmtleSxcbiAgICAgICAgICAgICAgICBvdmVydmlldzogb3ZlcnZpZXcsXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBjYXRjaEVycm9yKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBlcnJvclBheWxvYWQgPSBub3JtYWxpemVIdHRwRXJyb3IoZXJyb3IsIHRoaXMubG9nZ2VyKTtcbiAgICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICBuZXcgQ29uZmlndXJhdG9yQWN0aW9ucy5HZXRDb25maWd1cmF0aW9uT3ZlcnZpZXdGYWlsKHtcbiAgICAgICAgICAgICAgICAgIG93bmVyS2V5OiBwYXlsb2FkLm93bmVyLmtleSxcbiAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvclBheWxvYWQsXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgIF07XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICk7XG4gICAgICB9KVxuICAgIClcbiAgKTtcblxuICB1cGRhdGVPdmVydmlldyQ6IE9ic2VydmFibGU8XG4gICAgfCBDb25maWd1cmF0b3JBY3Rpb25zLlVwZGF0ZUNvbmZpZ3VyYXRpb25PdmVydmlld1N1Y2Nlc3NcbiAgICB8IENvbmZpZ3VyYXRvckFjdGlvbnMuVXBkYXRlQ29uZmlndXJhdGlvbk92ZXJ2aWV3RmFpbFxuICA+ID0gY3JlYXRlRWZmZWN0KCgpID0+XG4gICAgdGhpcy5hY3Rpb25zJC5waXBlKFxuICAgICAgb2ZUeXBlKENvbmZpZ3VyYXRvckFjdGlvbnMuVVBEQVRFX0NPTkZJR1VSQVRJT05fT1ZFUlZJRVcpLFxuICAgICAgbWFwKFxuICAgICAgICAoYWN0aW9uOiBDb25maWd1cmF0b3JBY3Rpb25zLlVwZGF0ZUNvbmZpZ3VyYXRpb25PdmVydmlldykgPT5cbiAgICAgICAgICBhY3Rpb24ucGF5bG9hZFxuICAgICAgKSxcbiAgICAgIG1lcmdlTWFwKChwYXlsb2FkKSA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbmZpZ3VyYXRvckNvbW1vbnNDb25uZWN0b3JcbiAgICAgICAgICAudXBkYXRlQ29uZmlndXJhdGlvbk92ZXJ2aWV3KHBheWxvYWQpXG4gICAgICAgICAgLnBpcGUoXG4gICAgICAgICAgICBtYXAoKG92ZXJ2aWV3OiBDb25maWd1cmF0b3IuT3ZlcnZpZXcpID0+IHtcbiAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb25maWd1cmF0b3JBY3Rpb25zLlVwZGF0ZUNvbmZpZ3VyYXRpb25PdmVydmlld1N1Y2Nlc3MoXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgb3duZXJLZXk6IHBheWxvYWQub3duZXIua2V5LFxuICAgICAgICAgICAgICAgICAgb3ZlcnZpZXc6IG92ZXJ2aWV3LFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgY2F0Y2hFcnJvcigoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgZXJyb3JQYXlsb2FkID0gbm9ybWFsaXplSHR0cEVycm9yKGVycm9yLCB0aGlzLmxvZ2dlcik7XG4gICAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgbmV3IENvbmZpZ3VyYXRvckFjdGlvbnMuVXBkYXRlQ29uZmlndXJhdGlvbk92ZXJ2aWV3RmFpbCh7XG4gICAgICAgICAgICAgICAgICBvd25lcktleTogcGF5bG9hZC5vd25lci5rZXksXG4gICAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3JQYXlsb2FkLFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICApO1xuICAgICAgfSlcbiAgICApXG4gICk7XG5cbiAgdXBkYXRlQ29uZmlndXJhdGlvblN1Y2Nlc3MkOiBPYnNlcnZhYmxlPHVwZGF0ZUNvbmZpZ3VyYXRpb25TdWNjZXNzUmVzdWx0VHlwZT4gPVxuICAgIGNyZWF0ZUVmZmVjdCgoKSA9PlxuICAgICAgdGhpcy5hY3Rpb25zJC5waXBlKFxuICAgICAgICBvZlR5cGUoQ29uZmlndXJhdG9yQWN0aW9ucy5VUERBVEVfQ09ORklHVVJBVElPTl9TVUNDRVNTKSxcbiAgICAgICAgbWFwKFxuICAgICAgICAgIChhY3Rpb246IENvbmZpZ3VyYXRvckFjdGlvbnMuVXBkYXRlQ29uZmlndXJhdGlvblN1Y2Nlc3MpID0+XG4gICAgICAgICAgICBhY3Rpb24ucGF5bG9hZFxuICAgICAgICApLFxuICAgICAgICBtZXJnZU1hcCgocGF5bG9hZDogQ29uZmlndXJhdG9yLkNvbmZpZ3VyYXRpb24pID0+IHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5zdG9yZS5waXBlKFxuICAgICAgICAgICAgc2VsZWN0KENvbmZpZ3VyYXRvclNlbGVjdG9ycy5oYXNQZW5kaW5nQ2hhbmdlcyhwYXlsb2FkLm93bmVyLmtleSkpLFxuICAgICAgICAgICAgdGFrZSgxKSxcbiAgICAgICAgICAgIGZpbHRlcigoaGFzUGVuZGluZ0NoYW5nZXMpID0+IGhhc1BlbmRpbmdDaGFuZ2VzID09PSBmYWxzZSksXG4gICAgICAgICAgICBzd2l0Y2hNYXAoKCkgPT5cbiAgICAgICAgICAgICAgdGhpcy5zdG9yZS5waXBlKFxuICAgICAgICAgICAgICAgIHNlbGVjdChcbiAgICAgICAgICAgICAgICAgIENvbmZpZ3VyYXRvclNlbGVjdG9ycy5nZXRDdXJyZW50R3JvdXAocGF5bG9hZC5vd25lci5rZXkpXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICB0YWtlKDEpLFxuICAgICAgICAgICAgICAgIG1hcCgoY3VycmVudEdyb3VwSWQpID0+IHtcbiAgICAgICAgICAgICAgICAgIC8vIEdyb3VwIGlkcyBvZiBjb25mbGljdCBncm91cHMgKENvbmZpZ3VyYXRvci5Hcm91cFR5cGUuQ09ORkxJQ1RfR1JPVVApIGFsd2F5cyBzdGFydCB3aXRoICdDT05GTElDVCdcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGdyb3VwSWRGcm9tUGF5bG9hZCA9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlndXJhdG9yQmFzaWNFZmZlY3RTZXJ2aWNlLmdldEZpcnN0R3JvdXBXaXRoQXR0cmlidXRlcyhcbiAgICAgICAgICAgICAgICAgICAgICBwYXlsb2FkLFxuICAgICAgICAgICAgICAgICAgICAgIHBheWxvYWQuaW50ZXJhY3Rpb25TdGF0ZS5pc0NvbmZsaWN0UmVzb2x1dGlvbk1vZGVcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudEdyb3VwRnJvbVBheWxvYWQgPVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZ3VyYXRvckdyb3VwVXRpbHNTZXJ2aWNlLmdldFBhcmVudEdyb3VwKFxuICAgICAgICAgICAgICAgICAgICAgIHBheWxvYWQuZ3JvdXBzLFxuICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlndXJhdG9yR3JvdXBVdGlsc1NlcnZpY2UuZ2V0R3JvdXBCeUlkKFxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bG9hZC5ncm91cHMsXG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cElkRnJvbVBheWxvYWRcbiAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudEdyb3VwSWQsXG4gICAgICAgICAgICAgICAgICAgIGdyb3VwSWRGcm9tUGF5bG9hZCxcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50R3JvdXBGcm9tUGF5bG9hZCxcbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgc3dpdGNoTWFwKChjb250YWluZXIpID0+IHtcbiAgICAgICAgICAgICAgICAgIC8vY2hhbmdlR3JvdXAgYmVjYXVzZSBpbiBjYXNlcyB3aGVyZSBhIHF1ZXVlIG9mIHVwZGF0ZXMgZXhpc3RzIHdpdGggYSBncm91cCBuYXZpZ2F0aW9uIGluIGJldHdlZW4sXG4gICAgICAgICAgICAgICAgICAvL3dlIG5lZWQgdG8gZW5zdXJlIHRoYXQgdGhlIGxhc3QgdXBkYXRlIGRldGVybWluZXMgdGhlIGN1cnJlbnQgZ3JvdXAuXG4gICAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVGaW5hbGl6ZVN1Y2Nlc3NBY3Rpb24gPVxuICAgICAgICAgICAgICAgICAgICBuZXcgQ29uZmlndXJhdG9yQWN0aW9ucy5VcGRhdGVDb25maWd1cmF0aW9uRmluYWxpemVTdWNjZXNzKFxuICAgICAgICAgICAgICAgICAgICAgIHBheWxvYWRcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZVByaWNlU3VtbWFyeUFjdGlvbiA9XG4gICAgICAgICAgICAgICAgICAgIG5ldyBDb25maWd1cmF0b3JBY3Rpb25zLlVwZGF0ZVByaWNlU3VtbWFyeSh7XG4gICAgICAgICAgICAgICAgICAgICAgLi4ucGF5bG9hZCxcbiAgICAgICAgICAgICAgICAgICAgICBpbnRlcmFjdGlvblN0YXRlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50R3JvdXA6IGNvbnRhaW5lci5ncm91cElkRnJvbVBheWxvYWQsXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICBjb25zdCBzZWFyY2hWYXJpYW50c0FjdGlvbiA9XG4gICAgICAgICAgICAgICAgICAgIG5ldyBDb25maWd1cmF0b3JBY3Rpb25zLlNlYXJjaFZhcmlhbnRzKHBheWxvYWQpO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRhaW5lci5jdXJyZW50R3JvdXBJZCA9PT1cbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLmdyb3VwSWRGcm9tUGF5bG9hZFxuICAgICAgICAgICAgICAgICAgICA/IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZUZpbmFsaXplU3VjY2Vzc0FjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVByaWNlU3VtbWFyeUFjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaFZhcmlhbnRzQWN0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVGaW5hbGl6ZVN1Y2Nlc3NBY3Rpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVQcmljZVN1bW1hcnlBY3Rpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hWYXJpYW50c0FjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBDb25maWd1cmF0b3JBY3Rpb25zLkNoYW5nZUdyb3VwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbjogcGF5bG9hZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBJZDogY29udGFpbmVyLmdyb3VwSWRGcm9tUGF5bG9hZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50R3JvdXBJZDogY29udGFpbmVyLnBhcmVudEdyb3VwRnJvbVBheWxvYWQ/LmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICApXG4gICAgICAgICAgKTtcbiAgICAgICAgfSlcbiAgICAgIClcbiAgICApO1xuXG4gIHVwZGF0ZUNvbmZpZ3VyYXRpb25GYWlsJDogT2JzZXJ2YWJsZTxDb25maWd1cmF0b3JBY3Rpb25zLlVwZGF0ZUNvbmZpZ3VyYXRpb25GaW5hbGl6ZUZhaWw+ID1cbiAgICBjcmVhdGVFZmZlY3QoKCkgPT5cbiAgICAgIHRoaXMuYWN0aW9ucyQucGlwZShcbiAgICAgICAgb2ZUeXBlKENvbmZpZ3VyYXRvckFjdGlvbnMuVVBEQVRFX0NPTkZJR1VSQVRJT05fRkFJTCksXG4gICAgICAgIG1hcChcbiAgICAgICAgICAoYWN0aW9uOiBDb25maWd1cmF0b3JBY3Rpb25zLlVwZGF0ZUNvbmZpZ3VyYXRpb25GYWlsKSA9PlxuICAgICAgICAgICAgYWN0aW9uLnBheWxvYWRcbiAgICAgICAgKSxcbiAgICAgICAgbWVyZ2VNYXAoKHBheWxvYWQpID0+IHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5zdG9yZS5waXBlKFxuICAgICAgICAgICAgc2VsZWN0KFxuICAgICAgICAgICAgICBDb25maWd1cmF0b3JTZWxlY3RvcnMuaGFzUGVuZGluZ0NoYW5nZXMoXG4gICAgICAgICAgICAgICAgcGF5bG9hZC5jb25maWd1cmF0aW9uLm93bmVyLmtleVxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgdGFrZSgxKSxcbiAgICAgICAgICAgIGZpbHRlcigoaGFzUGVuZGluZ0NoYW5nZXMpID0+IGhhc1BlbmRpbmdDaGFuZ2VzID09PSBmYWxzZSksXG4gICAgICAgICAgICBtYXAoXG4gICAgICAgICAgICAgICgpID0+XG4gICAgICAgICAgICAgICAgbmV3IENvbmZpZ3VyYXRvckFjdGlvbnMuVXBkYXRlQ29uZmlndXJhdGlvbkZpbmFsaXplRmFpbChcbiAgICAgICAgICAgICAgICAgIHBheWxvYWQuY29uZmlndXJhdGlvblxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgIClcbiAgICAgICAgICApO1xuICAgICAgICB9KVxuICAgICAgKVxuICAgICk7XG5cbiAgaGFuZGxlRXJyb3JPblVwZGF0ZSQ6IE9ic2VydmFibGU8Q29uZmlndXJhdG9yQWN0aW9ucy5SZWFkQ29uZmlndXJhdGlvbj4gPVxuICAgIGNyZWF0ZUVmZmVjdCgoKSA9PlxuICAgICAgdGhpcy5hY3Rpb25zJC5waXBlKFxuICAgICAgICBvZlR5cGUoQ29uZmlndXJhdG9yQWN0aW9ucy5VUERBVEVfQ09ORklHVVJBVElPTl9GSU5BTElaRV9GQUlMKSxcbiAgICAgICAgbWFwKFxuICAgICAgICAgIChhY3Rpb246IENvbmZpZ3VyYXRvckFjdGlvbnMuVXBkYXRlQ29uZmlndXJhdGlvbkZpbmFsaXplRmFpbCkgPT5cbiAgICAgICAgICAgIGFjdGlvbi5wYXlsb2FkXG4gICAgICAgICksXG4gICAgICAgIG1hcChcbiAgICAgICAgICAocGF5bG9hZCkgPT5cbiAgICAgICAgICAgIG5ldyBDb25maWd1cmF0b3JBY3Rpb25zLlJlYWRDb25maWd1cmF0aW9uKHtcbiAgICAgICAgICAgICAgY29uZmlndXJhdGlvbjogcGF5bG9hZCxcbiAgICAgICAgICAgICAgZ3JvdXBJZDpcbiAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZ3VyYXRvckJhc2ljRWZmZWN0U2VydmljZS5nZXRGaXJzdEdyb3VwV2l0aEF0dHJpYnV0ZXMoXG4gICAgICAgICAgICAgICAgICBwYXlsb2FkXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIH0pXG4gICAgICAgIClcbiAgICAgIClcbiAgICApO1xuXG4gIGdyb3VwQ2hhbmdlJDogT2JzZXJ2YWJsZTxcbiAgICB8IENvbmZpZ3VyYXRvckFjdGlvbnMuU2V0Q3VycmVudEdyb3VwXG4gICAgfCBDb25maWd1cmF0b3JBY3Rpb25zLlNldE1lbnVQYXJlbnRHcm91cFxuICAgIHwgQ29uZmlndXJhdG9yQWN0aW9ucy5SZWFkQ29uZmlndXJhdGlvbkZhaWxcbiAgICB8IENvbmZpZ3VyYXRvckFjdGlvbnMuUmVhZENvbmZpZ3VyYXRpb25TdWNjZXNzXG4gICAgfCBDb25maWd1cmF0b3JBY3Rpb25zLlVwZGF0ZVByaWNlU3VtbWFyeVxuICA+ID0gY3JlYXRlRWZmZWN0KCgpID0+XG4gICAgdGhpcy5hY3Rpb25zJC5waXBlKFxuICAgICAgb2ZUeXBlKENvbmZpZ3VyYXRvckFjdGlvbnMuQ0hBTkdFX0dST1VQKSxcbiAgICAgIHN3aXRjaE1hcCgoYWN0aW9uOiBDb25maWd1cmF0b3JBY3Rpb25zLkNoYW5nZUdyb3VwKSA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JlLnBpcGUoXG4gICAgICAgICAgc2VsZWN0KFxuICAgICAgICAgICAgQ29uZmlndXJhdG9yU2VsZWN0b3JzLmhhc1BlbmRpbmdDaGFuZ2VzKFxuICAgICAgICAgICAgICBhY3Rpb24ucGF5bG9hZC5jb25maWd1cmF0aW9uLm93bmVyLmtleVxuICAgICAgICAgICAgKVxuICAgICAgICAgICksXG4gICAgICAgICAgdGFrZSgxKSxcbiAgICAgICAgICBmaWx0ZXIoKGhhc1BlbmRpbmdDaGFuZ2VzKSA9PiBoYXNQZW5kaW5nQ2hhbmdlcyA9PT0gZmFsc2UpLFxuICAgICAgICAgIHN3aXRjaE1hcCgoKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb25maWd1cmF0b3JDb21tb25zQ29ubmVjdG9yXG4gICAgICAgICAgICAgIC5yZWFkQ29uZmlndXJhdGlvbihcbiAgICAgICAgICAgICAgICBhY3Rpb24ucGF5bG9hZC5jb25maWd1cmF0aW9uLmNvbmZpZ0lkLFxuICAgICAgICAgICAgICAgIGFjdGlvbi5wYXlsb2FkLmdyb3VwSWQsXG4gICAgICAgICAgICAgICAgYWN0aW9uLnBheWxvYWQuY29uZmlndXJhdGlvbi5vd25lclxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgIC5waXBlKFxuICAgICAgICAgICAgICAgIHN3aXRjaE1hcCgoY29uZmlndXJhdGlvbjogQ29uZmlndXJhdG9yLkNvbmZpZ3VyYXRpb24pID0+IHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgICAgIG5ldyBDb25maWd1cmF0b3JBY3Rpb25zLlNldEN1cnJlbnRHcm91cCh7XG4gICAgICAgICAgICAgICAgICAgICAgZW50aXR5S2V5OiBhY3Rpb24ucGF5bG9hZC5jb25maWd1cmF0aW9uLm93bmVyLmtleSxcbiAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50R3JvdXA6IGFjdGlvbi5wYXlsb2FkLmdyb3VwSWQsXG4gICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICBuZXcgQ29uZmlndXJhdG9yQWN0aW9ucy5TZXRNZW51UGFyZW50R3JvdXAoe1xuICAgICAgICAgICAgICAgICAgICAgIGVudGl0eUtleTogYWN0aW9uLnBheWxvYWQuY29uZmlndXJhdGlvbi5vd25lci5rZXksXG4gICAgICAgICAgICAgICAgICAgICAgbWVudVBhcmVudEdyb3VwOiBhY3Rpb24ucGF5bG9hZC5wYXJlbnRHcm91cElkLFxuICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgbmV3IENvbmZpZ3VyYXRvckFjdGlvbnMuUmVhZENvbmZpZ3VyYXRpb25TdWNjZXNzKFxuICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb25cbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgbmV3IENvbmZpZ3VyYXRvckFjdGlvbnMuVXBkYXRlUHJpY2VTdW1tYXJ5KHtcbiAgICAgICAgICAgICAgICAgICAgICAuLi5jb25maWd1cmF0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgIGludGVyYWN0aW9uU3RhdGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRHcm91cDogYWN0aW9uLnBheWxvYWQuZ3JvdXBJZCxcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgY2F0Y2hFcnJvcigoZXJyb3IpID0+IFtcbiAgICAgICAgICAgICAgICAgIG5ldyBDb25maWd1cmF0b3JBY3Rpb25zLlJlYWRDb25maWd1cmF0aW9uRmFpbCh7XG4gICAgICAgICAgICAgICAgICAgIG93bmVyS2V5OiBhY3Rpb24ucGF5bG9hZC5jb25maWd1cmF0aW9uLm93bmVyLmtleSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IG5vcm1hbGl6ZUh0dHBFcnJvcihlcnJvciwgdGhpcy5sb2dnZXIpLFxuICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgXSlcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgfSlcbiAgICApXG4gICk7XG5cbiAgcmVtb3ZlUHJvZHVjdEJvdW5kQ29uZmlndXJhdGlvbnMkOiBPYnNlcnZhYmxlPENvbmZpZ3VyYXRvckFjdGlvbnMuUmVtb3ZlQ29uZmlndXJhdGlvbj4gPVxuICAgIGNyZWF0ZUVmZmVjdCgoKSA9PlxuICAgICAgdGhpcy5hY3Rpb25zJC5waXBlKFxuICAgICAgICBvZlR5cGUoQ29uZmlndXJhdG9yQWN0aW9ucy5SRU1PVkVfUFJPRFVDVF9CT1VORF9DT05GSUdVUkFUSU9OUyksXG4gICAgICAgIHN3aXRjaE1hcCgoKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmUucGlwZShcbiAgICAgICAgICAgIHNlbGVjdChDb25maWd1cmF0b3JTZWxlY3RvcnMuZ2V0Q29uZmlndXJhdGlvbnNTdGF0ZSksXG4gICAgICAgICAgICB0YWtlKDEpLFxuICAgICAgICAgICAgbWFwKChjb25maWd1cmF0b3JTdGF0ZSkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBlbnRpdGllcyA9IGNvbmZpZ3VyYXRvclN0YXRlLmNvbmZpZ3VyYXRpb25zLmVudGl0aWVzO1xuXG4gICAgICAgICAgICAgIGNvbnN0IG93bmVyS2V5c1RvUmVtb3ZlOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICAgICAgICBmb3IgKGNvbnN0IG93bmVyS2V5IGluIGVudGl0aWVzKSB7XG4gICAgICAgICAgICAgICAgaWYgKG93bmVyS2V5LmluY2x1ZGVzKENvbW1vbkNvbmZpZ3VyYXRvci5Pd25lclR5cGUuUFJPRFVDVCkpIHtcbiAgICAgICAgICAgICAgICAgIG93bmVyS2V5c1RvUmVtb3ZlLnB1c2gob3duZXJLZXkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHJldHVybiBuZXcgQ29uZmlndXJhdG9yQWN0aW9ucy5SZW1vdmVDb25maWd1cmF0aW9uKHtcbiAgICAgICAgICAgICAgICBvd25lcktleTogb3duZXJLZXlzVG9SZW1vdmUsXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICApO1xuICAgICAgICB9KVxuICAgICAgKVxuICAgICk7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJvdGVjdGVkIGFjdGlvbnMkOiBBY3Rpb25zLFxuICAgIHByb3RlY3RlZCBjb25maWd1cmF0b3JDb21tb25zQ29ubmVjdG9yOiBSdWxlYmFzZWRDb25maWd1cmF0b3JDb25uZWN0b3IsXG4gICAgcHJvdGVjdGVkIGNvbW1vbkNvbmZpZ1V0aWxzU2VydmljZTogQ29tbW9uQ29uZmlndXJhdG9yVXRpbHNTZXJ2aWNlLFxuICAgIHByb3RlY3RlZCBjb25maWd1cmF0b3JHcm91cFV0aWxzU2VydmljZTogQ29uZmlndXJhdG9yVXRpbHNTZXJ2aWNlLFxuICAgIHByb3RlY3RlZCBjb25maWd1cmF0b3JHcm91cFN0YXR1c1NlcnZpY2U6IENvbmZpZ3VyYXRvckdyb3VwU3RhdHVzU2VydmljZSxcbiAgICBwcm90ZWN0ZWQgc3RvcmU6IFN0b3JlPFN0YXRlV2l0aENvbmZpZ3VyYXRvcj4sXG4gICAgcHJvdGVjdGVkIGNvbmZpZ3VyYXRvckJhc2ljRWZmZWN0U2VydmljZTogQ29uZmlndXJhdG9yQmFzaWNFZmZlY3RTZXJ2aWNlXG4gICkge31cbn1cbiJdfQ==