/*
 * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>
 *
 * SPDX-License-Identifier: Apache-2.0
 */
import { ChangeDetectionStrategy, Component, EventEmitter, Input, Output, } from '@angular/core';
import { ConfiguratorProductScope } from '@spartacus/product-configurator/common';
import { ICON_TYPE, } from '@spartacus/storefront';
import { BehaviorSubject, combineLatest } from 'rxjs';
import { map, take, tap } from 'rxjs/operators';
import { Configurator } from '../../../core/model/configurator.model';
import { ConfiguratorAttributeBaseComponent } from '../types/base/configurator-attribute-base.component';
import * as i0 from "@angular/core";
import * as i1 from "@spartacus/core";
import * as i2 from "@spartacus/storefront";
import * as i3 from "@angular/common";
import * as i4 from "../../show-more/configurator-show-more.component";
import * as i5 from "../quantity/configurator-attribute-quantity.component";
import * as i6 from "../../price/configurator-price.component";
export class ConfiguratorAttributeProductCardComponent extends ConfiguratorAttributeBaseComponent {
    constructor(productService, keyBoardFocus, translation) {
        super();
        this.productService = productService;
        this.keyBoardFocus = keyBoardFocus;
        this.translation = translation;
        this.loading$ = new BehaviorSubject(true);
        this.showDeselectionNotPossible = false;
        this.handleDeselect = new EventEmitter();
        this.handleQuantity = new EventEmitter();
        this.handleSelect = new EventEmitter();
        this.iconType = ICON_TYPE;
    }
    ngOnInit() {
        this.loading$.next(true);
        const productSystemId = this.productCardOptions.productBoundValue.productSystemId;
        this.product$ = this.productService
            .get(productSystemId ? productSystemId : '', ConfiguratorProductScope.CONFIGURATOR_PRODUCT_CARD)
            .pipe(map((respProduct) => {
            return respProduct
                ? respProduct
                : this.transformToProductType(this.productCardOptions.productBoundValue);
        }), tap(() => this.loading$.next(false)));
    }
    get showQuantity() {
        return ((this.productCardOptions.withQuantity &&
            this.productCardOptions.productBoundValue.selected &&
            this.productCardOptions.multiSelect) ??
            false);
    }
    //TODO(CXSPA-3392) for next major: turn ConfiguratorAttributeProductCardComponentOptions#attributeName
    //into a required field and get rid of this method, use this.productCardOptions.attributeName instead
    get attributeName() {
        const attributeName = this.productCardOptions.attributeName;
        return attributeName
            ? attributeName
            : this.productCardOptions.attributeId.toString();
    }
    get focusConfig() {
        const focusConfig = {
            key: this.createFocusId(this.productCardOptions.attributeId.toString(), this.productCardOptions.productBoundValue.valueCode),
        };
        return focusConfig;
    }
    onHandleSelect() {
        this.loading$.next(true);
        if (this.productCardOptions.hideRemoveButton &&
            this.productCardOptions.fallbackFocusId) {
            this.keyBoardFocus.set(this.productCardOptions.fallbackFocusId);
        }
        this.handleSelect.emit(this.productCardOptions.productBoundValue.valueCode);
    }
    onHandleDeselect() {
        {
            if (this.productCardOptions.productBoundValue.selected &&
                this.productCardOptions.hideRemoveButton) {
                this.showDeselectionNotPossibleMessage();
                return;
            }
            this.loading$.next(true);
            this.handleDeselect.emit(this.productCardOptions.productBoundValue.valueCode);
        }
    }
    onChangeQuantity(eventObject) {
        if (!eventObject) {
            this.onHandleDeselect();
        }
        else {
            this.onHandleQuantity(eventObject);
        }
    }
    /**
     * Verifies whether the product card refers to a selected value
     * @return {boolean} - Selected?
     */
    isProductCardSelected() {
        const isProductCardSelected = this.productCardOptions.productBoundValue &&
            this.productCardOptions.productBoundValue.selected &&
            !this.productCardOptions.singleDropdown;
        return isProductCardSelected ?? false;
    }
    /**
     * Checks if price needs to be displayed. This is the
     * case if either value price, quantity or value price total
     * are present
     * @return {boolean} - Price display?
     */
    hasPriceDisplay() {
        const productPrice = this.productCardOptions.productBoundValue.valuePrice ||
            this.productCardOptions.productBoundValue.quantity ||
            this.productCardOptions.productBoundValue.valuePriceTotal;
        return productPrice ? true : false;
    }
    /**
     * Extract corresponding price formula parameters
     *
     *  @return {ConfiguratorPriceComponentOptions} - New price formula
     */
    extractPriceFormulaParameters() {
        if (!this.productCardOptions.multiSelect) {
            return {
                price: this.productCardOptions.productBoundValue.valuePrice,
                isLightedUp: this.productCardOptions.productBoundValue.selected,
            };
        }
        return {
            quantity: this.productCardOptions.productBoundValue.quantity,
            price: this.productCardOptions.productBoundValue.valuePrice,
            priceTotal: this.productCardOptions.productBoundValue.valuePriceTotal,
            isLightedUp: this.productCardOptions.productBoundValue.selected,
        };
    }
    /**
     *  Extract corresponding quantity parameters
     *
     * @return {ConfiguratorAttributeQuantityComponentOptions} - New quantity options
     */
    extractQuantityParameters() {
        const quantityFromOptions = this.productCardOptions.productBoundValue.quantity;
        const mergedLoading = this.productCardOptions.loading$
            ? combineLatest([this.loading$, this.productCardOptions.loading$]).pipe(map((values) => {
                return values[0] || values[1];
            }))
            : this.loading$;
        return {
            allowZero: !this.productCardOptions.hideRemoveButton,
            initialQuantity: quantityFromOptions ? quantityFromOptions : 0,
            disableQuantityActions$: mergedLoading,
        };
    }
    /**
     * Verifies whether the value code is defined.
     *
     * @param {string} valueCode - Value code
     * @return {boolean} - 'true' if the value code is defined, otherwise 'false'
     */
    isValueCodeDefined(valueCode) {
        return valueCode && valueCode !== Configurator.RetractValueCode
            ? true
            : false;
    }
    transformToProductType(value) {
        return {
            code: value?.productSystemId,
            description: value?.description,
            images: {},
            name: value?.valueDisplay,
        };
    }
    onHandleQuantity(quantity) {
        this.loading$.next(true);
        this.handleQuantity.emit({
            quantity,
            valueCode: this.productCardOptions.productBoundValue.valueCode,
        });
    }
    showDeselectionNotPossibleMessage() {
        this.showDeselectionNotPossible = true;
    }
    getAriaLabelSingleUnselected(product) {
        let translatedText = '';
        const index = this.productCardOptions.itemIndex + 1;
        if (this.isValueCodeDefined(this.productCardOptions?.productBoundValue?.valueCode)) {
            if (this.hasPriceDisplay() &&
                this.productCardOptions.productBoundValue.valuePrice?.value !== 0) {
                this.translation
                    .translate('configurator.a11y.itemOfAttributeUnselectedWithPrice', {
                    item: product.code,
                    attribute: this.productCardOptions?.attributeLabel,
                    itemIndex: index,
                    itemCount: this.productCardOptions.itemCount,
                    price: this.productCardOptions.productBoundValue.valuePriceTotal
                        ?.formattedValue,
                })
                    .pipe(take(1))
                    .subscribe((text) => (translatedText = text));
            }
            else {
                this.translation
                    .translate('configurator.a11y.itemOfAttributeUnselected', {
                    item: product.code,
                    attribute: this.productCardOptions?.attributeLabel,
                    itemIndex: index,
                    itemCount: this.productCardOptions.itemCount,
                })
                    .pipe(take(1))
                    .subscribe((text) => (translatedText = text));
            }
        }
        else {
            this.translation
                .translate('configurator.a11y.selectNoItemOfAttribute', {
                attribute: this.productCardOptions?.attributeLabel,
                itemIndex: index,
                itemCount: this.productCardOptions.itemCount,
            })
                .pipe(take(1))
                .subscribe((text) => (translatedText = text));
        }
        return translatedText;
    }
    getAriaLabelSingleSelected(product) {
        let translatedText = '';
        const index = this.productCardOptions.itemIndex + 1;
        if (this.hasPriceDisplay() &&
            this.productCardOptions.productBoundValue.valuePrice?.value !== 0) {
            this.translation
                .translate('configurator.a11y.itemOfAttributeSelectedPressToUnselectWithPrice', {
                item: product.code,
                attribute: this.productCardOptions?.attributeLabel,
                itemIndex: index,
                itemCount: this.productCardOptions.itemCount,
                price: this.productCardOptions.productBoundValue.valuePriceTotal
                    ?.formattedValue,
            })
                .pipe(take(1))
                .subscribe((text) => (translatedText = text));
        }
        else {
            this.translation
                .translate('configurator.a11y.itemOfAttributeSelectedPressToUnselect', {
                item: product.code,
                attribute: this.productCardOptions?.attributeLabel,
                itemIndex: index,
                itemCount: this.productCardOptions.itemCount,
            })
                .pipe(take(1))
                .subscribe((text) => (translatedText = text));
        }
        return translatedText;
    }
    getAriaLabelSingleSelectedNoButton(product) {
        let translatedText = '';
        const index = this.productCardOptions.itemIndex + 1;
        if (this.hasPriceDisplay() &&
            this.productCardOptions.productBoundValue.valuePrice?.value !== 0) {
            this.translation
                .translate('configurator.a11y.itemOfAttributeSelectedWithPrice', {
                item: product.code,
                attribute: this.productCardOptions?.attributeLabel,
                itemIndex: index,
                itemCount: this.productCardOptions.itemCount,
                price: this.productCardOptions.productBoundValue.valuePriceTotal
                    ?.formattedValue,
            })
                .pipe(take(1))
                .subscribe((text) => (translatedText = text));
        }
        else {
            this.translation
                .translate('configurator.a11y.itemOfAttributeSelected', {
                item: product.code,
                attribute: this.productCardOptions?.attributeLabel,
                itemIndex: index,
                itemCount: this.productCardOptions.itemCount,
            })
                .pipe(take(1))
                .subscribe((text) => (translatedText = text));
        }
        return translatedText;
    }
    getAriaLabelMultiSelected(product) {
        let translatedText = '';
        const index = this.productCardOptions.itemIndex + 1;
        if (this.hasPriceDisplay() &&
            this.productCardOptions.productBoundValue.valuePrice?.value !== 0) {
            this.translation
                .translate('configurator.a11y.itemOfAttributeSelectedPressToUnselectWithPrice', {
                item: product.code,
                attribute: this.productCardOptions?.attributeLabel,
                itemIndex: index,
                itemCount: this.productCardOptions.itemCount,
                price: this.productCardOptions.productBoundValue.valuePriceTotal
                    ?.formattedValue,
            })
                .pipe(take(1))
                .subscribe((text) => (translatedText = text));
        }
        else {
            this.translation
                .translate('configurator.a11y.itemOfAttributeSelectedPressToUnselect', {
                item: product.code,
                attribute: this.productCardOptions?.attributeLabel,
                itemIndex: index,
                itemCount: this.productCardOptions.itemCount,
            })
                .pipe(take(1))
                .subscribe((text) => (translatedText = text));
        }
        return translatedText;
    }
    getAriaLabelMultiUnselected(product) {
        let translatedText = '';
        const index = this.productCardOptions.itemIndex + 1;
        if (this.hasPriceDisplay() &&
            this.productCardOptions.productBoundValue.valuePrice?.value !== 0) {
            this.translation
                .translate('configurator.a11y.itemOfAttributeUnselectedWithPrice', {
                item: product.code,
                attribute: this.productCardOptions?.attributeLabel,
                itemIndex: index,
                itemCount: this.productCardOptions.itemCount,
                price: this.productCardOptions.productBoundValue.valuePriceTotal
                    ?.formattedValue,
            })
                .pipe(take(1))
                .subscribe((text) => (translatedText = text));
        }
        else {
            this.translation
                .translate('configurator.a11y.itemOfAttributeUnselected', {
                item: product.code,
                attribute: this.productCardOptions?.attributeLabel,
                itemIndex: index,
                itemCount: this.productCardOptions.itemCount,
            })
                .pipe(take(1))
                .subscribe((text) => (translatedText = text));
        }
        return translatedText;
    }
}
ConfiguratorAttributeProductCardComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: ConfiguratorAttributeProductCardComponent, deps: [{ token: i1.ProductService }, { token: i2.KeyboardFocusService }, { token: i1.TranslationService }], target: i0.ɵɵFactoryTarget.Component });
ConfiguratorAttributeProductCardComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.9", type: ConfiguratorAttributeProductCardComponent, selector: "cx-configurator-attribute-product-card", inputs: { productCardOptions: "productCardOptions" }, outputs: { handleDeselect: "handleDeselect", handleQuantity: "handleQuantity", handleSelect: "handleSelect" }, usesInheritance: true, ngImport: i0, template: "<ng-container *ngIf=\"product$ | async as product\">\n  <div\n    class=\"cx-product-card\"\n    [ngClass]=\"{\n      'cx-product-card-selected': isProductCardSelected()\n    }\"\n    [attr.aria-label]=\"\n      'configurator.a11y.itemOfAttribute'\n        | cxTranslate\n          : {\n              attribute: productCardOptions.attributeLabel\n            }\n    \"\n  >\n    <div class=\"cx-product-card-rows\">\n      <div class=\"cx-product-card-imgs\">\n        <cx-media\n          [container]=\"product.images?.PRIMARY\"\n          format=\"product\"\n          aria-hidden=\"true\"\n        ></cx-media>\n      </div>\n\n      <div class=\"cx-product-card-info\">\n        <div class=\"cx-product-card-name\">\n          <p>\n            {{ product.name }}\n          </p>\n        </div>\n        <div class=\"cx-product-card-code\" *ngIf=\"product.code\">\n          {{ 'configurator.attribute.id' | cxTranslate }}:\n          {{ product.code }}\n        </div>\n        <cx-configurator-show-more\n          *ngIf=\"product.description && product.code\"\n          [text]=\"product.description\"\n          [textSize]=\"45\"\n          [productName]=\"product.code\"\n        ></cx-configurator-show-more>\n      </div>\n    </div>\n\n    <div\n      class=\"cx-product-card-rows column\"\n      *ngIf=\"!productCardOptions.singleDropdown || hasPriceDisplay()\"\n    >\n      <div class=\"cx-product-card-quantity-price\">\n        <div class=\"cx-product-card-quantity\">\n          <cx-configurator-attribute-quantity\n            *ngIf=\"showQuantity\"\n            (changeQuantity)=\"onChangeQuantity($event)\"\n            [quantityOptions]=\"extractQuantityParameters()\"\n          ></cx-configurator-attribute-quantity>\n        </div>\n        <div class=\"cx-product-card-price\">\n          <cx-configurator-price\n            [formula]=\"extractPriceFormulaParameters()\"\n          ></cx-configurator-price>\n        </div>\n      </div>\n      <div class=\"cx-product-card-action\">\n        <div\n          class=\"cx-product-card-action-btn\"\n          *ngIf=\"!productCardOptions?.singleDropdown\"\n        >\n          <ng-container *ngIf=\"productCardOptions?.multiSelect; else single\">\n            <button\n              *ngIf=\"\n                productCardOptions?.productBoundValue?.selected;\n                else select\n              \"\n              class=\"btn btn-secondary\"\n              (click)=\"onHandleDeselect()\"\n              [cxFocus]=\"focusConfig\"\n              [attr.aria-label]=\"getAriaLabelMultiSelected(product)\"\n              [attr.aria-describedby]=\"\n                createAttributeUiKey('label', attributeName)\n              \"\n            >\n              {{ 'configurator.button.remove' | cxTranslate }}\n            </button>\n\n            <ng-template #select>\n              <button\n                class=\"btn btn-primary\"\n                (click)=\"onHandleSelect()\"\n                [disabled]=\"\n                  productCardOptions.disableAllButtons || (loading$ | async)\n                \"\n                [cxFocus]=\"focusConfig\"\n                [attr.aria-label]=\"getAriaLabelMultiUnselected(product)\"\n                [attr.aria-describedby]=\"\n                  createAttributeUiKey('label', attributeName)\n                \"\n              >\n                {{ 'configurator.button.add' | cxTranslate }}\n              </button>\n            </ng-template>\n          </ng-container>\n\n          <ng-template #single>\n            <button\n              class=\"btn btn-primary\"\n              (click)=\"onHandleSelect()\"\n              [disabled]=\"\n                productCardOptions.disableAllButtons || (loading$ | async)\n              \"\n              *ngIf=\"\n                !productCardOptions?.productBoundValue?.selected;\n                else deselect\n              \"\n              [cxFocus]=\"focusConfig\"\n              [attr.aria-label]=\"getAriaLabelSingleUnselected(product)\"\n              [attr.aria-describedby]=\"\n                createAttributeUiKey('label', attributeName)\n              \"\n            >\n              {{ 'configurator.button.select' | cxTranslate }}\n            </button>\n            <ng-template #deselect>\n              <ng-container\n                *ngIf=\"\n                  isValueCodeDefined(\n                    productCardOptions?.productBoundValue?.valueCode\n                  )\n                \"\n              >\n                <button\n                  *ngIf=\"!productCardOptions?.hideRemoveButton\"\n                  class=\"btn btn-secondary\"\n                  (click)=\"onHandleDeselect()\"\n                  [disabled]=\"\n                    productCardOptions.hideRemoveButton || (loading$ | async)\n                  \"\n                  [cxFocus]=\"focusConfig\"\n                  [attr.aria-label]=\"getAriaLabelSingleSelected(product)\"\n                  [attr.aria-describedby]=\"\n                    createAttributeUiKey('label', attributeName)\n                  \"\n                >\n                  {{ 'configurator.button.deselect' | cxTranslate }}\n                </button>\n                <span\n                  *ngIf=\"productCardOptions?.hideRemoveButton\"\n                  class=\"cx-visually-hidden\"\n                  tabindex=\"0\"\n                >\n                  {{ getAriaLabelSingleSelectedNoButton(product) }}\n                </span>\n              </ng-container>\n            </ng-template>\n          </ng-template>\n        </div>\n      </div>\n    </div>\n    <ng-container *ngIf=\"showDeselectionNotPossible\">\n      <div\n        class=\"cx-product-card-rows deselection-error-message\"\n        aria-live=\"assertive\"\n        aria-atomic=\"true\"\n        role=\"alert\"\n        id=\"{{ createAttributeUiKey('attribute-msg', attributeName) }}\"\n      >\n        <cx-icon class=\"deselection-error-symbol\" type=\"ERROR\"></cx-icon>\n        {{ 'configurator.attribute.deselectionNotPossible' | cxTranslate }}\n      </div>\n    </ng-container>\n  </div>\n</ng-container>\n", dependencies: [{ kind: "directive", type: i3.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i3.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "component", type: i4.ConfiguratorShowMoreComponent, selector: "cx-configurator-show-more", inputs: ["text", "textSize", "productName"] }, { kind: "component", type: i5.ConfiguratorAttributeQuantityComponent, selector: "cx-configurator-attribute-quantity", inputs: ["quantityOptions"], outputs: ["changeQuantity"] }, { kind: "component", type: i2.MediaComponent, selector: "cx-media", inputs: ["container", "format", "alt", "role", "loading"], outputs: ["loaded"] }, { kind: "component", type: i6.ConfiguratorPriceComponent, selector: "cx-configurator-price", inputs: ["formula"] }, { kind: "directive", type: i2.FocusDirective, selector: "[cxFocus]", inputs: ["cxFocus"] }, { kind: "component", type: i2.IconComponent, selector: "cx-icon,[cxIcon]", inputs: ["cxIcon", "type"] }, { kind: "pipe", type: i3.AsyncPipe, name: "async" }, { kind: "pipe", type: i1.TranslatePipe, name: "cxTranslate" }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: ConfiguratorAttributeProductCardComponent, decorators: [{
            type: Component,
            args: [{ selector: 'cx-configurator-attribute-product-card', changeDetection: ChangeDetectionStrategy.OnPush, template: "<ng-container *ngIf=\"product$ | async as product\">\n  <div\n    class=\"cx-product-card\"\n    [ngClass]=\"{\n      'cx-product-card-selected': isProductCardSelected()\n    }\"\n    [attr.aria-label]=\"\n      'configurator.a11y.itemOfAttribute'\n        | cxTranslate\n          : {\n              attribute: productCardOptions.attributeLabel\n            }\n    \"\n  >\n    <div class=\"cx-product-card-rows\">\n      <div class=\"cx-product-card-imgs\">\n        <cx-media\n          [container]=\"product.images?.PRIMARY\"\n          format=\"product\"\n          aria-hidden=\"true\"\n        ></cx-media>\n      </div>\n\n      <div class=\"cx-product-card-info\">\n        <div class=\"cx-product-card-name\">\n          <p>\n            {{ product.name }}\n          </p>\n        </div>\n        <div class=\"cx-product-card-code\" *ngIf=\"product.code\">\n          {{ 'configurator.attribute.id' | cxTranslate }}:\n          {{ product.code }}\n        </div>\n        <cx-configurator-show-more\n          *ngIf=\"product.description && product.code\"\n          [text]=\"product.description\"\n          [textSize]=\"45\"\n          [productName]=\"product.code\"\n        ></cx-configurator-show-more>\n      </div>\n    </div>\n\n    <div\n      class=\"cx-product-card-rows column\"\n      *ngIf=\"!productCardOptions.singleDropdown || hasPriceDisplay()\"\n    >\n      <div class=\"cx-product-card-quantity-price\">\n        <div class=\"cx-product-card-quantity\">\n          <cx-configurator-attribute-quantity\n            *ngIf=\"showQuantity\"\n            (changeQuantity)=\"onChangeQuantity($event)\"\n            [quantityOptions]=\"extractQuantityParameters()\"\n          ></cx-configurator-attribute-quantity>\n        </div>\n        <div class=\"cx-product-card-price\">\n          <cx-configurator-price\n            [formula]=\"extractPriceFormulaParameters()\"\n          ></cx-configurator-price>\n        </div>\n      </div>\n      <div class=\"cx-product-card-action\">\n        <div\n          class=\"cx-product-card-action-btn\"\n          *ngIf=\"!productCardOptions?.singleDropdown\"\n        >\n          <ng-container *ngIf=\"productCardOptions?.multiSelect; else single\">\n            <button\n              *ngIf=\"\n                productCardOptions?.productBoundValue?.selected;\n                else select\n              \"\n              class=\"btn btn-secondary\"\n              (click)=\"onHandleDeselect()\"\n              [cxFocus]=\"focusConfig\"\n              [attr.aria-label]=\"getAriaLabelMultiSelected(product)\"\n              [attr.aria-describedby]=\"\n                createAttributeUiKey('label', attributeName)\n              \"\n            >\n              {{ 'configurator.button.remove' | cxTranslate }}\n            </button>\n\n            <ng-template #select>\n              <button\n                class=\"btn btn-primary\"\n                (click)=\"onHandleSelect()\"\n                [disabled]=\"\n                  productCardOptions.disableAllButtons || (loading$ | async)\n                \"\n                [cxFocus]=\"focusConfig\"\n                [attr.aria-label]=\"getAriaLabelMultiUnselected(product)\"\n                [attr.aria-describedby]=\"\n                  createAttributeUiKey('label', attributeName)\n                \"\n              >\n                {{ 'configurator.button.add' | cxTranslate }}\n              </button>\n            </ng-template>\n          </ng-container>\n\n          <ng-template #single>\n            <button\n              class=\"btn btn-primary\"\n              (click)=\"onHandleSelect()\"\n              [disabled]=\"\n                productCardOptions.disableAllButtons || (loading$ | async)\n              \"\n              *ngIf=\"\n                !productCardOptions?.productBoundValue?.selected;\n                else deselect\n              \"\n              [cxFocus]=\"focusConfig\"\n              [attr.aria-label]=\"getAriaLabelSingleUnselected(product)\"\n              [attr.aria-describedby]=\"\n                createAttributeUiKey('label', attributeName)\n              \"\n            >\n              {{ 'configurator.button.select' | cxTranslate }}\n            </button>\n            <ng-template #deselect>\n              <ng-container\n                *ngIf=\"\n                  isValueCodeDefined(\n                    productCardOptions?.productBoundValue?.valueCode\n                  )\n                \"\n              >\n                <button\n                  *ngIf=\"!productCardOptions?.hideRemoveButton\"\n                  class=\"btn btn-secondary\"\n                  (click)=\"onHandleDeselect()\"\n                  [disabled]=\"\n                    productCardOptions.hideRemoveButton || (loading$ | async)\n                  \"\n                  [cxFocus]=\"focusConfig\"\n                  [attr.aria-label]=\"getAriaLabelSingleSelected(product)\"\n                  [attr.aria-describedby]=\"\n                    createAttributeUiKey('label', attributeName)\n                  \"\n                >\n                  {{ 'configurator.button.deselect' | cxTranslate }}\n                </button>\n                <span\n                  *ngIf=\"productCardOptions?.hideRemoveButton\"\n                  class=\"cx-visually-hidden\"\n                  tabindex=\"0\"\n                >\n                  {{ getAriaLabelSingleSelectedNoButton(product) }}\n                </span>\n              </ng-container>\n            </ng-template>\n          </ng-template>\n        </div>\n      </div>\n    </div>\n    <ng-container *ngIf=\"showDeselectionNotPossible\">\n      <div\n        class=\"cx-product-card-rows deselection-error-message\"\n        aria-live=\"assertive\"\n        aria-atomic=\"true\"\n        role=\"alert\"\n        id=\"{{ createAttributeUiKey('attribute-msg', attributeName) }}\"\n      >\n        <cx-icon class=\"deselection-error-symbol\" type=\"ERROR\"></cx-icon>\n        {{ 'configurator.attribute.deselectionNotPossible' | cxTranslate }}\n      </div>\n    </ng-container>\n  </div>\n</ng-container>\n" }]
        }], ctorParameters: function () { return [{ type: i1.ProductService }, { type: i2.KeyboardFocusService }, { type: i1.TranslationService }]; }, propDecorators: { productCardOptions: [{
                type: Input
            }], handleDeselect: [{
                type: Output
            }], handleQuantity: [{
                type: Output
            }], handleSelect: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZmlndXJhdG9yLWF0dHJpYnV0ZS1wcm9kdWN0LWNhcmQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vZmVhdHVyZS1saWJzL3Byb2R1Y3QtY29uZmlndXJhdG9yL3J1bGViYXNlZC9jb21wb25lbnRzL2F0dHJpYnV0ZS9wcm9kdWN0LWNhcmQvY29uZmlndXJhdG9yLWF0dHJpYnV0ZS1wcm9kdWN0LWNhcmQuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vZmVhdHVyZS1saWJzL3Byb2R1Y3QtY29uZmlndXJhdG9yL3J1bGViYXNlZC9jb21wb25lbnRzL2F0dHJpYnV0ZS9wcm9kdWN0LWNhcmQvY29uZmlndXJhdG9yLWF0dHJpYnV0ZS1wcm9kdWN0LWNhcmQuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7R0FJRztBQUVILE9BQU8sRUFDTCx1QkFBdUIsRUFDdkIsU0FBUyxFQUNULFlBQVksRUFDWixLQUFLLEVBRUwsTUFBTSxHQUNQLE1BQU0sZUFBZSxDQUFDO0FBRXZCLE9BQU8sRUFBRSx3QkFBd0IsRUFBRSxNQUFNLHdDQUF3QyxDQUFDO0FBQ2xGLE9BQU8sRUFFTCxTQUFTLEdBRVYsTUFBTSx1QkFBdUIsQ0FBQztBQUMvQixPQUFPLEVBQUUsZUFBZSxFQUFFLGFBQWEsRUFBYyxNQUFNLE1BQU0sQ0FBQztBQUNsRSxPQUFPLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUNoRCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sd0NBQXdDLENBQUM7QUFJdEUsT0FBTyxFQUFFLGtDQUFrQyxFQUFFLE1BQU0scURBQXFELENBQUM7Ozs7Ozs7O0FBK0J6RyxNQUFNLE9BQU8seUNBQ1gsU0FBUSxrQ0FBa0M7SUFjMUMsWUFDWSxjQUE4QixFQUM5QixhQUFtQyxFQUNuQyxXQUErQjtRQUV6QyxL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LENBQUMsaUJBQWlCLENBQUMsZUFBZTtvQkFDdkQsRUFBRSxjQUFjO2FBQ3JCLENBQUM7aUJBQ0QsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztpQkFDYixTQUFTLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUM7U0FDakQ7YUFBTTtZQUNMLElBQUksQ0FBQyxXQUFXO2lCQUNiLFNBQVMsQ0FBQyw2Q0FBNkMsRUFBRTtnQkFDeEQsSUFBSSxFQUFFLE9BQU8sQ0FBQyxJQUFJO2dCQUNsQixTQUFTLEVBQUUsSUFBSSxDQUFDLGtCQUFrQixFQUFFLGNBQWM7Z0JBQ2xELFNBQVMsRUFBRSxLQUFLO2dCQUNoQixTQUFTLEVBQUUsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFNBQVM7YUFDN0MsQ0FBQztpQkFDRCxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO2lCQUNiLFNBQVMsQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQztTQUNqRDtRQUVELE9BQU8sY0FBYyxDQUFDO0lBQ3hCLENBQUM7O3NJQXBaVSx5Q0FBeUM7MEhBQXpDLHlDQUF5QywwUUMxRHRELDgrTEF5S0E7MkZEL0dhLHlDQUF5QztrQkFMckQsU0FBUzsrQkFDRSx3Q0FBd0MsbUJBRWpDLHVCQUF1QixDQUFDLE1BQU07eUtBVy9DLGtCQUFrQjtzQkFEakIsS0FBSztnQkFHSSxjQUFjO3NCQUF2QixNQUFNO2dCQUNHLGNBQWM7c0JBQXZCLE1BQU07Z0JBQ0csWUFBWTtzQkFBckIsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBTUERYLUZpbGVDb3B5cmlnaHRUZXh0OiAyMDIzIFNBUCBTcGFydGFjdXMgdGVhbSA8c3BhcnRhY3VzLXRlYW1Ac2FwLmNvbT5cbiAqXG4gKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogQXBhY2hlLTIuMFxuICovXG5cbmltcG9ydCB7XG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICBDb21wb25lbnQsXG4gIEV2ZW50RW1pdHRlcixcbiAgSW5wdXQsXG4gIE9uSW5pdCxcbiAgT3V0cHV0LFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFByb2R1Y3QsIFByb2R1Y3RTZXJ2aWNlLCBUcmFuc2xhdGlvblNlcnZpY2UgfSBmcm9tICdAc3BhcnRhY3VzL2NvcmUnO1xuaW1wb3J0IHsgQ29uZmlndXJhdG9yUHJvZHVjdFNjb3BlIH0gZnJvbSAnQHNwYXJ0YWN1cy9wcm9kdWN0LWNvbmZpZ3VyYXRvci9jb21tb24nO1xuaW1wb3J0IHtcbiAgRm9jdXNDb25maWcsXG4gIElDT05fVFlQRSxcbiAgS2V5Ym9hcmRGb2N1c1NlcnZpY2UsXG59IGZyb20gJ0BzcGFydGFjdXMvc3RvcmVmcm9udCc7XG5pbXBvcnQgeyBCZWhhdmlvclN1YmplY3QsIGNvbWJpbmVMYXRlc3QsIE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IG1hcCwgdGFrZSwgdGFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgQ29uZmlndXJhdG9yIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9tb2RlbC9jb25maWd1cmF0b3IubW9kZWwnO1xuaW1wb3J0IHsgUXVhbnRpdHlVcGRhdGVFdmVudCB9IGZyb20gJy4uLy4uL2Zvcm0vY29uZmlndXJhdG9yLWZvcm0uZXZlbnQnO1xuaW1wb3J0IHsgQ29uZmlndXJhdG9yUHJpY2VDb21wb25lbnRPcHRpb25zIH0gZnJvbSAnLi4vLi4vcHJpY2UvY29uZmlndXJhdG9yLXByaWNlLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBDb25maWd1cmF0b3JBdHRyaWJ1dGVRdWFudGl0eUNvbXBvbmVudE9wdGlvbnMgfSBmcm9tICcuLi9xdWFudGl0eS9jb25maWd1cmF0b3ItYXR0cmlidXRlLXF1YW50aXR5LmNvbXBvbmVudCc7XG5pbXBvcnQgeyBDb25maWd1cmF0b3JBdHRyaWJ1dGVCYXNlQ29tcG9uZW50IH0gZnJvbSAnLi4vdHlwZXMvYmFzZS9jb25maWd1cmF0b3ItYXR0cmlidXRlLWJhc2UuY29tcG9uZW50JztcblxuZXhwb3J0IGludGVyZmFjZSBDb25maWd1cmF0b3JBdHRyaWJ1dGVQcm9kdWN0Q2FyZENvbXBvbmVudE9wdGlvbnMge1xuICAvKiogSWYgc2V0IHRvIGB0cnVlYCwgYWxsIGFjdGlvbiBidXR0b25zIHdpbGwgYmUgZGlzYWJsZWQuICAqL1xuICBkaXNhYmxlQWxsQnV0dG9ucz86IGJvb2xlYW47XG4gIC8qKiBJZiBzZXQgdG8gYHRydWVgLCB0aGUgcmVtb3ZlL2Rlc2VsZWN0IGJ1dHRvbiB3b24ndCBiZSBhdmFpbGFibGUuIFVzZWZ1bCBmb3IgcmVxdWlyZWQgYXR0cmlidXRlcyxcbiAgICogIHdoZXJlIGEgZGVzZWxlY3QvcmVtb3ZlIG9mIGxhc3QgdmFsdWUgc2hhbGwgbm90IGJlIHBvc3NpYmxlLiAgKi9cbiAgaGlkZVJlbW92ZUJ1dHRvbj86IGJvb2xlYW47XG4gIGZhbGxiYWNrRm9jdXNJZD86IHN0cmluZztcbiAgbXVsdGlTZWxlY3Q/OiBib29sZWFuO1xuICBwcm9kdWN0Qm91bmRWYWx1ZTogQ29uZmlndXJhdG9yLlZhbHVlO1xuICBzaW5nbGVEcm9wZG93bj86IGJvb2xlYW47XG4gIHdpdGhRdWFudGl0eT86IGJvb2xlYW47XG4gIC8qKlxuICAgKiBVc2VkIHRvIGluZGljYXRlIGxvYWRpbmcgc3RhdGUsIGZvciBleGFtcGxlIGluIGNhc2UgYSByZXF1ZXN0IHRyaWdnZXJlZCBieSBwYXJlbnQgY29tcG9uZW50IHRvIENQUSBpcyBjdXJyZW50bHkgaW4gcHJvZ3Jlc3MuXG4gICAqIENvbXBvbmVudCB3aWxsIHJlYWN0IG9uIGl0IGFuZCBkaXNhYmxlIGFsbCBjb250cm9scyB0aGF0IGNvdWxkIGNhdXNlIGEgcmVxdWVzdC5cbiAgICogVGhpcyBwcmV2ZW50cyB0aGUgdXNlciBmcm9tIHRyaWdnZXJpbmcgY29uY3VycmVudCByZXF1ZXN0cyB3aXRoIHBvdGVudGlhbCBjb25mbGljdGluZyBjb250ZW50IHRoYXQgbWlnaHQgY2F1c2UgdW5leHBlY3RlZCBiZWhhdmlvdXIuXG4gICAqL1xuICBsb2FkaW5nJD86IE9ic2VydmFibGU8Ym9vbGVhbj47XG4gIGF0dHJpYnV0ZUlkOiBudW1iZXI7XG4gIGF0dHJpYnV0ZUxhYmVsPzogc3RyaW5nO1xuICBhdHRyaWJ1dGVOYW1lPzogc3RyaW5nO1xuICBpdGVtQ291bnQ6IG51bWJlcjtcbiAgaXRlbUluZGV4OiBudW1iZXI7XG59XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2N4LWNvbmZpZ3VyYXRvci1hdHRyaWJ1dGUtcHJvZHVjdC1jYXJkJyxcbiAgdGVtcGxhdGVVcmw6ICcuL2NvbmZpZ3VyYXRvci1hdHRyaWJ1dGUtcHJvZHVjdC1jYXJkLmNvbXBvbmVudC5odG1sJyxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG59KVxuZXhwb3J0IGNsYXNzIENvbmZpZ3VyYXRvckF0dHJpYnV0ZVByb2R1Y3RDYXJkQ29tcG9uZW50XG4gIGV4dGVuZHMgQ29uZmlndXJhdG9yQXR0cmlidXRlQmFzZUNvbXBvbmVudFxuICBpbXBsZW1lbnRzIE9uSW5pdFxue1xuICBwcm9kdWN0JDogT2JzZXJ2YWJsZTxQcm9kdWN0PjtcbiAgbG9hZGluZyQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PGJvb2xlYW4+KHRydWUpO1xuICBzaG93RGVzZWxlY3Rpb25Ob3RQb3NzaWJsZSA9IGZhbHNlO1xuXG4gIEBJbnB1dCgpXG4gIHByb2R1Y3RDYXJkT3B0aW9uczogQ29uZmlndXJhdG9yQXR0cmlidXRlUHJvZHVjdENhcmRDb21wb25lbnRPcHRpb25zO1xuXG4gIEBPdXRwdXQoKSBoYW5kbGVEZXNlbGVjdCA9IG5ldyBFdmVudEVtaXR0ZXI8c3RyaW5nPigpO1xuICBAT3V0cHV0KCkgaGFuZGxlUXVhbnRpdHkgPSBuZXcgRXZlbnRFbWl0dGVyPFF1YW50aXR5VXBkYXRlRXZlbnQ+KCk7XG4gIEBPdXRwdXQoKSBoYW5kbGVTZWxlY3QgPSBuZXcgRXZlbnRFbWl0dGVyPHN0cmluZz4oKTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcm90ZWN0ZWQgcHJvZHVjdFNlcnZpY2U6IFByb2R1Y3RTZXJ2aWNlLFxuICAgIHByb3RlY3RlZCBrZXlCb2FyZEZvY3VzOiBLZXlib2FyZEZvY3VzU2VydmljZSxcbiAgICBwcm90ZWN0ZWQgdHJhbnNsYXRpb246IFRyYW5zbGF0aW9uU2VydmljZVxuICApIHtcbiAgICBzdXBlcigpO1xuICB9XG4gIGljb25UeXBlID0gSUNPTl9UWVBFO1xuXG4gIG5nT25Jbml0KCkge1xuICAgIHRoaXMubG9hZGluZyQubmV4dCh0cnVlKTtcbiAgICBjb25zdCBwcm9kdWN0U3lzdGVtSWQgPVxuICAgICAgdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMucHJvZHVjdEJvdW5kVmFsdWUucHJvZHVjdFN5c3RlbUlkO1xuXG4gICAgdGhpcy5wcm9kdWN0JCA9IHRoaXMucHJvZHVjdFNlcnZpY2VcbiAgICAgIC5nZXQoXG4gICAgICAgIHByb2R1Y3RTeXN0ZW1JZCA/IHByb2R1Y3RTeXN0ZW1JZCA6ICcnLFxuICAgICAgICBDb25maWd1cmF0b3JQcm9kdWN0U2NvcGUuQ09ORklHVVJBVE9SX1BST0RVQ1RfQ0FSRFxuICAgICAgKVxuICAgICAgLnBpcGUoXG4gICAgICAgIG1hcCgocmVzcFByb2R1Y3QpID0+IHtcbiAgICAgICAgICByZXR1cm4gcmVzcFByb2R1Y3RcbiAgICAgICAgICAgID8gcmVzcFByb2R1Y3RcbiAgICAgICAgICAgIDogdGhpcy50cmFuc2Zvcm1Ub1Byb2R1Y3RUeXBlKFxuICAgICAgICAgICAgICAgIHRoaXMucHJvZHVjdENhcmRPcHRpb25zLnByb2R1Y3RCb3VuZFZhbHVlXG4gICAgICAgICAgICAgICk7XG4gICAgICAgIH0pLFxuICAgICAgICB0YXAoKCkgPT4gdGhpcy5sb2FkaW5nJC5uZXh0KGZhbHNlKSlcbiAgICAgICk7XG4gIH1cblxuICBnZXQgc2hvd1F1YW50aXR5KCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAoXG4gICAgICAodGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMud2l0aFF1YW50aXR5ICYmXG4gICAgICAgIHRoaXMucHJvZHVjdENhcmRPcHRpb25zLnByb2R1Y3RCb3VuZFZhbHVlLnNlbGVjdGVkICYmXG4gICAgICAgIHRoaXMucHJvZHVjdENhcmRPcHRpb25zLm11bHRpU2VsZWN0KSA/P1xuICAgICAgZmFsc2VcbiAgICApO1xuICB9XG4gIC8vVE9ETyhDWFNQQS0zMzkyKSBmb3IgbmV4dCBtYWpvcjogdHVybiBDb25maWd1cmF0b3JBdHRyaWJ1dGVQcm9kdWN0Q2FyZENvbXBvbmVudE9wdGlvbnMjYXR0cmlidXRlTmFtZVxuICAvL2ludG8gYSByZXF1aXJlZCBmaWVsZCBhbmQgZ2V0IHJpZCBvZiB0aGlzIG1ldGhvZCwgdXNlIHRoaXMucHJvZHVjdENhcmRPcHRpb25zLmF0dHJpYnV0ZU5hbWUgaW5zdGVhZFxuICBnZXQgYXR0cmlidXRlTmFtZSgpOiBzdHJpbmcge1xuICAgIGNvbnN0IGF0dHJpYnV0ZU5hbWUgPSB0aGlzLnByb2R1Y3RDYXJkT3B0aW9ucy5hdHRyaWJ1dGVOYW1lO1xuICAgIHJldHVybiBhdHRyaWJ1dGVOYW1lXG4gICAgICA/IGF0dHJpYnV0ZU5hbWVcbiAgICAgIDogdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMuYXR0cmlidXRlSWQudG9TdHJpbmcoKTtcbiAgfVxuXG4gIGdldCBmb2N1c0NvbmZpZygpOiBGb2N1c0NvbmZpZyB7XG4gICAgY29uc3QgZm9jdXNDb25maWcgPSB7XG4gICAgICBrZXk6IHRoaXMuY3JlYXRlRm9jdXNJZChcbiAgICAgICAgdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMuYXR0cmlidXRlSWQudG9TdHJpbmcoKSxcbiAgICAgICAgdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMucHJvZHVjdEJvdW5kVmFsdWUudmFsdWVDb2RlXG4gICAgICApLFxuICAgIH07XG4gICAgcmV0dXJuIGZvY3VzQ29uZmlnO1xuICB9XG5cbiAgb25IYW5kbGVTZWxlY3QoKTogdm9pZCB7XG4gICAgdGhpcy5sb2FkaW5nJC5uZXh0KHRydWUpO1xuICAgIGlmIChcbiAgICAgIHRoaXMucHJvZHVjdENhcmRPcHRpb25zLmhpZGVSZW1vdmVCdXR0b24gJiZcbiAgICAgIHRoaXMucHJvZHVjdENhcmRPcHRpb25zLmZhbGxiYWNrRm9jdXNJZFxuICAgICkge1xuICAgICAgdGhpcy5rZXlCb2FyZEZvY3VzLnNldCh0aGlzLnByb2R1Y3RDYXJkT3B0aW9ucy5mYWxsYmFja0ZvY3VzSWQpO1xuICAgIH1cbiAgICB0aGlzLmhhbmRsZVNlbGVjdC5lbWl0KHRoaXMucHJvZHVjdENhcmRPcHRpb25zLnByb2R1Y3RCb3VuZFZhbHVlLnZhbHVlQ29kZSk7XG4gIH1cblxuICBvbkhhbmRsZURlc2VsZWN0KCk6IHZvaWQge1xuICAgIHtcbiAgICAgIGlmIChcbiAgICAgICAgdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMucHJvZHVjdEJvdW5kVmFsdWUuc2VsZWN0ZWQgJiZcbiAgICAgICAgdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMuaGlkZVJlbW92ZUJ1dHRvblxuICAgICAgKSB7XG4gICAgICAgIHRoaXMuc2hvd0Rlc2VsZWN0aW9uTm90UG9zc2libGVNZXNzYWdlKCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMubG9hZGluZyQubmV4dCh0cnVlKTtcbiAgICAgIHRoaXMuaGFuZGxlRGVzZWxlY3QuZW1pdChcbiAgICAgICAgdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMucHJvZHVjdEJvdW5kVmFsdWUudmFsdWVDb2RlXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIG9uQ2hhbmdlUXVhbnRpdHkoZXZlbnRPYmplY3Q6IGFueSk6IHZvaWQge1xuICAgIGlmICghZXZlbnRPYmplY3QpIHtcbiAgICAgIHRoaXMub25IYW5kbGVEZXNlbGVjdCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm9uSGFuZGxlUXVhbnRpdHkoZXZlbnRPYmplY3QpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmllcyB3aGV0aGVyIHRoZSBwcm9kdWN0IGNhcmQgcmVmZXJzIHRvIGEgc2VsZWN0ZWQgdmFsdWVcbiAgICogQHJldHVybiB7Ym9vbGVhbn0gLSBTZWxlY3RlZD9cbiAgICovXG4gIGlzUHJvZHVjdENhcmRTZWxlY3RlZCgpOiBib29sZWFuIHtcbiAgICBjb25zdCBpc1Byb2R1Y3RDYXJkU2VsZWN0ZWQgPVxuICAgICAgdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMucHJvZHVjdEJvdW5kVmFsdWUgJiZcbiAgICAgIHRoaXMucHJvZHVjdENhcmRPcHRpb25zLnByb2R1Y3RCb3VuZFZhbHVlLnNlbGVjdGVkICYmXG4gICAgICAhdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMuc2luZ2xlRHJvcGRvd247XG5cbiAgICByZXR1cm4gaXNQcm9kdWN0Q2FyZFNlbGVjdGVkID8/IGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrcyBpZiBwcmljZSBuZWVkcyB0byBiZSBkaXNwbGF5ZWQuIFRoaXMgaXMgdGhlXG4gICAqIGNhc2UgaWYgZWl0aGVyIHZhbHVlIHByaWNlLCBxdWFudGl0eSBvciB2YWx1ZSBwcmljZSB0b3RhbFxuICAgKiBhcmUgcHJlc2VudFxuICAgKiBAcmV0dXJuIHtib29sZWFufSAtIFByaWNlIGRpc3BsYXk/XG4gICAqL1xuICBoYXNQcmljZURpc3BsYXkoKTogYm9vbGVhbiB7XG4gICAgY29uc3QgcHJvZHVjdFByaWNlID1cbiAgICAgIHRoaXMucHJvZHVjdENhcmRPcHRpb25zLnByb2R1Y3RCb3VuZFZhbHVlLnZhbHVlUHJpY2UgfHxcbiAgICAgIHRoaXMucHJvZHVjdENhcmRPcHRpb25zLnByb2R1Y3RCb3VuZFZhbHVlLnF1YW50aXR5IHx8XG4gICAgICB0aGlzLnByb2R1Y3RDYXJkT3B0aW9ucy5wcm9kdWN0Qm91bmRWYWx1ZS52YWx1ZVByaWNlVG90YWw7XG5cbiAgICByZXR1cm4gcHJvZHVjdFByaWNlID8gdHJ1ZSA6IGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIEV4dHJhY3QgY29ycmVzcG9uZGluZyBwcmljZSBmb3JtdWxhIHBhcmFtZXRlcnNcbiAgICpcbiAgICogIEByZXR1cm4ge0NvbmZpZ3VyYXRvclByaWNlQ29tcG9uZW50T3B0aW9uc30gLSBOZXcgcHJpY2UgZm9ybXVsYVxuICAgKi9cbiAgZXh0cmFjdFByaWNlRm9ybXVsYVBhcmFtZXRlcnMoKTogQ29uZmlndXJhdG9yUHJpY2VDb21wb25lbnRPcHRpb25zIHtcbiAgICBpZiAoIXRoaXMucHJvZHVjdENhcmRPcHRpb25zLm11bHRpU2VsZWN0KSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBwcmljZTogdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMucHJvZHVjdEJvdW5kVmFsdWUudmFsdWVQcmljZSxcbiAgICAgICAgaXNMaWdodGVkVXA6IHRoaXMucHJvZHVjdENhcmRPcHRpb25zLnByb2R1Y3RCb3VuZFZhbHVlLnNlbGVjdGVkLFxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIHF1YW50aXR5OiB0aGlzLnByb2R1Y3RDYXJkT3B0aW9ucy5wcm9kdWN0Qm91bmRWYWx1ZS5xdWFudGl0eSxcbiAgICAgIHByaWNlOiB0aGlzLnByb2R1Y3RDYXJkT3B0aW9ucy5wcm9kdWN0Qm91bmRWYWx1ZS52YWx1ZVByaWNlLFxuICAgICAgcHJpY2VUb3RhbDogdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMucHJvZHVjdEJvdW5kVmFsdWUudmFsdWVQcmljZVRvdGFsLFxuICAgICAgaXNMaWdodGVkVXA6IHRoaXMucHJvZHVjdENhcmRPcHRpb25zLnByb2R1Y3RCb3VuZFZhbHVlLnNlbGVjdGVkLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogIEV4dHJhY3QgY29ycmVzcG9uZGluZyBxdWFudGl0eSBwYXJhbWV0ZXJzXG4gICAqXG4gICAqIEByZXR1cm4ge0NvbmZpZ3VyYXRvckF0dHJpYnV0ZVF1YW50aXR5Q29tcG9uZW50T3B0aW9uc30gLSBOZXcgcXVhbnRpdHkgb3B0aW9uc1xuICAgKi9cbiAgZXh0cmFjdFF1YW50aXR5UGFyYW1ldGVycygpOiBDb25maWd1cmF0b3JBdHRyaWJ1dGVRdWFudGl0eUNvbXBvbmVudE9wdGlvbnMge1xuICAgIGNvbnN0IHF1YW50aXR5RnJvbU9wdGlvbnMgPVxuICAgICAgdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMucHJvZHVjdEJvdW5kVmFsdWUucXVhbnRpdHk7XG5cbiAgICBjb25zdCBtZXJnZWRMb2FkaW5nID0gdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMubG9hZGluZyRcbiAgICAgID8gY29tYmluZUxhdGVzdChbdGhpcy5sb2FkaW5nJCwgdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMubG9hZGluZyRdKS5waXBlKFxuICAgICAgICAgIG1hcCgodmFsdWVzKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWVzWzBdIHx8IHZhbHVlc1sxXTtcbiAgICAgICAgICB9KVxuICAgICAgICApXG4gICAgICA6IHRoaXMubG9hZGluZyQ7XG5cbiAgICByZXR1cm4ge1xuICAgICAgYWxsb3daZXJvOiAhdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMuaGlkZVJlbW92ZUJ1dHRvbixcbiAgICAgIGluaXRpYWxRdWFudGl0eTogcXVhbnRpdHlGcm9tT3B0aW9ucyA/IHF1YW50aXR5RnJvbU9wdGlvbnMgOiAwLFxuICAgICAgZGlzYWJsZVF1YW50aXR5QWN0aW9ucyQ6IG1lcmdlZExvYWRpbmcsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmllcyB3aGV0aGVyIHRoZSB2YWx1ZSBjb2RlIGlzIGRlZmluZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZUNvZGUgLSBWYWx1ZSBjb2RlXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IC0gJ3RydWUnIGlmIHRoZSB2YWx1ZSBjb2RlIGlzIGRlZmluZWQsIG90aGVyd2lzZSAnZmFsc2UnXG4gICAqL1xuICBpc1ZhbHVlQ29kZURlZmluZWQodmFsdWVDb2RlOiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHZhbHVlQ29kZSAmJiB2YWx1ZUNvZGUgIT09IENvbmZpZ3VyYXRvci5SZXRyYWN0VmFsdWVDb2RlXG4gICAgICA/IHRydWVcbiAgICAgIDogZmFsc2U7XG4gIH1cblxuICBwcm90ZWN0ZWQgdHJhbnNmb3JtVG9Qcm9kdWN0VHlwZShcbiAgICB2YWx1ZTogQ29uZmlndXJhdG9yLlZhbHVlIHwgdW5kZWZpbmVkXG4gICk6IFByb2R1Y3Qge1xuICAgIHJldHVybiB7XG4gICAgICBjb2RlOiB2YWx1ZT8ucHJvZHVjdFN5c3RlbUlkLFxuICAgICAgZGVzY3JpcHRpb246IHZhbHVlPy5kZXNjcmlwdGlvbixcbiAgICAgIGltYWdlczoge30sXG4gICAgICBuYW1lOiB2YWx1ZT8udmFsdWVEaXNwbGF5LFxuICAgIH07XG4gIH1cblxuICBwcm90ZWN0ZWQgb25IYW5kbGVRdWFudGl0eShxdWFudGl0eTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5sb2FkaW5nJC5uZXh0KHRydWUpO1xuXG4gICAgdGhpcy5oYW5kbGVRdWFudGl0eS5lbWl0KHtcbiAgICAgIHF1YW50aXR5LFxuICAgICAgdmFsdWVDb2RlOiB0aGlzLnByb2R1Y3RDYXJkT3B0aW9ucy5wcm9kdWN0Qm91bmRWYWx1ZS52YWx1ZUNvZGUsXG4gICAgfSk7XG4gIH1cblxuICBzaG93RGVzZWxlY3Rpb25Ob3RQb3NzaWJsZU1lc3NhZ2UoKSB7XG4gICAgdGhpcy5zaG93RGVzZWxlY3Rpb25Ob3RQb3NzaWJsZSA9IHRydWU7XG4gIH1cblxuICBnZXRBcmlhTGFiZWxTaW5nbGVVbnNlbGVjdGVkKHByb2R1Y3Q6IFByb2R1Y3QpOiBzdHJpbmcge1xuICAgIGxldCB0cmFuc2xhdGVkVGV4dCA9ICcnO1xuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMuaXRlbUluZGV4ICsgMTtcbiAgICBpZiAoXG4gICAgICB0aGlzLmlzVmFsdWVDb2RlRGVmaW5lZChcbiAgICAgICAgdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnM/LnByb2R1Y3RCb3VuZFZhbHVlPy52YWx1ZUNvZGVcbiAgICAgIClcbiAgICApIHtcbiAgICAgIGlmIChcbiAgICAgICAgdGhpcy5oYXNQcmljZURpc3BsYXkoKSAmJlxuICAgICAgICB0aGlzLnByb2R1Y3RDYXJkT3B0aW9ucy5wcm9kdWN0Qm91bmRWYWx1ZS52YWx1ZVByaWNlPy52YWx1ZSAhPT0gMFxuICAgICAgKSB7XG4gICAgICAgIHRoaXMudHJhbnNsYXRpb25cbiAgICAgICAgICAudHJhbnNsYXRlKCdjb25maWd1cmF0b3IuYTExeS5pdGVtT2ZBdHRyaWJ1dGVVbnNlbGVjdGVkV2l0aFByaWNlJywge1xuICAgICAgICAgICAgaXRlbTogcHJvZHVjdC5jb2RlLFxuICAgICAgICAgICAgYXR0cmlidXRlOiB0aGlzLnByb2R1Y3RDYXJkT3B0aW9ucz8uYXR0cmlidXRlTGFiZWwsXG4gICAgICAgICAgICBpdGVtSW5kZXg6IGluZGV4LFxuICAgICAgICAgICAgaXRlbUNvdW50OiB0aGlzLnByb2R1Y3RDYXJkT3B0aW9ucy5pdGVtQ291bnQsXG4gICAgICAgICAgICBwcmljZTpcbiAgICAgICAgICAgICAgdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMucHJvZHVjdEJvdW5kVmFsdWUudmFsdWVQcmljZVRvdGFsXG4gICAgICAgICAgICAgICAgPy5mb3JtYXR0ZWRWYWx1ZSxcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5waXBlKHRha2UoMSkpXG4gICAgICAgICAgLnN1YnNjcmliZSgodGV4dCkgPT4gKHRyYW5zbGF0ZWRUZXh0ID0gdGV4dCkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy50cmFuc2xhdGlvblxuICAgICAgICAgIC50cmFuc2xhdGUoJ2NvbmZpZ3VyYXRvci5hMTF5Lml0ZW1PZkF0dHJpYnV0ZVVuc2VsZWN0ZWQnLCB7XG4gICAgICAgICAgICBpdGVtOiBwcm9kdWN0LmNvZGUsXG4gICAgICAgICAgICBhdHRyaWJ1dGU6IHRoaXMucHJvZHVjdENhcmRPcHRpb25zPy5hdHRyaWJ1dGVMYWJlbCxcbiAgICAgICAgICAgIGl0ZW1JbmRleDogaW5kZXgsXG4gICAgICAgICAgICBpdGVtQ291bnQ6IHRoaXMucHJvZHVjdENhcmRPcHRpb25zLml0ZW1Db3VudCxcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5waXBlKHRha2UoMSkpXG4gICAgICAgICAgLnN1YnNjcmliZSgodGV4dCkgPT4gKHRyYW5zbGF0ZWRUZXh0ID0gdGV4dCkpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnRyYW5zbGF0aW9uXG4gICAgICAgIC50cmFuc2xhdGUoJ2NvbmZpZ3VyYXRvci5hMTF5LnNlbGVjdE5vSXRlbU9mQXR0cmlidXRlJywge1xuICAgICAgICAgIGF0dHJpYnV0ZTogdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnM/LmF0dHJpYnV0ZUxhYmVsLFxuICAgICAgICAgIGl0ZW1JbmRleDogaW5kZXgsXG4gICAgICAgICAgaXRlbUNvdW50OiB0aGlzLnByb2R1Y3RDYXJkT3B0aW9ucy5pdGVtQ291bnQsXG4gICAgICAgIH0pXG4gICAgICAgIC5waXBlKHRha2UoMSkpXG4gICAgICAgIC5zdWJzY3JpYmUoKHRleHQpID0+ICh0cmFuc2xhdGVkVGV4dCA9IHRleHQpKTtcbiAgICB9XG4gICAgcmV0dXJuIHRyYW5zbGF0ZWRUZXh0O1xuICB9XG5cbiAgZ2V0QXJpYUxhYmVsU2luZ2xlU2VsZWN0ZWQocHJvZHVjdDogUHJvZHVjdCk6IHN0cmluZyB7XG4gICAgbGV0IHRyYW5zbGF0ZWRUZXh0ID0gJyc7XG4gICAgY29uc3QgaW5kZXggPSB0aGlzLnByb2R1Y3RDYXJkT3B0aW9ucy5pdGVtSW5kZXggKyAxO1xuICAgIGlmIChcbiAgICAgIHRoaXMuaGFzUHJpY2VEaXNwbGF5KCkgJiZcbiAgICAgIHRoaXMucHJvZHVjdENhcmRPcHRpb25zLnByb2R1Y3RCb3VuZFZhbHVlLnZhbHVlUHJpY2U/LnZhbHVlICE9PSAwXG4gICAgKSB7XG4gICAgICB0aGlzLnRyYW5zbGF0aW9uXG4gICAgICAgIC50cmFuc2xhdGUoXG4gICAgICAgICAgJ2NvbmZpZ3VyYXRvci5hMTF5Lml0ZW1PZkF0dHJpYnV0ZVNlbGVjdGVkUHJlc3NUb1Vuc2VsZWN0V2l0aFByaWNlJyxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBpdGVtOiBwcm9kdWN0LmNvZGUsXG4gICAgICAgICAgICBhdHRyaWJ1dGU6IHRoaXMucHJvZHVjdENhcmRPcHRpb25zPy5hdHRyaWJ1dGVMYWJlbCxcbiAgICAgICAgICAgIGl0ZW1JbmRleDogaW5kZXgsXG4gICAgICAgICAgICBpdGVtQ291bnQ6IHRoaXMucHJvZHVjdENhcmRPcHRpb25zLml0ZW1Db3VudCxcbiAgICAgICAgICAgIHByaWNlOlxuICAgICAgICAgICAgICB0aGlzLnByb2R1Y3RDYXJkT3B0aW9ucy5wcm9kdWN0Qm91bmRWYWx1ZS52YWx1ZVByaWNlVG90YWxcbiAgICAgICAgICAgICAgICA/LmZvcm1hdHRlZFZhbHVlLFxuICAgICAgICAgIH1cbiAgICAgICAgKVxuICAgICAgICAucGlwZSh0YWtlKDEpKVxuICAgICAgICAuc3Vic2NyaWJlKCh0ZXh0KSA9PiAodHJhbnNsYXRlZFRleHQgPSB0ZXh0KSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudHJhbnNsYXRpb25cbiAgICAgICAgLnRyYW5zbGF0ZSgnY29uZmlndXJhdG9yLmExMXkuaXRlbU9mQXR0cmlidXRlU2VsZWN0ZWRQcmVzc1RvVW5zZWxlY3QnLCB7XG4gICAgICAgICAgaXRlbTogcHJvZHVjdC5jb2RlLFxuICAgICAgICAgIGF0dHJpYnV0ZTogdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnM/LmF0dHJpYnV0ZUxhYmVsLFxuICAgICAgICAgIGl0ZW1JbmRleDogaW5kZXgsXG4gICAgICAgICAgaXRlbUNvdW50OiB0aGlzLnByb2R1Y3RDYXJkT3B0aW9ucy5pdGVtQ291bnQsXG4gICAgICAgIH0pXG4gICAgICAgIC5waXBlKHRha2UoMSkpXG4gICAgICAgIC5zdWJzY3JpYmUoKHRleHQpID0+ICh0cmFuc2xhdGVkVGV4dCA9IHRleHQpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdHJhbnNsYXRlZFRleHQ7XG4gIH1cblxuICBnZXRBcmlhTGFiZWxTaW5nbGVTZWxlY3RlZE5vQnV0dG9uKHByb2R1Y3Q6IFByb2R1Y3QpOiBzdHJpbmcge1xuICAgIGxldCB0cmFuc2xhdGVkVGV4dCA9ICcnO1xuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMuaXRlbUluZGV4ICsgMTtcbiAgICBpZiAoXG4gICAgICB0aGlzLmhhc1ByaWNlRGlzcGxheSgpICYmXG4gICAgICB0aGlzLnByb2R1Y3RDYXJkT3B0aW9ucy5wcm9kdWN0Qm91bmRWYWx1ZS52YWx1ZVByaWNlPy52YWx1ZSAhPT0gMFxuICAgICkge1xuICAgICAgdGhpcy50cmFuc2xhdGlvblxuICAgICAgICAudHJhbnNsYXRlKCdjb25maWd1cmF0b3IuYTExeS5pdGVtT2ZBdHRyaWJ1dGVTZWxlY3RlZFdpdGhQcmljZScsIHtcbiAgICAgICAgICBpdGVtOiBwcm9kdWN0LmNvZGUsXG4gICAgICAgICAgYXR0cmlidXRlOiB0aGlzLnByb2R1Y3RDYXJkT3B0aW9ucz8uYXR0cmlidXRlTGFiZWwsXG4gICAgICAgICAgaXRlbUluZGV4OiBpbmRleCxcbiAgICAgICAgICBpdGVtQ291bnQ6IHRoaXMucHJvZHVjdENhcmRPcHRpb25zLml0ZW1Db3VudCxcbiAgICAgICAgICBwcmljZTpcbiAgICAgICAgICAgIHRoaXMucHJvZHVjdENhcmRPcHRpb25zLnByb2R1Y3RCb3VuZFZhbHVlLnZhbHVlUHJpY2VUb3RhbFxuICAgICAgICAgICAgICA/LmZvcm1hdHRlZFZhbHVlLFxuICAgICAgICB9KVxuICAgICAgICAucGlwZSh0YWtlKDEpKVxuICAgICAgICAuc3Vic2NyaWJlKCh0ZXh0KSA9PiAodHJhbnNsYXRlZFRleHQgPSB0ZXh0KSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudHJhbnNsYXRpb25cbiAgICAgICAgLnRyYW5zbGF0ZSgnY29uZmlndXJhdG9yLmExMXkuaXRlbU9mQXR0cmlidXRlU2VsZWN0ZWQnLCB7XG4gICAgICAgICAgaXRlbTogcHJvZHVjdC5jb2RlLFxuICAgICAgICAgIGF0dHJpYnV0ZTogdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnM/LmF0dHJpYnV0ZUxhYmVsLFxuICAgICAgICAgIGl0ZW1JbmRleDogaW5kZXgsXG4gICAgICAgICAgaXRlbUNvdW50OiB0aGlzLnByb2R1Y3RDYXJkT3B0aW9ucy5pdGVtQ291bnQsXG4gICAgICAgIH0pXG4gICAgICAgIC5waXBlKHRha2UoMSkpXG4gICAgICAgIC5zdWJzY3JpYmUoKHRleHQpID0+ICh0cmFuc2xhdGVkVGV4dCA9IHRleHQpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdHJhbnNsYXRlZFRleHQ7XG4gIH1cblxuICBnZXRBcmlhTGFiZWxNdWx0aVNlbGVjdGVkKHByb2R1Y3Q6IFByb2R1Y3QpOiBzdHJpbmcge1xuICAgIGxldCB0cmFuc2xhdGVkVGV4dCA9ICcnO1xuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMuaXRlbUluZGV4ICsgMTtcbiAgICBpZiAoXG4gICAgICB0aGlzLmhhc1ByaWNlRGlzcGxheSgpICYmXG4gICAgICB0aGlzLnByb2R1Y3RDYXJkT3B0aW9ucy5wcm9kdWN0Qm91bmRWYWx1ZS52YWx1ZVByaWNlPy52YWx1ZSAhPT0gMFxuICAgICkge1xuICAgICAgdGhpcy50cmFuc2xhdGlvblxuICAgICAgICAudHJhbnNsYXRlKFxuICAgICAgICAgICdjb25maWd1cmF0b3IuYTExeS5pdGVtT2ZBdHRyaWJ1dGVTZWxlY3RlZFByZXNzVG9VbnNlbGVjdFdpdGhQcmljZScsXG4gICAgICAgICAge1xuICAgICAgICAgICAgaXRlbTogcHJvZHVjdC5jb2RlLFxuICAgICAgICAgICAgYXR0cmlidXRlOiB0aGlzLnByb2R1Y3RDYXJkT3B0aW9ucz8uYXR0cmlidXRlTGFiZWwsXG4gICAgICAgICAgICBpdGVtSW5kZXg6IGluZGV4LFxuICAgICAgICAgICAgaXRlbUNvdW50OiB0aGlzLnByb2R1Y3RDYXJkT3B0aW9ucy5pdGVtQ291bnQsXG4gICAgICAgICAgICBwcmljZTpcbiAgICAgICAgICAgICAgdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMucHJvZHVjdEJvdW5kVmFsdWUudmFsdWVQcmljZVRvdGFsXG4gICAgICAgICAgICAgICAgPy5mb3JtYXR0ZWRWYWx1ZSxcbiAgICAgICAgICB9XG4gICAgICAgIClcbiAgICAgICAgLnBpcGUodGFrZSgxKSlcbiAgICAgICAgLnN1YnNjcmliZSgodGV4dCkgPT4gKHRyYW5zbGF0ZWRUZXh0ID0gdGV4dCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnRyYW5zbGF0aW9uXG4gICAgICAgIC50cmFuc2xhdGUoJ2NvbmZpZ3VyYXRvci5hMTF5Lml0ZW1PZkF0dHJpYnV0ZVNlbGVjdGVkUHJlc3NUb1Vuc2VsZWN0Jywge1xuICAgICAgICAgIGl0ZW06IHByb2R1Y3QuY29kZSxcbiAgICAgICAgICBhdHRyaWJ1dGU6IHRoaXMucHJvZHVjdENhcmRPcHRpb25zPy5hdHRyaWJ1dGVMYWJlbCxcbiAgICAgICAgICBpdGVtSW5kZXg6IGluZGV4LFxuICAgICAgICAgIGl0ZW1Db3VudDogdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMuaXRlbUNvdW50LFxuICAgICAgICB9KVxuICAgICAgICAucGlwZSh0YWtlKDEpKVxuICAgICAgICAuc3Vic2NyaWJlKCh0ZXh0KSA9PiAodHJhbnNsYXRlZFRleHQgPSB0ZXh0KSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRyYW5zbGF0ZWRUZXh0O1xuICB9XG5cbiAgZ2V0QXJpYUxhYmVsTXVsdGlVbnNlbGVjdGVkKHByb2R1Y3Q6IFByb2R1Y3QpOiBzdHJpbmcge1xuICAgIGxldCB0cmFuc2xhdGVkVGV4dCA9ICcnO1xuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMuaXRlbUluZGV4ICsgMTtcbiAgICBpZiAoXG4gICAgICB0aGlzLmhhc1ByaWNlRGlzcGxheSgpICYmXG4gICAgICB0aGlzLnByb2R1Y3RDYXJkT3B0aW9ucy5wcm9kdWN0Qm91bmRWYWx1ZS52YWx1ZVByaWNlPy52YWx1ZSAhPT0gMFxuICAgICkge1xuICAgICAgdGhpcy50cmFuc2xhdGlvblxuICAgICAgICAudHJhbnNsYXRlKCdjb25maWd1cmF0b3IuYTExeS5pdGVtT2ZBdHRyaWJ1dGVVbnNlbGVjdGVkV2l0aFByaWNlJywge1xuICAgICAgICAgIGl0ZW06IHByb2R1Y3QuY29kZSxcbiAgICAgICAgICBhdHRyaWJ1dGU6IHRoaXMucHJvZHVjdENhcmRPcHRpb25zPy5hdHRyaWJ1dGVMYWJlbCxcbiAgICAgICAgICBpdGVtSW5kZXg6IGluZGV4LFxuICAgICAgICAgIGl0ZW1Db3VudDogdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMuaXRlbUNvdW50LFxuICAgICAgICAgIHByaWNlOlxuICAgICAgICAgICAgdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMucHJvZHVjdEJvdW5kVmFsdWUudmFsdWVQcmljZVRvdGFsXG4gICAgICAgICAgICAgID8uZm9ybWF0dGVkVmFsdWUsXG4gICAgICAgIH0pXG4gICAgICAgIC5waXBlKHRha2UoMSkpXG4gICAgICAgIC5zdWJzY3JpYmUoKHRleHQpID0+ICh0cmFuc2xhdGVkVGV4dCA9IHRleHQpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy50cmFuc2xhdGlvblxuICAgICAgICAudHJhbnNsYXRlKCdjb25maWd1cmF0b3IuYTExeS5pdGVtT2ZBdHRyaWJ1dGVVbnNlbGVjdGVkJywge1xuICAgICAgICAgIGl0ZW06IHByb2R1Y3QuY29kZSxcbiAgICAgICAgICBhdHRyaWJ1dGU6IHRoaXMucHJvZHVjdENhcmRPcHRpb25zPy5hdHRyaWJ1dGVMYWJlbCxcbiAgICAgICAgICBpdGVtSW5kZXg6IGluZGV4LFxuICAgICAgICAgIGl0ZW1Db3VudDogdGhpcy5wcm9kdWN0Q2FyZE9wdGlvbnMuaXRlbUNvdW50LFxuICAgICAgICB9KVxuICAgICAgICAucGlwZSh0YWtlKDEpKVxuICAgICAgICAuc3Vic2NyaWJlKCh0ZXh0KSA9PiAodHJhbnNsYXRlZFRleHQgPSB0ZXh0KSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRyYW5zbGF0ZWRUZXh0O1xuICB9XG59XG4iLCI8bmctY29udGFpbmVyICpuZ0lmPVwicHJvZHVjdCQgfCBhc3luYyBhcyBwcm9kdWN0XCI+XG4gIDxkaXZcbiAgICBjbGFzcz1cImN4LXByb2R1Y3QtY2FyZFwiXG4gICAgW25nQ2xhc3NdPVwie1xuICAgICAgJ2N4LXByb2R1Y3QtY2FyZC1zZWxlY3RlZCc6IGlzUHJvZHVjdENhcmRTZWxlY3RlZCgpXG4gICAgfVwiXG4gICAgW2F0dHIuYXJpYS1sYWJlbF09XCJcbiAgICAgICdjb25maWd1cmF0b3IuYTExeS5pdGVtT2ZBdHRyaWJ1dGUnXG4gICAgICAgIHwgY3hUcmFuc2xhdGVcbiAgICAgICAgICA6IHtcbiAgICAgICAgICAgICAgYXR0cmlidXRlOiBwcm9kdWN0Q2FyZE9wdGlvbnMuYXR0cmlidXRlTGFiZWxcbiAgICAgICAgICAgIH1cbiAgICBcIlxuICA+XG4gICAgPGRpdiBjbGFzcz1cImN4LXByb2R1Y3QtY2FyZC1yb3dzXCI+XG4gICAgICA8ZGl2IGNsYXNzPVwiY3gtcHJvZHVjdC1jYXJkLWltZ3NcIj5cbiAgICAgICAgPGN4LW1lZGlhXG4gICAgICAgICAgW2NvbnRhaW5lcl09XCJwcm9kdWN0LmltYWdlcz8uUFJJTUFSWVwiXG4gICAgICAgICAgZm9ybWF0PVwicHJvZHVjdFwiXG4gICAgICAgICAgYXJpYS1oaWRkZW49XCJ0cnVlXCJcbiAgICAgICAgPjwvY3gtbWVkaWE+XG4gICAgICA8L2Rpdj5cblxuICAgICAgPGRpdiBjbGFzcz1cImN4LXByb2R1Y3QtY2FyZC1pbmZvXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJjeC1wcm9kdWN0LWNhcmQtbmFtZVwiPlxuICAgICAgICAgIDxwPlxuICAgICAgICAgICAge3sgcHJvZHVjdC5uYW1lIH19XG4gICAgICAgICAgPC9wPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImN4LXByb2R1Y3QtY2FyZC1jb2RlXCIgKm5nSWY9XCJwcm9kdWN0LmNvZGVcIj5cbiAgICAgICAgICB7eyAnY29uZmlndXJhdG9yLmF0dHJpYnV0ZS5pZCcgfCBjeFRyYW5zbGF0ZSB9fTpcbiAgICAgICAgICB7eyBwcm9kdWN0LmNvZGUgfX1cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxjeC1jb25maWd1cmF0b3Itc2hvdy1tb3JlXG4gICAgICAgICAgKm5nSWY9XCJwcm9kdWN0LmRlc2NyaXB0aW9uICYmIHByb2R1Y3QuY29kZVwiXG4gICAgICAgICAgW3RleHRdPVwicHJvZHVjdC5kZXNjcmlwdGlvblwiXG4gICAgICAgICAgW3RleHRTaXplXT1cIjQ1XCJcbiAgICAgICAgICBbcHJvZHVjdE5hbWVdPVwicHJvZHVjdC5jb2RlXCJcbiAgICAgICAgPjwvY3gtY29uZmlndXJhdG9yLXNob3ctbW9yZT5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuXG4gICAgPGRpdlxuICAgICAgY2xhc3M9XCJjeC1wcm9kdWN0LWNhcmQtcm93cyBjb2x1bW5cIlxuICAgICAgKm5nSWY9XCIhcHJvZHVjdENhcmRPcHRpb25zLnNpbmdsZURyb3Bkb3duIHx8IGhhc1ByaWNlRGlzcGxheSgpXCJcbiAgICA+XG4gICAgICA8ZGl2IGNsYXNzPVwiY3gtcHJvZHVjdC1jYXJkLXF1YW50aXR5LXByaWNlXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJjeC1wcm9kdWN0LWNhcmQtcXVhbnRpdHlcIj5cbiAgICAgICAgICA8Y3gtY29uZmlndXJhdG9yLWF0dHJpYnV0ZS1xdWFudGl0eVxuICAgICAgICAgICAgKm5nSWY9XCJzaG93UXVhbnRpdHlcIlxuICAgICAgICAgICAgKGNoYW5nZVF1YW50aXR5KT1cIm9uQ2hhbmdlUXVhbnRpdHkoJGV2ZW50KVwiXG4gICAgICAgICAgICBbcXVhbnRpdHlPcHRpb25zXT1cImV4dHJhY3RRdWFudGl0eVBhcmFtZXRlcnMoKVwiXG4gICAgICAgICAgPjwvY3gtY29uZmlndXJhdG9yLWF0dHJpYnV0ZS1xdWFudGl0eT5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJjeC1wcm9kdWN0LWNhcmQtcHJpY2VcIj5cbiAgICAgICAgICA8Y3gtY29uZmlndXJhdG9yLXByaWNlXG4gICAgICAgICAgICBbZm9ybXVsYV09XCJleHRyYWN0UHJpY2VGb3JtdWxhUGFyYW1ldGVycygpXCJcbiAgICAgICAgICA+PC9jeC1jb25maWd1cmF0b3ItcHJpY2U+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzPVwiY3gtcHJvZHVjdC1jYXJkLWFjdGlvblwiPlxuICAgICAgICA8ZGl2XG4gICAgICAgICAgY2xhc3M9XCJjeC1wcm9kdWN0LWNhcmQtYWN0aW9uLWJ0blwiXG4gICAgICAgICAgKm5nSWY9XCIhcHJvZHVjdENhcmRPcHRpb25zPy5zaW5nbGVEcm9wZG93blwiXG4gICAgICAgID5cbiAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwicHJvZHVjdENhcmRPcHRpb25zPy5tdWx0aVNlbGVjdDsgZWxzZSBzaW5nbGVcIj5cbiAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgKm5nSWY9XCJcbiAgICAgICAgICAgICAgICBwcm9kdWN0Q2FyZE9wdGlvbnM/LnByb2R1Y3RCb3VuZFZhbHVlPy5zZWxlY3RlZDtcbiAgICAgICAgICAgICAgICBlbHNlIHNlbGVjdFxuICAgICAgICAgICAgICBcIlxuICAgICAgICAgICAgICBjbGFzcz1cImJ0biBidG4tc2Vjb25kYXJ5XCJcbiAgICAgICAgICAgICAgKGNsaWNrKT1cIm9uSGFuZGxlRGVzZWxlY3QoKVwiXG4gICAgICAgICAgICAgIFtjeEZvY3VzXT1cImZvY3VzQ29uZmlnXCJcbiAgICAgICAgICAgICAgW2F0dHIuYXJpYS1sYWJlbF09XCJnZXRBcmlhTGFiZWxNdWx0aVNlbGVjdGVkKHByb2R1Y3QpXCJcbiAgICAgICAgICAgICAgW2F0dHIuYXJpYS1kZXNjcmliZWRieV09XCJcbiAgICAgICAgICAgICAgICBjcmVhdGVBdHRyaWJ1dGVVaUtleSgnbGFiZWwnLCBhdHRyaWJ1dGVOYW1lKVxuICAgICAgICAgICAgICBcIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7eyAnY29uZmlndXJhdG9yLmJ1dHRvbi5yZW1vdmUnIHwgY3hUcmFuc2xhdGUgfX1cbiAgICAgICAgICAgIDwvYnV0dG9uPlxuXG4gICAgICAgICAgICA8bmctdGVtcGxhdGUgI3NlbGVjdD5cbiAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5XCJcbiAgICAgICAgICAgICAgICAoY2xpY2spPVwib25IYW5kbGVTZWxlY3QoKVwiXG4gICAgICAgICAgICAgICAgW2Rpc2FibGVkXT1cIlxuICAgICAgICAgICAgICAgICAgcHJvZHVjdENhcmRPcHRpb25zLmRpc2FibGVBbGxCdXR0b25zIHx8IChsb2FkaW5nJCB8IGFzeW5jKVxuICAgICAgICAgICAgICAgIFwiXG4gICAgICAgICAgICAgICAgW2N4Rm9jdXNdPVwiZm9jdXNDb25maWdcIlxuICAgICAgICAgICAgICAgIFthdHRyLmFyaWEtbGFiZWxdPVwiZ2V0QXJpYUxhYmVsTXVsdGlVbnNlbGVjdGVkKHByb2R1Y3QpXCJcbiAgICAgICAgICAgICAgICBbYXR0ci5hcmlhLWRlc2NyaWJlZGJ5XT1cIlxuICAgICAgICAgICAgICAgICAgY3JlYXRlQXR0cmlidXRlVWlLZXkoJ2xhYmVsJywgYXR0cmlidXRlTmFtZSlcbiAgICAgICAgICAgICAgICBcIlxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAge3sgJ2NvbmZpZ3VyYXRvci5idXR0b24uYWRkJyB8IGN4VHJhbnNsYXRlIH19XG4gICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cblxuICAgICAgICAgIDxuZy10ZW1wbGF0ZSAjc2luZ2xlPlxuICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICBjbGFzcz1cImJ0biBidG4tcHJpbWFyeVwiXG4gICAgICAgICAgICAgIChjbGljayk9XCJvbkhhbmRsZVNlbGVjdCgpXCJcbiAgICAgICAgICAgICAgW2Rpc2FibGVkXT1cIlxuICAgICAgICAgICAgICAgIHByb2R1Y3RDYXJkT3B0aW9ucy5kaXNhYmxlQWxsQnV0dG9ucyB8fCAobG9hZGluZyQgfCBhc3luYylcbiAgICAgICAgICAgICAgXCJcbiAgICAgICAgICAgICAgKm5nSWY9XCJcbiAgICAgICAgICAgICAgICAhcHJvZHVjdENhcmRPcHRpb25zPy5wcm9kdWN0Qm91bmRWYWx1ZT8uc2VsZWN0ZWQ7XG4gICAgICAgICAgICAgICAgZWxzZSBkZXNlbGVjdFxuICAgICAgICAgICAgICBcIlxuICAgICAgICAgICAgICBbY3hGb2N1c109XCJmb2N1c0NvbmZpZ1wiXG4gICAgICAgICAgICAgIFthdHRyLmFyaWEtbGFiZWxdPVwiZ2V0QXJpYUxhYmVsU2luZ2xlVW5zZWxlY3RlZChwcm9kdWN0KVwiXG4gICAgICAgICAgICAgIFthdHRyLmFyaWEtZGVzY3JpYmVkYnldPVwiXG4gICAgICAgICAgICAgICAgY3JlYXRlQXR0cmlidXRlVWlLZXkoJ2xhYmVsJywgYXR0cmlidXRlTmFtZSlcbiAgICAgICAgICAgICAgXCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAge3sgJ2NvbmZpZ3VyYXRvci5idXR0b24uc2VsZWN0JyB8IGN4VHJhbnNsYXRlIH19XG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSAjZGVzZWxlY3Q+XG4gICAgICAgICAgICAgIDxuZy1jb250YWluZXJcbiAgICAgICAgICAgICAgICAqbmdJZj1cIlxuICAgICAgICAgICAgICAgICAgaXNWYWx1ZUNvZGVEZWZpbmVkKFxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0Q2FyZE9wdGlvbnM/LnByb2R1Y3RCb3VuZFZhbHVlPy52YWx1ZUNvZGVcbiAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICBcIlxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgKm5nSWY9XCIhcHJvZHVjdENhcmRPcHRpb25zPy5oaWRlUmVtb3ZlQnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgIGNsYXNzPVwiYnRuIGJ0bi1zZWNvbmRhcnlcIlxuICAgICAgICAgICAgICAgICAgKGNsaWNrKT1cIm9uSGFuZGxlRGVzZWxlY3QoKVwiXG4gICAgICAgICAgICAgICAgICBbZGlzYWJsZWRdPVwiXG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RDYXJkT3B0aW9ucy5oaWRlUmVtb3ZlQnV0dG9uIHx8IChsb2FkaW5nJCB8IGFzeW5jKVxuICAgICAgICAgICAgICAgICAgXCJcbiAgICAgICAgICAgICAgICAgIFtjeEZvY3VzXT1cImZvY3VzQ29uZmlnXCJcbiAgICAgICAgICAgICAgICAgIFthdHRyLmFyaWEtbGFiZWxdPVwiZ2V0QXJpYUxhYmVsU2luZ2xlU2VsZWN0ZWQocHJvZHVjdClcIlxuICAgICAgICAgICAgICAgICAgW2F0dHIuYXJpYS1kZXNjcmliZWRieV09XCJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlQXR0cmlidXRlVWlLZXkoJ2xhYmVsJywgYXR0cmlidXRlTmFtZSlcbiAgICAgICAgICAgICAgICAgIFwiXG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAge3sgJ2NvbmZpZ3VyYXRvci5idXR0b24uZGVzZWxlY3QnIHwgY3hUcmFuc2xhdGUgfX1cbiAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICA8c3BhblxuICAgICAgICAgICAgICAgICAgKm5nSWY9XCJwcm9kdWN0Q2FyZE9wdGlvbnM/LmhpZGVSZW1vdmVCdXR0b25cIlxuICAgICAgICAgICAgICAgICAgY2xhc3M9XCJjeC12aXN1YWxseS1oaWRkZW5cIlxuICAgICAgICAgICAgICAgICAgdGFiaW5kZXg9XCIwXCJcbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICB7eyBnZXRBcmlhTGFiZWxTaW5nbGVTZWxlY3RlZE5vQnV0dG9uKHByb2R1Y3QpIH19XG4gICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgICA8bmctY29udGFpbmVyICpuZ0lmPVwic2hvd0Rlc2VsZWN0aW9uTm90UG9zc2libGVcIj5cbiAgICAgIDxkaXZcbiAgICAgICAgY2xhc3M9XCJjeC1wcm9kdWN0LWNhcmQtcm93cyBkZXNlbGVjdGlvbi1lcnJvci1tZXNzYWdlXCJcbiAgICAgICAgYXJpYS1saXZlPVwiYXNzZXJ0aXZlXCJcbiAgICAgICAgYXJpYS1hdG9taWM9XCJ0cnVlXCJcbiAgICAgICAgcm9sZT1cImFsZXJ0XCJcbiAgICAgICAgaWQ9XCJ7eyBjcmVhdGVBdHRyaWJ1dGVVaUtleSgnYXR0cmlidXRlLW1zZycsIGF0dHJpYnV0ZU5hbWUpIH19XCJcbiAgICAgID5cbiAgICAgICAgPGN4LWljb24gY2xhc3M9XCJkZXNlbGVjdGlvbi1lcnJvci1zeW1ib2xcIiB0eXBlPVwiRVJST1JcIj48L2N4LWljb24+XG4gICAgICAgIHt7ICdjb25maWd1cmF0b3IuYXR0cmlidXRlLmRlc2VsZWN0aW9uTm90UG9zc2libGUnIHwgY3hUcmFuc2xhdGUgfX1cbiAgICAgIDwvZGl2PlxuICAgIDwvbmctY29udGFpbmVyPlxuICA8L2Rpdj5cbjwvbmctY29udGFpbmVyPlxuIl19