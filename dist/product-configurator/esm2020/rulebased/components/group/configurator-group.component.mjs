/*
 * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>
 *
 * SPDX-License-Identifier: Apache-2.0
 */
import { ChangeDetectionStrategy, Component, Input } from '@angular/core';
import { Configurator } from '../../core/model/configurator.model';
import * as i0 from "@angular/core";
import * as i1 from "../../core/facade/configurator-commons.service";
import * as i2 from "../../core/facade/configurator-groups.service";
import * as i3 from "@spartacus/core";
import * as i4 from "../service/configurator-storefront-utils.service";
import * as i5 from "../../core/services/configurator-expert-mode.service";
import * as i6 from "@angular/common";
import * as i7 from "../conflict-description/configurator-conflict-description.component";
import * as i8 from "../conflict-suggestion/configurator-conflict-suggestion.component";
import * as i9 from "../attribute/composition/configurator-attribute-composition.directive";
export class ConfiguratorGroupComponent {
    constructor(configuratorCommonsService, configuratorGroupsService, languageService, configUtils, configExpertModeService) {
        this.configuratorCommonsService = configuratorCommonsService;
        this.configuratorGroupsService = configuratorGroupsService;
        this.languageService = languageService;
        this.configUtils = configUtils;
        this.configExpertModeService = configExpertModeService;
        this.typePrefix = 'AttributeType_';
        this.activeLanguage$ = this.languageService.getActive();
        this.uiType = Configurator.UiType;
    }
    /**
     * Updates a configuration, specified by the configuration form update event.
     *
     * @param {ConfigFormUpdateEvent} event - Configuration form update event
     */
    updateConfiguration(event) {
        this.configuratorCommonsService.updateConfiguration(event.ownerKey, event.changedAttribute, event.updateType);
    }
    /**
     * Verifies whether the current group type is conflict one.
     *
     * @param {Configurator.GroupType | undefined} groupType - Group type
     * @return {boolean} - 'True' if the current group is conflict one, otherwise 'false'.
     */
    isConflictGroupType(groupType) {
        return groupType
            ? this.configuratorGroupsService.isConflictGroupType(groupType)
            : false;
    }
    /**
     * Display group description box only for conflict groups with a given group name (i.e. a conflict description)
     *
     * @param {Configurator.Group} group - Group
     * @returns {boolean} - 'True' if conflict description box should be displayed, otherwise 'false'.
     */
    displayConflictDescription(group) {
        return (group.groupType !== undefined &&
            this.configuratorGroupsService.isConflictGroupType(group.groupType) &&
            group.name !== '');
    }
    /**
     * Generates a group ID.
     *
     * @param {string} groupId - group ID
     * @returns {string | undefined} - generated group ID
     */
    createGroupId(groupId) {
        return this.configUtils.createGroupId(groupId);
    }
    /**
     * Retrieves information whether the expert mode is active.
     *
     * @returns {Observable<boolean> | undefined } - 'True' if the expert mode is active, otherwise 'false'.
     */
    get expMode() {
        return this.configExpertModeService.getExpModeActive();
    }
    getComponentKey(attribute) {
        return attribute.uiTypeVariation?.includes(Configurator.CustomUiTypeIndicator)
            ? this.typePrefix + attribute.uiTypeVariation
            : this.typePrefix + attribute.uiType;
    }
}
ConfiguratorGroupComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: ConfiguratorGroupComponent, deps: [{ token: i1.ConfiguratorCommonsService }, { token: i2.ConfiguratorGroupsService }, { token: i3.LanguageService }, { token: i4.ConfiguratorStorefrontUtilsService }, { token: i5.ConfiguratorExpertModeService }], target: i0.ɵɵFactoryTarget.Component });
ConfiguratorGroupComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.9", type: ConfiguratorGroupComponent, selector: "cx-configurator-group", inputs: { group: "group", owner: "owner", isNavigationToGroupEnabled: "isNavigationToGroupEnabled" }, ngImport: i0, template: "<div id=\"{{ createGroupId(group.id) }}\" role=\"tabpanel\">\n  <ng-container *ngIf=\"displayConflictDescription(group)\">\n    <cx-configurator-conflict-description\n      [currentGroup]=\"group\"\n    ></cx-configurator-conflict-description>\n  </ng-container>\n  <div\n    class=\"cx-group-attribute\"\n    [class.cx-hidden]=\"!attribute.visible\"\n    *ngFor=\"let attribute of group.attributes; let indexOfAttribute = index\"\n  >\n    <ng-container *ngIf=\"isConflictGroupType(group.groupType)\">\n      <cx-configurator-conflict-suggestion\n        [currentGroup]=\"group\"\n        [attribute]=\"attribute\"\n        [suggestionNumber]=\"indexOfAttribute\"\n      ></cx-configurator-conflict-suggestion>\n    </ng-container>\n\n    <ng-container *ngIf=\"activeLanguage$ | async as activeLanguage\">\n      <div\n        [cxConfiguratorAttributeComponent]=\"{\n          componentKey: 'Header',\n          attribute: attribute,\n          owner: owner,\n          group: group,\n          language: activeLanguage,\n          expMode: (expMode | async) ?? false,\n          isNavigationToGroupEnabled: isNavigationToGroupEnabled\n        }\"\n      ></div>\n\n      <div\n        [cxConfiguratorAttributeComponent]=\"{\n          componentKey: getComponentKey(attribute),\n          attribute: attribute,\n          owner: owner,\n          group: group,\n          language: activeLanguage,\n          expMode: (expMode | async) ?? false\n        }\"\n      ></div>\n\n      <div\n        [cxConfiguratorAttributeComponent]=\"{\n          componentKey: 'Footer',\n          attribute: attribute,\n          owner: owner,\n          group: group,\n          language: activeLanguage,\n          expMode: (expMode | async) ?? false\n        }\"\n      ></div>\n    </ng-container>\n  </div>\n</div>\n", dependencies: [{ kind: "directive", type: i6.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i6.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "component", type: i7.ConfiguratorConflictDescriptionComponent, selector: "cx-configurator-conflict-description", inputs: ["currentGroup"] }, { kind: "component", type: i8.ConfiguratorConflictSuggestionComponent, selector: "cx-configurator-conflict-suggestion", inputs: ["currentGroup", "attribute", "suggestionNumber"] }, { kind: "directive", type: i9.ConfiguratorAttributeCompositionDirective, selector: "[cxConfiguratorAttributeComponent]", inputs: ["cxConfiguratorAttributeComponent"] }, { kind: "pipe", type: i6.AsyncPipe, name: "async" }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: ConfiguratorGroupComponent, decorators: [{
            type: Component,
            args: [{ selector: 'cx-configurator-group', changeDetection: ChangeDetectionStrategy.OnPush, template: "<div id=\"{{ createGroupId(group.id) }}\" role=\"tabpanel\">\n  <ng-container *ngIf=\"displayConflictDescription(group)\">\n    <cx-configurator-conflict-description\n      [currentGroup]=\"group\"\n    ></cx-configurator-conflict-description>\n  </ng-container>\n  <div\n    class=\"cx-group-attribute\"\n    [class.cx-hidden]=\"!attribute.visible\"\n    *ngFor=\"let attribute of group.attributes; let indexOfAttribute = index\"\n  >\n    <ng-container *ngIf=\"isConflictGroupType(group.groupType)\">\n      <cx-configurator-conflict-suggestion\n        [currentGroup]=\"group\"\n        [attribute]=\"attribute\"\n        [suggestionNumber]=\"indexOfAttribute\"\n      ></cx-configurator-conflict-suggestion>\n    </ng-container>\n\n    <ng-container *ngIf=\"activeLanguage$ | async as activeLanguage\">\n      <div\n        [cxConfiguratorAttributeComponent]=\"{\n          componentKey: 'Header',\n          attribute: attribute,\n          owner: owner,\n          group: group,\n          language: activeLanguage,\n          expMode: (expMode | async) ?? false,\n          isNavigationToGroupEnabled: isNavigationToGroupEnabled\n        }\"\n      ></div>\n\n      <div\n        [cxConfiguratorAttributeComponent]=\"{\n          componentKey: getComponentKey(attribute),\n          attribute: attribute,\n          owner: owner,\n          group: group,\n          language: activeLanguage,\n          expMode: (expMode | async) ?? false\n        }\"\n      ></div>\n\n      <div\n        [cxConfiguratorAttributeComponent]=\"{\n          componentKey: 'Footer',\n          attribute: attribute,\n          owner: owner,\n          group: group,\n          language: activeLanguage,\n          expMode: (expMode | async) ?? false\n        }\"\n      ></div>\n    </ng-container>\n  </div>\n</div>\n" }]
        }], ctorParameters: function () { return [{ type: i1.ConfiguratorCommonsService }, { type: i2.ConfiguratorGroupsService }, { type: i3.LanguageService }, { type: i4.ConfiguratorStorefrontUtilsService }, { type: i5.ConfiguratorExpertModeService }]; }, propDecorators: { group: [{
                type: Input
            }], owner: [{
                type: Input
            }], isNavigationToGroupEnabled: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZmlndXJhdG9yLWdyb3VwLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL2ZlYXR1cmUtbGlicy9wcm9kdWN0LWNvbmZpZ3VyYXRvci9ydWxlYmFzZWQvY29tcG9uZW50cy9ncm91cC9jb25maWd1cmF0b3ItZ3JvdXAuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vZmVhdHVyZS1saWJzL3Byb2R1Y3QtY29uZmlndXJhdG9yL3J1bGViYXNlZC9jb21wb25lbnRzL2dyb3VwL2NvbmZpZ3VyYXRvci1ncm91cC5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7OztHQUlHO0FBRUgsT0FBTyxFQUFFLHVCQUF1QixFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFNMUUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLHFDQUFxQyxDQUFDOzs7Ozs7Ozs7OztBQVVuRSxNQUFNLE9BQU8sMEJBQTBCO0lBU3JDLFlBQ1ksMEJBQXNELEVBQ3RELHlCQUFvRCxFQUNwRCxlQUFnQyxFQUNoQyxXQUErQyxFQUMvQyx1QkFBc0Q7UUFKdEQsK0JBQTBCLEdBQTFCLDBCQUEwQixDQUE0QjtRQUN0RCw4QkFBeUIsR0FBekIseUJBQXlCLENBQTJCO1FBQ3BELG9CQUFlLEdBQWYsZUFBZSxDQUFpQjtRQUNoQyxnQkFBVyxHQUFYLFdBQVcsQ0FBb0M7UUFDL0MsNEJBQXVCLEdBQXZCLHVCQUF1QixDQUErQjtRQWIvQyxlQUFVLEdBQUcsZ0JBQWdCLENBQUM7UUFLakQsb0JBQWUsR0FBdUIsSUFBSSxDQUFDLGVBQWUsQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUN2RSxXQUFNLEdBQUcsWUFBWSxDQUFDLE1BQU0sQ0FBQztJQVExQixDQUFDO0lBRUo7Ozs7T0FJRztJQUNILG1CQUFtQixDQUFDLEtBQTRCO1FBQzlDLElBQUksQ0FBQywwQkFBMEIsQ0FBQyxtQkFBbUIsQ0FDakQsS0FBSyxDQUFDLFFBQVEsRUFDZCxLQUFLLENBQUMsZ0JBQWdCLEVBQ3RCLEtBQUssQ0FBQyxVQUFVLENBQ2pCLENBQUM7SUFDSixDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSCxtQkFBbUIsQ0FBQyxTQUE2QztRQUMvRCxPQUFPLFNBQVM7WUFDZCxDQUFDLENBQUMsSUFBSSxDQUFDLHlCQUF5QixDQUFDLG1CQUFtQixDQUFDLFNBQVMsQ0FBQztZQUMvRCxDQUFDLENBQUMsS0FBSyxDQUFDO0lBQ1osQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0gsMEJBQTBCLENBQUMsS0FBeUI7UUFDbEQsT0FBTyxDQUNMLEtBQUssQ0FBQyxTQUFTLEtBQUssU0FBUztZQUM3QixJQUFJLENBQUMseUJBQXlCLENBQUMsbUJBQW1CLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQztZQUNuRSxLQUFLLENBQUMsSUFBSSxLQUFLLEVBQUUsQ0FDbEIsQ0FBQztJQUNKLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNILGFBQWEsQ0FBQyxPQUFnQjtRQUM1QixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ2pELENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsSUFBSSxPQUFPO1FBQ1QsT0FBTyxJQUFJLENBQUMsdUJBQXVCLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztJQUN6RCxDQUFDO0lBRUQsZUFBZSxDQUFDLFNBQWlDO1FBQy9DLE9BQU8sU0FBUyxDQUFDLGVBQWUsRUFBRSxRQUFRLENBQ3hDLFlBQVksQ0FBQyxxQkFBcUIsQ0FDbkM7WUFDQyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsR0FBRyxTQUFTLENBQUMsZUFBZTtZQUM3QyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsR0FBRyxTQUFTLENBQUMsTUFBTSxDQUFDO0lBQ3pDLENBQUM7O3VIQWpGVSwwQkFBMEI7MkdBQTFCLDBCQUEwQixtS0N0QnZDLGd4REF3REE7MkZEbENhLDBCQUEwQjtrQkFMdEMsU0FBUzsrQkFDRSx1QkFBdUIsbUJBRWhCLHVCQUF1QixDQUFDLE1BQU07b1JBSXRDLEtBQUs7c0JBQWIsS0FBSztnQkFDRyxLQUFLO3NCQUFiLEtBQUs7Z0JBQ0csMEJBQTBCO3NCQUFsQyxLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIFNQRFgtRmlsZUNvcHlyaWdodFRleHQ6IDIwMjMgU0FQIFNwYXJ0YWN1cyB0ZWFtIDxzcGFydGFjdXMtdGVhbUBzYXAuY29tPlxuICpcbiAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBBcGFjaGUtMi4wXG4gKi9cblxuaW1wb3J0IHsgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksIENvbXBvbmVudCwgSW5wdXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IExhbmd1YWdlU2VydmljZSB9IGZyb20gJ0BzcGFydGFjdXMvY29yZSc7XG5pbXBvcnQgeyBDb21tb25Db25maWd1cmF0b3IgfSBmcm9tICdAc3BhcnRhY3VzL3Byb2R1Y3QtY29uZmlndXJhdG9yL2NvbW1vbic7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBDb25maWd1cmF0b3JDb21tb25zU2VydmljZSB9IGZyb20gJy4uLy4uL2NvcmUvZmFjYWRlL2NvbmZpZ3VyYXRvci1jb21tb25zLnNlcnZpY2UnO1xuaW1wb3J0IHsgQ29uZmlndXJhdG9yR3JvdXBzU2VydmljZSB9IGZyb20gJy4uLy4uL2NvcmUvZmFjYWRlL2NvbmZpZ3VyYXRvci1ncm91cHMuc2VydmljZSc7XG5pbXBvcnQgeyBDb25maWd1cmF0b3IgfSBmcm9tICcuLi8uLi9jb3JlL21vZGVsL2NvbmZpZ3VyYXRvci5tb2RlbCc7XG5pbXBvcnQgeyBDb25maWd1cmF0b3JTdG9yZWZyb250VXRpbHNTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZS9jb25maWd1cmF0b3Itc3RvcmVmcm9udC11dGlscy5zZXJ2aWNlJztcbmltcG9ydCB7IENvbmZpZ0Zvcm1VcGRhdGVFdmVudCB9IGZyb20gJy4uL2Zvcm0vY29uZmlndXJhdG9yLWZvcm0uZXZlbnQnO1xuaW1wb3J0IHsgQ29uZmlndXJhdG9yRXhwZXJ0TW9kZVNlcnZpY2UgfSBmcm9tICcuLi8uLi9jb3JlL3NlcnZpY2VzL2NvbmZpZ3VyYXRvci1leHBlcnQtbW9kZS5zZXJ2aWNlJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnY3gtY29uZmlndXJhdG9yLWdyb3VwJyxcbiAgdGVtcGxhdGVVcmw6ICcuL2NvbmZpZ3VyYXRvci1ncm91cC5jb21wb25lbnQuaHRtbCcsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxufSlcbmV4cG9ydCBjbGFzcyBDb25maWd1cmF0b3JHcm91cENvbXBvbmVudCB7XG4gIHByb3RlY3RlZCByZWFkb25seSB0eXBlUHJlZml4ID0gJ0F0dHJpYnV0ZVR5cGVfJztcbiAgQElucHV0KCkgZ3JvdXA6IENvbmZpZ3VyYXRvci5Hcm91cDtcbiAgQElucHV0KCkgb3duZXI6IENvbW1vbkNvbmZpZ3VyYXRvci5Pd25lcjtcbiAgQElucHV0KCkgaXNOYXZpZ2F0aW9uVG9Hcm91cEVuYWJsZWQ6IGJvb2xlYW47XG5cbiAgYWN0aXZlTGFuZ3VhZ2UkOiBPYnNlcnZhYmxlPHN0cmluZz4gPSB0aGlzLmxhbmd1YWdlU2VydmljZS5nZXRBY3RpdmUoKTtcbiAgdWlUeXBlID0gQ29uZmlndXJhdG9yLlVpVHlwZTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcm90ZWN0ZWQgY29uZmlndXJhdG9yQ29tbW9uc1NlcnZpY2U6IENvbmZpZ3VyYXRvckNvbW1vbnNTZXJ2aWNlLFxuICAgIHByb3RlY3RlZCBjb25maWd1cmF0b3JHcm91cHNTZXJ2aWNlOiBDb25maWd1cmF0b3JHcm91cHNTZXJ2aWNlLFxuICAgIHByb3RlY3RlZCBsYW5ndWFnZVNlcnZpY2U6IExhbmd1YWdlU2VydmljZSxcbiAgICBwcm90ZWN0ZWQgY29uZmlnVXRpbHM6IENvbmZpZ3VyYXRvclN0b3JlZnJvbnRVdGlsc1NlcnZpY2UsXG4gICAgcHJvdGVjdGVkIGNvbmZpZ0V4cGVydE1vZGVTZXJ2aWNlOiBDb25maWd1cmF0b3JFeHBlcnRNb2RlU2VydmljZVxuICApIHt9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgYSBjb25maWd1cmF0aW9uLCBzcGVjaWZpZWQgYnkgdGhlIGNvbmZpZ3VyYXRpb24gZm9ybSB1cGRhdGUgZXZlbnQuXG4gICAqXG4gICAqIEBwYXJhbSB7Q29uZmlnRm9ybVVwZGF0ZUV2ZW50fSBldmVudCAtIENvbmZpZ3VyYXRpb24gZm9ybSB1cGRhdGUgZXZlbnRcbiAgICovXG4gIHVwZGF0ZUNvbmZpZ3VyYXRpb24oZXZlbnQ6IENvbmZpZ0Zvcm1VcGRhdGVFdmVudCk6IHZvaWQge1xuICAgIHRoaXMuY29uZmlndXJhdG9yQ29tbW9uc1NlcnZpY2UudXBkYXRlQ29uZmlndXJhdGlvbihcbiAgICAgIGV2ZW50Lm93bmVyS2V5LFxuICAgICAgZXZlbnQuY2hhbmdlZEF0dHJpYnV0ZSxcbiAgICAgIGV2ZW50LnVwZGF0ZVR5cGVcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWVzIHdoZXRoZXIgdGhlIGN1cnJlbnQgZ3JvdXAgdHlwZSBpcyBjb25mbGljdCBvbmUuXG4gICAqXG4gICAqIEBwYXJhbSB7Q29uZmlndXJhdG9yLkdyb3VwVHlwZSB8IHVuZGVmaW5lZH0gZ3JvdXBUeXBlIC0gR3JvdXAgdHlwZVxuICAgKiBAcmV0dXJuIHtib29sZWFufSAtICdUcnVlJyBpZiB0aGUgY3VycmVudCBncm91cCBpcyBjb25mbGljdCBvbmUsIG90aGVyd2lzZSAnZmFsc2UnLlxuICAgKi9cbiAgaXNDb25mbGljdEdyb3VwVHlwZShncm91cFR5cGU6IENvbmZpZ3VyYXRvci5Hcm91cFR5cGUgfCB1bmRlZmluZWQpOiBib29sZWFuIHtcbiAgICByZXR1cm4gZ3JvdXBUeXBlXG4gICAgICA/IHRoaXMuY29uZmlndXJhdG9yR3JvdXBzU2VydmljZS5pc0NvbmZsaWN0R3JvdXBUeXBlKGdyb3VwVHlwZSlcbiAgICAgIDogZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogRGlzcGxheSBncm91cCBkZXNjcmlwdGlvbiBib3ggb25seSBmb3IgY29uZmxpY3QgZ3JvdXBzIHdpdGggYSBnaXZlbiBncm91cCBuYW1lIChpLmUuIGEgY29uZmxpY3QgZGVzY3JpcHRpb24pXG4gICAqXG4gICAqIEBwYXJhbSB7Q29uZmlndXJhdG9yLkdyb3VwfSBncm91cCAtIEdyb3VwXG4gICAqIEByZXR1cm5zIHtib29sZWFufSAtICdUcnVlJyBpZiBjb25mbGljdCBkZXNjcmlwdGlvbiBib3ggc2hvdWxkIGJlIGRpc3BsYXllZCwgb3RoZXJ3aXNlICdmYWxzZScuXG4gICAqL1xuICBkaXNwbGF5Q29uZmxpY3REZXNjcmlwdGlvbihncm91cDogQ29uZmlndXJhdG9yLkdyb3VwKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIChcbiAgICAgIGdyb3VwLmdyb3VwVHlwZSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICB0aGlzLmNvbmZpZ3VyYXRvckdyb3Vwc1NlcnZpY2UuaXNDb25mbGljdEdyb3VwVHlwZShncm91cC5ncm91cFR5cGUpICYmXG4gICAgICBncm91cC5uYW1lICE9PSAnJ1xuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGVzIGEgZ3JvdXAgSUQuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBncm91cElkIC0gZ3JvdXAgSURcbiAgICogQHJldHVybnMge3N0cmluZyB8IHVuZGVmaW5lZH0gLSBnZW5lcmF0ZWQgZ3JvdXAgSURcbiAgICovXG4gIGNyZWF0ZUdyb3VwSWQoZ3JvdXBJZD86IHN0cmluZyk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnVXRpbHMuY3JlYXRlR3JvdXBJZChncm91cElkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZXMgaW5mb3JtYXRpb24gd2hldGhlciB0aGUgZXhwZXJ0IG1vZGUgaXMgYWN0aXZlLlxuICAgKlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZTxib29sZWFuPiB8IHVuZGVmaW5lZCB9IC0gJ1RydWUnIGlmIHRoZSBleHBlcnQgbW9kZSBpcyBhY3RpdmUsIG90aGVyd2lzZSAnZmFsc2UnLlxuICAgKi9cbiAgZ2V0IGV4cE1vZGUoKTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnRXhwZXJ0TW9kZVNlcnZpY2UuZ2V0RXhwTW9kZUFjdGl2ZSgpO1xuICB9XG5cbiAgZ2V0Q29tcG9uZW50S2V5KGF0dHJpYnV0ZTogQ29uZmlndXJhdG9yLkF0dHJpYnV0ZSk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGF0dHJpYnV0ZS51aVR5cGVWYXJpYXRpb24/LmluY2x1ZGVzKFxuICAgICAgQ29uZmlndXJhdG9yLkN1c3RvbVVpVHlwZUluZGljYXRvclxuICAgIClcbiAgICAgID8gdGhpcy50eXBlUHJlZml4ICsgYXR0cmlidXRlLnVpVHlwZVZhcmlhdGlvblxuICAgICAgOiB0aGlzLnR5cGVQcmVmaXggKyBhdHRyaWJ1dGUudWlUeXBlO1xuICB9XG59XG4iLCI8ZGl2IGlkPVwie3sgY3JlYXRlR3JvdXBJZChncm91cC5pZCkgfX1cIiByb2xlPVwidGFicGFuZWxcIj5cbiAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImRpc3BsYXlDb25mbGljdERlc2NyaXB0aW9uKGdyb3VwKVwiPlxuICAgIDxjeC1jb25maWd1cmF0b3ItY29uZmxpY3QtZGVzY3JpcHRpb25cbiAgICAgIFtjdXJyZW50R3JvdXBdPVwiZ3JvdXBcIlxuICAgID48L2N4LWNvbmZpZ3VyYXRvci1jb25mbGljdC1kZXNjcmlwdGlvbj5cbiAgPC9uZy1jb250YWluZXI+XG4gIDxkaXZcbiAgICBjbGFzcz1cImN4LWdyb3VwLWF0dHJpYnV0ZVwiXG4gICAgW2NsYXNzLmN4LWhpZGRlbl09XCIhYXR0cmlidXRlLnZpc2libGVcIlxuICAgICpuZ0Zvcj1cImxldCBhdHRyaWJ1dGUgb2YgZ3JvdXAuYXR0cmlidXRlczsgbGV0IGluZGV4T2ZBdHRyaWJ1dGUgPSBpbmRleFwiXG4gID5cbiAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiaXNDb25mbGljdEdyb3VwVHlwZShncm91cC5ncm91cFR5cGUpXCI+XG4gICAgICA8Y3gtY29uZmlndXJhdG9yLWNvbmZsaWN0LXN1Z2dlc3Rpb25cbiAgICAgICAgW2N1cnJlbnRHcm91cF09XCJncm91cFwiXG4gICAgICAgIFthdHRyaWJ1dGVdPVwiYXR0cmlidXRlXCJcbiAgICAgICAgW3N1Z2dlc3Rpb25OdW1iZXJdPVwiaW5kZXhPZkF0dHJpYnV0ZVwiXG4gICAgICA+PC9jeC1jb25maWd1cmF0b3ItY29uZmxpY3Qtc3VnZ2VzdGlvbj5cbiAgICA8L25nLWNvbnRhaW5lcj5cblxuICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJhY3RpdmVMYW5ndWFnZSQgfCBhc3luYyBhcyBhY3RpdmVMYW5ndWFnZVwiPlxuICAgICAgPGRpdlxuICAgICAgICBbY3hDb25maWd1cmF0b3JBdHRyaWJ1dGVDb21wb25lbnRdPVwie1xuICAgICAgICAgIGNvbXBvbmVudEtleTogJ0hlYWRlcicsXG4gICAgICAgICAgYXR0cmlidXRlOiBhdHRyaWJ1dGUsXG4gICAgICAgICAgb3duZXI6IG93bmVyLFxuICAgICAgICAgIGdyb3VwOiBncm91cCxcbiAgICAgICAgICBsYW5ndWFnZTogYWN0aXZlTGFuZ3VhZ2UsXG4gICAgICAgICAgZXhwTW9kZTogKGV4cE1vZGUgfCBhc3luYykgPz8gZmFsc2UsXG4gICAgICAgICAgaXNOYXZpZ2F0aW9uVG9Hcm91cEVuYWJsZWQ6IGlzTmF2aWdhdGlvblRvR3JvdXBFbmFibGVkXG4gICAgICAgIH1cIlxuICAgICAgPjwvZGl2PlxuXG4gICAgICA8ZGl2XG4gICAgICAgIFtjeENvbmZpZ3VyYXRvckF0dHJpYnV0ZUNvbXBvbmVudF09XCJ7XG4gICAgICAgICAgY29tcG9uZW50S2V5OiBnZXRDb21wb25lbnRLZXkoYXR0cmlidXRlKSxcbiAgICAgICAgICBhdHRyaWJ1dGU6IGF0dHJpYnV0ZSxcbiAgICAgICAgICBvd25lcjogb3duZXIsXG4gICAgICAgICAgZ3JvdXA6IGdyb3VwLFxuICAgICAgICAgIGxhbmd1YWdlOiBhY3RpdmVMYW5ndWFnZSxcbiAgICAgICAgICBleHBNb2RlOiAoZXhwTW9kZSB8IGFzeW5jKSA/PyBmYWxzZVxuICAgICAgICB9XCJcbiAgICAgID48L2Rpdj5cblxuICAgICAgPGRpdlxuICAgICAgICBbY3hDb25maWd1cmF0b3JBdHRyaWJ1dGVDb21wb25lbnRdPVwie1xuICAgICAgICAgIGNvbXBvbmVudEtleTogJ0Zvb3RlcicsXG4gICAgICAgICAgYXR0cmlidXRlOiBhdHRyaWJ1dGUsXG4gICAgICAgICAgb3duZXI6IG93bmVyLFxuICAgICAgICAgIGdyb3VwOiBncm91cCxcbiAgICAgICAgICBsYW5ndWFnZTogYWN0aXZlTGFuZ3VhZ2UsXG4gICAgICAgICAgZXhwTW9kZTogKGV4cE1vZGUgfCBhc3luYykgPz8gZmFsc2VcbiAgICAgICAgfVwiXG4gICAgICA+PC9kaXY+XG4gICAgPC9uZy1jb250YWluZXI+XG4gIDwvZGl2PlxuPC9kaXY+XG4iXX0=