/*
 * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>
 *
 * SPDX-License-Identifier: Apache-2.0
 */
import { ChangeDetectionStrategy, Component, HostBinding, ViewChild, } from '@angular/core';
import { ConfiguratorRouter, } from '@spartacus/product-configurator/common';
import { map, switchMap, take, tap } from 'rxjs/operators';
import * as i0 from "@angular/core";
import * as i1 from "@spartacus/product-configurator/common";
import * as i2 from "../../core/facade/configurator-commons.service";
import * as i3 from "@angular/common";
import * as i4 from "@angular/router";
import * as i5 from "@spartacus/core";
export class ConfiguratorTabBarComponent {
    /**
     * Returns the tabindex for the configuration tab.
     * The configuration tab is excluded from the tab chain if currently the overview page is displayed.
     * @returns tabindex of the configuration tab
     */
    getTabIndexConfigTab() {
        let tabIndex = 0;
        this.isOverviewPage$.pipe(take(1)).subscribe((isOvPage) => {
            if (isOvPage) {
                tabIndex = -1;
            }
        });
        return tabIndex;
    }
    /**
     * Returns the tabindex for the overview tab.
     * The overview tab is excluded from the tab chain if currently the configuration page is displayed.
     * @returns tabindex of the overview tab
     */
    getTabIndexOverviewTab() {
        let tabIndex = 0;
        this.isOverviewPage$.pipe(take(1)).subscribe((isOvPage) => {
            if (!isOvPage) {
                tabIndex = -1;
            }
        });
        return tabIndex;
    }
    /**
     * Switches the focus of the tabs on pressing left or right arrow key.
     * @param {KeyboardEvent} event - Keyboard event
     * @param {string} currentTab - Current tab
     */
    switchTabOnArrowPress(event, currentTab) {
        if (event.code === 'ArrowLeft' || event.code === 'ArrowRight') {
            event.preventDefault();
            if (currentTab === '#configTab') {
                this.overviewTab.nativeElement?.focus();
            }
            else {
                this.configTab.nativeElement?.focus();
            }
        }
    }
    constructor(configRouterExtractorService, configuratorCommonsService) {
        this.configRouterExtractorService = configRouterExtractorService;
        this.configuratorCommonsService = configuratorCommonsService;
        this.ghostStyle = true;
        this.routerData$ = this.configRouterExtractorService.extractRouterData();
        this.configuration$ = this.routerData$.pipe(switchMap((routerData) => this.configuratorCommonsService.getConfiguration(routerData.owner).pipe(tap(() => {
            this.ghostStyle = false;
        }))));
        this.isOverviewPage$ = this.routerData$.pipe(map((routerData) => routerData.pageType === ConfiguratorRouter.PageType.OVERVIEW));
    }
}
ConfiguratorTabBarComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: ConfiguratorTabBarComponent, deps: [{ token: i1.ConfiguratorRouterExtractorService }, { token: i2.ConfiguratorCommonsService }], target: i0.ɵɵFactoryTarget.Component });
ConfiguratorTabBarComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.9", type: ConfiguratorTabBarComponent, selector: "cx-configurator-tab-bar", host: { properties: { "class.ghost": "this.ghostStyle" } }, viewQueries: [{ propertyName: "configTab", first: true, predicate: ["configTab"], descendants: true }, { propertyName: "overviewTab", first: true, predicate: ["overviewTab"], descendants: true }], ngImport: i0, template: "<ng-container *ngIf=\"routerData$ | async as routerData\">\n  <ng-container *ngIf=\"configuration$ | async; else ghostTabBar\">\n    <ng-container *ngIf=\"!routerData.displayOnly\">\n      <div class=\"cx-tab-bar\" role=\"tablist\">\n        <a\n          #configTab\n          [tabindex]=\"getTabIndexConfigTab()\"\n          role=\"tab\"\n          [class.active]=\"!(isOverviewPage$ | async)\"\n          [attr.aria-selected]=\"!(isOverviewPage$ | async)\"\n          (keydown)=\"switchTabOnArrowPress($event, '#configTab')\"\n          [routerLink]=\"\n            {\n              cxRoute: 'configure' + routerData.owner.configuratorType,\n              params: {\n                entityKey: routerData.owner.id,\n                ownerType: routerData.owner.type\n              }\n            } | cxUrl\n          \"\n          [attr.aria-label]=\"\n            !(isOverviewPage$ | async)\n              ? ('configurator.a11y.configurationPage' | cxTranslate)\n              : ('configurator.a11y.configurationPageLink' | cxTranslate)\n          \"\n          >{{ 'configurator.tabBar.configuration' | cxTranslate }}</a\n        >\n        <a\n          #overviewTab\n          [tabindex]=\"getTabIndexOverviewTab()\"\n          role=\"tab\"\n          [class.active]=\"isOverviewPage$ | async\"\n          [attr.aria-selected]=\"isOverviewPage$ | async\"\n          (keydown)=\"switchTabOnArrowPress($event, '#overviewTab')\"\n          [routerLink]=\"\n            {\n              cxRoute: 'configureOverview' + routerData.owner.configuratorType,\n              params: {\n                entityKey: routerData.owner.id,\n                ownerType: routerData.owner.type\n              }\n            } | cxUrl\n          \"\n          [attr.aria-label]=\"\n            (isOverviewPage$ | async)\n              ? ('configurator.a11y.overviewPage' | cxTranslate)\n              : ('configurator.a11y.overviewPageLink' | cxTranslate)\n          \"\n          >{{ 'configurator.tabBar.overview' | cxTranslate }}</a\n        >\n      </div>\n    </ng-container>\n  </ng-container>\n  <ng-template #ghostTabBar>\n    <div class=\"cx-ghost-tab-bar\"></div>\n  </ng-template>\n</ng-container>\n", dependencies: [{ kind: "directive", type: i3.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i4.RouterLink, selector: "[routerLink]", inputs: ["target", "queryParams", "fragment", "queryParamsHandling", "state", "relativeTo", "preserveFragment", "skipLocationChange", "replaceUrl", "routerLink"] }, { kind: "pipe", type: i3.AsyncPipe, name: "async" }, { kind: "pipe", type: i5.TranslatePipe, name: "cxTranslate" }, { kind: "pipe", type: i5.UrlPipe, name: "cxUrl" }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: ConfiguratorTabBarComponent, decorators: [{
            type: Component,
            args: [{ selector: 'cx-configurator-tab-bar', changeDetection: ChangeDetectionStrategy.OnPush, template: "<ng-container *ngIf=\"routerData$ | async as routerData\">\n  <ng-container *ngIf=\"configuration$ | async; else ghostTabBar\">\n    <ng-container *ngIf=\"!routerData.displayOnly\">\n      <div class=\"cx-tab-bar\" role=\"tablist\">\n        <a\n          #configTab\n          [tabindex]=\"getTabIndexConfigTab()\"\n          role=\"tab\"\n          [class.active]=\"!(isOverviewPage$ | async)\"\n          [attr.aria-selected]=\"!(isOverviewPage$ | async)\"\n          (keydown)=\"switchTabOnArrowPress($event, '#configTab')\"\n          [routerLink]=\"\n            {\n              cxRoute: 'configure' + routerData.owner.configuratorType,\n              params: {\n                entityKey: routerData.owner.id,\n                ownerType: routerData.owner.type\n              }\n            } | cxUrl\n          \"\n          [attr.aria-label]=\"\n            !(isOverviewPage$ | async)\n              ? ('configurator.a11y.configurationPage' | cxTranslate)\n              : ('configurator.a11y.configurationPageLink' | cxTranslate)\n          \"\n          >{{ 'configurator.tabBar.configuration' | cxTranslate }}</a\n        >\n        <a\n          #overviewTab\n          [tabindex]=\"getTabIndexOverviewTab()\"\n          role=\"tab\"\n          [class.active]=\"isOverviewPage$ | async\"\n          [attr.aria-selected]=\"isOverviewPage$ | async\"\n          (keydown)=\"switchTabOnArrowPress($event, '#overviewTab')\"\n          [routerLink]=\"\n            {\n              cxRoute: 'configureOverview' + routerData.owner.configuratorType,\n              params: {\n                entityKey: routerData.owner.id,\n                ownerType: routerData.owner.type\n              }\n            } | cxUrl\n          \"\n          [attr.aria-label]=\"\n            (isOverviewPage$ | async)\n              ? ('configurator.a11y.overviewPage' | cxTranslate)\n              : ('configurator.a11y.overviewPageLink' | cxTranslate)\n          \"\n          >{{ 'configurator.tabBar.overview' | cxTranslate }}</a\n        >\n      </div>\n    </ng-container>\n  </ng-container>\n  <ng-template #ghostTabBar>\n    <div class=\"cx-ghost-tab-bar\"></div>\n  </ng-template>\n</ng-container>\n" }]
        }], ctorParameters: function () { return [{ type: i1.ConfiguratorRouterExtractorService }, { type: i2.ConfiguratorCommonsService }]; }, propDecorators: { ghostStyle: [{
                type: HostBinding,
                args: ['class.ghost']
            }], configTab: [{
                type: ViewChild,
                args: ['configTab']
            }], overviewTab: [{
                type: ViewChild,
                args: ['overviewTab']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZmlndXJhdG9yLXRhYi1iYXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vZmVhdHVyZS1saWJzL3Byb2R1Y3QtY29uZmlndXJhdG9yL3J1bGViYXNlZC9jb21wb25lbnRzL3RhYi1iYXIvY29uZmlndXJhdG9yLXRhYi1iYXIuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vZmVhdHVyZS1saWJzL3Byb2R1Y3QtY29uZmlndXJhdG9yL3J1bGViYXNlZC9jb21wb25lbnRzL3RhYi1iYXIvY29uZmlndXJhdG9yLXRhYi1iYXIuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7R0FJRztBQUVILE9BQU8sRUFDTCx1QkFBdUIsRUFDdkIsU0FBUyxFQUNULFdBQVcsRUFDWCxTQUFTLEdBRVYsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUNMLGtCQUFrQixHQUVuQixNQUFNLHdDQUF3QyxDQUFDO0FBR2hELE9BQU8sRUFBRSxHQUFHLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQzs7Ozs7OztBQVMzRCxNQUFNLE9BQU8sMkJBQTJCO0lBMEJ0Qzs7OztPQUlHO0lBQ0gsb0JBQW9CO1FBQ2xCLElBQUksUUFBUSxHQUFHLENBQUMsQ0FBQztRQUNqQixJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxRQUFRLEVBQUUsRUFBRTtZQUN4RCxJQUFJLFFBQVEsRUFBRTtnQkFDWixRQUFRLEdBQUcsQ0FBQyxDQUFDLENBQUM7YUFDZjtRQUNILENBQUMsQ0FBQyxDQUFDO1FBQ0gsT0FBTyxRQUFRLENBQUM7SUFDbEIsQ0FBQztJQUVEOzs7O09BSUc7SUFDSCxzQkFBc0I7UUFDcEIsSUFBSSxRQUFRLEdBQUcsQ0FBQyxDQUFDO1FBQ2pCLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxFQUFFO1lBQ3hELElBQUksQ0FBQyxRQUFRLEVBQUU7Z0JBQ2IsUUFBUSxHQUFHLENBQUMsQ0FBQyxDQUFDO2FBQ2Y7UUFDSCxDQUFDLENBQUMsQ0FBQztRQUNILE9BQU8sUUFBUSxDQUFDO0lBQ2xCLENBQUM7SUFFRDs7OztPQUlHO0lBQ0gscUJBQXFCLENBQUMsS0FBb0IsRUFBRSxVQUFrQjtRQUM1RCxJQUFJLEtBQUssQ0FBQyxJQUFJLEtBQUssV0FBVyxJQUFJLEtBQUssQ0FBQyxJQUFJLEtBQUssWUFBWSxFQUFFO1lBQzdELEtBQUssQ0FBQyxjQUFjLEVBQUUsQ0FBQztZQUN2QixJQUFJLFVBQVUsS0FBSyxZQUFZLEVBQUU7Z0JBQy9CLElBQUksQ0FBQyxXQUFXLENBQUMsYUFBYSxFQUFFLEtBQUssRUFBRSxDQUFDO2FBQ3pDO2lCQUFNO2dCQUNMLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxFQUFFLEtBQUssRUFBRSxDQUFDO2FBQ3ZDO1NBQ0Y7SUFDSCxDQUFDO0lBRUQsWUFDWSw0QkFBZ0UsRUFDaEUsMEJBQXNEO1FBRHRELGlDQUE0QixHQUE1Qiw0QkFBNEIsQ0FBb0M7UUFDaEUsK0JBQTBCLEdBQTFCLDBCQUEwQixDQUE0QjtRQXpFdEMsZUFBVSxHQUFHLElBQUksQ0FBQztRQUk5QyxnQkFBVyxHQUNULElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1FBRXhELG1CQUFjLEdBQ1osSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQ25CLFNBQVMsQ0FBQyxDQUFDLFVBQVUsRUFBRSxFQUFFLENBQ3ZCLElBQUksQ0FBQywwQkFBMEIsQ0FBQyxnQkFBZ0IsQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUNyRSxHQUFHLENBQUMsR0FBRyxFQUFFO1lBQ1AsSUFBSSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7UUFDMUIsQ0FBQyxDQUFDLENBQ0gsQ0FDRixDQUNGLENBQUM7UUFFSixvQkFBZSxHQUF3QixJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FDMUQsR0FBRyxDQUNELENBQUMsVUFBVSxFQUFFLEVBQUUsQ0FDYixVQUFVLENBQUMsUUFBUSxLQUFLLGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQy9ELENBQ0YsQ0FBQztJQW1EQyxDQUFDOzt3SEEzRU8sMkJBQTJCOzRHQUEzQiwyQkFBMkIsZ1VDNUJ4QyxxcEVBeURBOzJGRDdCYSwyQkFBMkI7a0JBTHZDLFNBQVM7K0JBQ0UseUJBQXlCLG1CQUVsQix1QkFBdUIsQ0FBQyxNQUFNO2tLQUduQixVQUFVO3NCQUFyQyxXQUFXO3VCQUFDLGFBQWE7Z0JBQ0YsU0FBUztzQkFBaEMsU0FBUzt1QkFBQyxXQUFXO2dCQUNJLFdBQVc7c0JBQXBDLFNBQVM7dUJBQUMsYUFBYSIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBTUERYLUZpbGVDb3B5cmlnaHRUZXh0OiAyMDIzIFNBUCBTcGFydGFjdXMgdGVhbSA8c3BhcnRhY3VzLXRlYW1Ac2FwLmNvbT5cbiAqXG4gKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogQXBhY2hlLTIuMFxuICovXG5cbmltcG9ydCB7XG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICBDb21wb25lbnQsXG4gIEhvc3RCaW5kaW5nLFxuICBWaWV3Q2hpbGQsXG4gIEVsZW1lbnRSZWYsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtcbiAgQ29uZmlndXJhdG9yUm91dGVyLFxuICBDb25maWd1cmF0b3JSb3V0ZXJFeHRyYWN0b3JTZXJ2aWNlLFxufSBmcm9tICdAc3BhcnRhY3VzL3Byb2R1Y3QtY29uZmlndXJhdG9yL2NvbW1vbic7XG5pbXBvcnQge30gZnJvbSAnQHNwYXJ0YWN1cy9zdG9yZWZyb250JztcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IG1hcCwgc3dpdGNoTWFwLCB0YWtlLCB0YXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBDb25maWd1cmF0b3JDb21tb25zU2VydmljZSB9IGZyb20gJy4uLy4uL2NvcmUvZmFjYWRlL2NvbmZpZ3VyYXRvci1jb21tb25zLnNlcnZpY2UnO1xuaW1wb3J0IHsgQ29uZmlndXJhdG9yIH0gZnJvbSAnLi4vLi4vY29yZS9tb2RlbC9jb25maWd1cmF0b3IubW9kZWwnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdjeC1jb25maWd1cmF0b3ItdGFiLWJhcicsXG4gIHRlbXBsYXRlVXJsOiAnLi9jb25maWd1cmF0b3ItdGFiLWJhci5jb21wb25lbnQuaHRtbCcsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxufSlcbmV4cG9ydCBjbGFzcyBDb25maWd1cmF0b3JUYWJCYXJDb21wb25lbnQge1xuICBASG9zdEJpbmRpbmcoJ2NsYXNzLmdob3N0JykgZ2hvc3RTdHlsZSA9IHRydWU7XG4gIEBWaWV3Q2hpbGQoJ2NvbmZpZ1RhYicpIGNvbmZpZ1RhYjogRWxlbWVudFJlZjxIVE1MRWxlbWVudD47XG4gIEBWaWV3Q2hpbGQoJ292ZXJ2aWV3VGFiJykgb3ZlcnZpZXdUYWI6IEVsZW1lbnRSZWY8SFRNTEVsZW1lbnQ+O1xuXG4gIHJvdXRlckRhdGEkOiBPYnNlcnZhYmxlPENvbmZpZ3VyYXRvclJvdXRlci5EYXRhPiA9XG4gICAgdGhpcy5jb25maWdSb3V0ZXJFeHRyYWN0b3JTZXJ2aWNlLmV4dHJhY3RSb3V0ZXJEYXRhKCk7XG5cbiAgY29uZmlndXJhdGlvbiQ6IE9ic2VydmFibGU8Q29uZmlndXJhdG9yLkNvbmZpZ3VyYXRpb24+ID1cbiAgICB0aGlzLnJvdXRlckRhdGEkLnBpcGUoXG4gICAgICBzd2l0Y2hNYXAoKHJvdXRlckRhdGEpID0+XG4gICAgICAgIHRoaXMuY29uZmlndXJhdG9yQ29tbW9uc1NlcnZpY2UuZ2V0Q29uZmlndXJhdGlvbihyb3V0ZXJEYXRhLm93bmVyKS5waXBlKFxuICAgICAgICAgIHRhcCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmdob3N0U3R5bGUgPSBmYWxzZTtcbiAgICAgICAgICB9KVxuICAgICAgICApXG4gICAgICApXG4gICAgKTtcblxuICBpc092ZXJ2aWV3UGFnZSQ6IE9ic2VydmFibGU8Ym9vbGVhbj4gPSB0aGlzLnJvdXRlckRhdGEkLnBpcGUoXG4gICAgbWFwKFxuICAgICAgKHJvdXRlckRhdGEpID0+XG4gICAgICAgIHJvdXRlckRhdGEucGFnZVR5cGUgPT09IENvbmZpZ3VyYXRvclJvdXRlci5QYWdlVHlwZS5PVkVSVklFV1xuICAgIClcbiAgKTtcblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgdGFiaW5kZXggZm9yIHRoZSBjb25maWd1cmF0aW9uIHRhYi5cbiAgICogVGhlIGNvbmZpZ3VyYXRpb24gdGFiIGlzIGV4Y2x1ZGVkIGZyb20gdGhlIHRhYiBjaGFpbiBpZiBjdXJyZW50bHkgdGhlIG92ZXJ2aWV3IHBhZ2UgaXMgZGlzcGxheWVkLlxuICAgKiBAcmV0dXJucyB0YWJpbmRleCBvZiB0aGUgY29uZmlndXJhdGlvbiB0YWJcbiAgICovXG4gIGdldFRhYkluZGV4Q29uZmlnVGFiKCk6IG51bWJlciB7XG4gICAgbGV0IHRhYkluZGV4ID0gMDtcbiAgICB0aGlzLmlzT3ZlcnZpZXdQYWdlJC5waXBlKHRha2UoMSkpLnN1YnNjcmliZSgoaXNPdlBhZ2UpID0+IHtcbiAgICAgIGlmIChpc092UGFnZSkge1xuICAgICAgICB0YWJJbmRleCA9IC0xO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB0YWJJbmRleDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSB0YWJpbmRleCBmb3IgdGhlIG92ZXJ2aWV3IHRhYi5cbiAgICogVGhlIG92ZXJ2aWV3IHRhYiBpcyBleGNsdWRlZCBmcm9tIHRoZSB0YWIgY2hhaW4gaWYgY3VycmVudGx5IHRoZSBjb25maWd1cmF0aW9uIHBhZ2UgaXMgZGlzcGxheWVkLlxuICAgKiBAcmV0dXJucyB0YWJpbmRleCBvZiB0aGUgb3ZlcnZpZXcgdGFiXG4gICAqL1xuICBnZXRUYWJJbmRleE92ZXJ2aWV3VGFiKCk6IG51bWJlciB7XG4gICAgbGV0IHRhYkluZGV4ID0gMDtcbiAgICB0aGlzLmlzT3ZlcnZpZXdQYWdlJC5waXBlKHRha2UoMSkpLnN1YnNjcmliZSgoaXNPdlBhZ2UpID0+IHtcbiAgICAgIGlmICghaXNPdlBhZ2UpIHtcbiAgICAgICAgdGFiSW5kZXggPSAtMTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gdGFiSW5kZXg7XG4gIH1cblxuICAvKipcbiAgICogU3dpdGNoZXMgdGhlIGZvY3VzIG9mIHRoZSB0YWJzIG9uIHByZXNzaW5nIGxlZnQgb3IgcmlnaHQgYXJyb3cga2V5LlxuICAgKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGV2ZW50IC0gS2V5Ym9hcmQgZXZlbnRcbiAgICogQHBhcmFtIHtzdHJpbmd9IGN1cnJlbnRUYWIgLSBDdXJyZW50IHRhYlxuICAgKi9cbiAgc3dpdGNoVGFiT25BcnJvd1ByZXNzKGV2ZW50OiBLZXlib2FyZEV2ZW50LCBjdXJyZW50VGFiOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBpZiAoZXZlbnQuY29kZSA9PT0gJ0Fycm93TGVmdCcgfHwgZXZlbnQuY29kZSA9PT0gJ0Fycm93UmlnaHQnKSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgaWYgKGN1cnJlbnRUYWIgPT09ICcjY29uZmlnVGFiJykge1xuICAgICAgICB0aGlzLm92ZXJ2aWV3VGFiLm5hdGl2ZUVsZW1lbnQ/LmZvY3VzKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmNvbmZpZ1RhYi5uYXRpdmVFbGVtZW50Py5mb2N1cygpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByb3RlY3RlZCBjb25maWdSb3V0ZXJFeHRyYWN0b3JTZXJ2aWNlOiBDb25maWd1cmF0b3JSb3V0ZXJFeHRyYWN0b3JTZXJ2aWNlLFxuICAgIHByb3RlY3RlZCBjb25maWd1cmF0b3JDb21tb25zU2VydmljZTogQ29uZmlndXJhdG9yQ29tbW9uc1NlcnZpY2VcbiAgKSB7fVxufVxuIiwiPG5nLWNvbnRhaW5lciAqbmdJZj1cInJvdXRlckRhdGEkIHwgYXN5bmMgYXMgcm91dGVyRGF0YVwiPlxuICA8bmctY29udGFpbmVyICpuZ0lmPVwiY29uZmlndXJhdGlvbiQgfCBhc3luYzsgZWxzZSBnaG9zdFRhYkJhclwiPlxuICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCIhcm91dGVyRGF0YS5kaXNwbGF5T25seVwiPlxuICAgICAgPGRpdiBjbGFzcz1cImN4LXRhYi1iYXJcIiByb2xlPVwidGFibGlzdFwiPlxuICAgICAgICA8YVxuICAgICAgICAgICNjb25maWdUYWJcbiAgICAgICAgICBbdGFiaW5kZXhdPVwiZ2V0VGFiSW5kZXhDb25maWdUYWIoKVwiXG4gICAgICAgICAgcm9sZT1cInRhYlwiXG4gICAgICAgICAgW2NsYXNzLmFjdGl2ZV09XCIhKGlzT3ZlcnZpZXdQYWdlJCB8IGFzeW5jKVwiXG4gICAgICAgICAgW2F0dHIuYXJpYS1zZWxlY3RlZF09XCIhKGlzT3ZlcnZpZXdQYWdlJCB8IGFzeW5jKVwiXG4gICAgICAgICAgKGtleWRvd24pPVwic3dpdGNoVGFiT25BcnJvd1ByZXNzKCRldmVudCwgJyNjb25maWdUYWInKVwiXG4gICAgICAgICAgW3JvdXRlckxpbmtdPVwiXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGN4Um91dGU6ICdjb25maWd1cmUnICsgcm91dGVyRGF0YS5vd25lci5jb25maWd1cmF0b3JUeXBlLFxuICAgICAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgICAgICBlbnRpdHlLZXk6IHJvdXRlckRhdGEub3duZXIuaWQsXG4gICAgICAgICAgICAgICAgb3duZXJUeXBlOiByb3V0ZXJEYXRhLm93bmVyLnR5cGVcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB8IGN4VXJsXG4gICAgICAgICAgXCJcbiAgICAgICAgICBbYXR0ci5hcmlhLWxhYmVsXT1cIlxuICAgICAgICAgICAgIShpc092ZXJ2aWV3UGFnZSQgfCBhc3luYylcbiAgICAgICAgICAgICAgPyAoJ2NvbmZpZ3VyYXRvci5hMTF5LmNvbmZpZ3VyYXRpb25QYWdlJyB8IGN4VHJhbnNsYXRlKVxuICAgICAgICAgICAgICA6ICgnY29uZmlndXJhdG9yLmExMXkuY29uZmlndXJhdGlvblBhZ2VMaW5rJyB8IGN4VHJhbnNsYXRlKVxuICAgICAgICAgIFwiXG4gICAgICAgICAgPnt7ICdjb25maWd1cmF0b3IudGFiQmFyLmNvbmZpZ3VyYXRpb24nIHwgY3hUcmFuc2xhdGUgfX08L2FcbiAgICAgICAgPlxuICAgICAgICA8YVxuICAgICAgICAgICNvdmVydmlld1RhYlxuICAgICAgICAgIFt0YWJpbmRleF09XCJnZXRUYWJJbmRleE92ZXJ2aWV3VGFiKClcIlxuICAgICAgICAgIHJvbGU9XCJ0YWJcIlxuICAgICAgICAgIFtjbGFzcy5hY3RpdmVdPVwiaXNPdmVydmlld1BhZ2UkIHwgYXN5bmNcIlxuICAgICAgICAgIFthdHRyLmFyaWEtc2VsZWN0ZWRdPVwiaXNPdmVydmlld1BhZ2UkIHwgYXN5bmNcIlxuICAgICAgICAgIChrZXlkb3duKT1cInN3aXRjaFRhYk9uQXJyb3dQcmVzcygkZXZlbnQsICcjb3ZlcnZpZXdUYWInKVwiXG4gICAgICAgICAgW3JvdXRlckxpbmtdPVwiXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGN4Um91dGU6ICdjb25maWd1cmVPdmVydmlldycgKyByb3V0ZXJEYXRhLm93bmVyLmNvbmZpZ3VyYXRvclR5cGUsXG4gICAgICAgICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgICAgIGVudGl0eUtleTogcm91dGVyRGF0YS5vd25lci5pZCxcbiAgICAgICAgICAgICAgICBvd25lclR5cGU6IHJvdXRlckRhdGEub3duZXIudHlwZVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IHwgY3hVcmxcbiAgICAgICAgICBcIlxuICAgICAgICAgIFthdHRyLmFyaWEtbGFiZWxdPVwiXG4gICAgICAgICAgICAoaXNPdmVydmlld1BhZ2UkIHwgYXN5bmMpXG4gICAgICAgICAgICAgID8gKCdjb25maWd1cmF0b3IuYTExeS5vdmVydmlld1BhZ2UnIHwgY3hUcmFuc2xhdGUpXG4gICAgICAgICAgICAgIDogKCdjb25maWd1cmF0b3IuYTExeS5vdmVydmlld1BhZ2VMaW5rJyB8IGN4VHJhbnNsYXRlKVxuICAgICAgICAgIFwiXG4gICAgICAgICAgPnt7ICdjb25maWd1cmF0b3IudGFiQmFyLm92ZXJ2aWV3JyB8IGN4VHJhbnNsYXRlIH19PC9hXG4gICAgICAgID5cbiAgICAgIDwvZGl2PlxuICAgIDwvbmctY29udGFpbmVyPlxuICA8L25nLWNvbnRhaW5lcj5cbiAgPG5nLXRlbXBsYXRlICNnaG9zdFRhYkJhcj5cbiAgICA8ZGl2IGNsYXNzPVwiY3gtZ2hvc3QtdGFiLWJhclwiPjwvZGl2PlxuICA8L25nLXRlbXBsYXRlPlxuPC9uZy1jb250YWluZXI+XG4iXX0=