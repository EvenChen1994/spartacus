/*
 * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>
 *
 * SPDX-License-Identifier: Apache-2.0
 */
import { Component, Input, inject } from '@angular/core';
import { FormControl, FormGroup, Validators } from '@angular/forms';
import { MAX_ENTRIES_FOR_ATTACHMENT, } from '@spartacus/customer-ticketing/root';
import { FormUtils } from '@spartacus/storefront';
import { of } from 'rxjs';
import { CustomerTicketingDialogComponent } from '../../../shared/customer-ticketing-dialog/customer-ticketing-dialog.component';
import { GlobalMessageService, GlobalMessageType, HttpErrorModel, TranslationService, } from '@spartacus/core';
import { catchError, first } from 'rxjs/operators';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "@spartacus/storefront";
import * as i3 from "@angular/forms";
import * as i4 from "@spartacus/core";
export class CustomerTicketingCreateDialogComponent extends CustomerTicketingDialogComponent {
    constructor() {
        super(...arguments);
        this.ticketCategories$ = this.customerTicketingFacade.getTicketCategories();
        this.ticketAssociatedObjects$ = this.customerTicketingFacade.getTicketAssociatedObjects().pipe(catchError((error) => {
            this.handleError(error);
            return of([]);
        }));
        this.globalMessage = inject(GlobalMessageService);
        this.translationService = inject(TranslationService);
    }
    getCreateTicketPayload(form) {
        return {
            message: form?.get('message')?.value,
            subject: form?.get('subject')?.value,
            associatedTo: form?.get('associatedTo')?.value || undefined,
            ticketCategory: form?.get('ticketCategory')?.value,
        };
    }
    ngOnInit() {
        this.buildForm();
    }
    buildForm() {
        const form = new FormGroup({});
        form.setControl('subject', new FormControl('', [
            Validators.required,
            Validators.maxLength(this.inputCharactersForSubject),
        ]));
        form.setControl('ticketCategory', new FormControl('', [Validators.required]));
        form.setControl('associatedTo', new FormControl(''));
        form.setControl('message', new FormControl('', [
            Validators.required,
            Validators.maxLength(this.inputCharactersLimit),
        ]));
        form.setControl('file', new FormControl('', [
            this.filesFormValidators.maxSize(this.maxSize),
            this.filesFormValidators.maxEntries(MAX_ENTRIES_FOR_ATTACHMENT),
            this.filesFormValidators.allowedTypes(this.allowedTypes),
        ]));
        this.form = form;
    }
    createTicketRequest() {
        this.attachment = this.form.get('file')?.value?.[0];
        if (this.form.invalid) {
            this.form.markAllAsTouched();
            FormUtils.deepUpdateValueAndValidity(this.form);
        }
        else {
            this.subscription = this.customerTicketingFacade
                .createTicket(this.getCreateTicketPayload(this.form))
                .subscribe({
                next: (response) => {
                    if (response.id &&
                        this.attachment &&
                        response.ticketEvents?.[0].code) {
                        this.customerTicketingFacade.uploadAttachment(this.attachment, response.ticketEvents?.[0].code, response.id);
                    }
                },
                complete: () => {
                    this.onComplete();
                },
                error: (error) => {
                    this.handleError(error);
                },
            });
        }
    }
    handleError(error) {
        if (error instanceof HttpErrorModel) {
            (error.details ?? []).forEach((err) => {
                if (err.message) {
                    this.globalMessage.add({ raw: err.message }, GlobalMessageType.MSG_TYPE_ERROR);
                }
            });
        }
        else {
            this.translationService
                .translate('httpHandlers.unknownError')
                .pipe(first())
                .subscribe((text) => {
                this.globalMessage.add({ raw: text }, GlobalMessageType.MSG_TYPE_ERROR);
            });
        }
        this.onError();
    }
    onComplete() {
        this.close('Ticket created successfully');
    }
    onError() {
        this.close('Something went wrong');
    }
    ngOnDestroy() {
        if (this.subscription) {
            this.subscription.unsubscribe();
        }
    }
}
CustomerTicketingCreateDialogComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: CustomerTicketingCreateDialogComponent, deps: null, target: i0.ɵɵFactoryTarget.Component });
CustomerTicketingCreateDialogComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.9", type: CustomerTicketingCreateDialogComponent, selector: "cx-customer-ticketing-create-dialog", inputs: { selectedCategory: "selectedCategory", selectedAssociatedObject: "selectedAssociatedObject" }, usesInheritance: true, ngImport: i0, template: "<div\n  [cxFocus]=\"focusConfig\"\n  (esc)=\"close('Escape clicked')\"\n  class=\"cx-customer-ticket-form-dialog\"\n>\n  <form [formGroup]=\"form\" class=\"cx-customer-ticket-form-container\">\n    <div class=\"modal-header cx-customer-ticket-form-header\">\n      <div class=\"cx-customer-ticket-form-title modal-title\">\n        {{ 'createCustomerTicket.addNewRequest' | cxTranslate }}\n      </div>\n      <button\n        (click)=\"close('Close Create Request Dialog')\"\n        [attr.aria-label]=\"'common.close' | cxTranslate\"\n        class=\"cx-customer-ticket-form-close close\"\n        type=\"button\"\n      >\n        <span aria-hidden=\"true\">\n          <cx-icon [type]=\"iconTypes.CLOSE\"></cx-icon>\n        </span>\n      </button>\n    </div>\n\n    <div class=\"cx-customer-ticket-form-body\">\n      <div class=\"cx-customer-ticket-form-row\">\n        <label>\n          <span class=\"cx-customer-ticket-label label-content\">\n            {{ 'createCustomerTicket.subject' | cxTranslate }}\n          </span>\n          <textarea\n            [maxLength]=\"inputCharactersForSubject\"\n            class=\"form-control\"\n            formControlName=\"subject\"\n            rows=\"1\"\n          ></textarea>\n\n          <cx-form-errors [control]=\"form.get('subject')\"></cx-form-errors>\n          <p class=\"cx-customer-ticket-input-hint\">\n            {{\n              'customerTicketing.charactersLeft'\n                | cxTranslate: { count: subjectCharacterLeft }\n            }}\n          </p>\n        </label>\n\n        <label *ngIf=\"ticketCategories$ | async as ticketCategories\">\n          <span class=\"cx-customer-ticket-label label-content\">\n            {{ 'createCustomerTicket.category' | cxTranslate }}\n          </span>\n          <select class=\"form-control\" formControlName=\"ticketCategory\">\n            <option value=\"\" disabled selected>\n              {{ 'createCustomerTicket.selectCategory' | cxTranslate }}\n            </option>\n            <option\n              *ngFor=\"let category of ticketCategories\"\n              [ngValue]=\"category\"\n              [selected]=\"category.id === selectedCategory?.id\"\n            >\n              {{ category.name }}\n            </option>\n          </select>\n\n          <cx-form-errors\n            [control]=\"form.get('ticketCategory')\"\n          ></cx-form-errors>\n        </label>\n\n        <ng-container\n          *ngIf=\"ticketAssociatedObjects$ | async as ticketAssociatedObjects\"\n        >\n          <label *ngIf=\"ticketAssociatedObjects.length > 0\">\n            <span class=\"cx-customer-ticket-label label-content\">\n              {{ 'createCustomerTicket.associateTo' | cxTranslate }}\n            </span>\n            <select class=\"form-control\" formControlName=\"associatedTo\">\n              <option value=\"\" disabled selected>\n                {{\n                  'createCustomerTicket.optionallySelectAssociatedObject'\n                    | cxTranslate\n                }}\n              </option>\n              <option\n                *ngFor=\"let associatedObject of ticketAssociatedObjects\"\n                [ngValue]=\"associatedObject\"\n                [selected]=\"\n                  associatedObject.code === selectedAssociatedObject?.code\n                \"\n              >\n                {{ associatedObject.type }}\n                {{ associatedObject.code }}\n              </option>\n            </select>\n          </label>\n        </ng-container>\n\n        <label>\n          <span class=\"cx-customer-ticket-label label-content\">\n            {{ 'customerTicketing.message' | cxTranslate }}\n          </span>\n          <textarea\n            [maxLength]=\"inputCharactersLimit\"\n            class=\"form-control\"\n            formControlName=\"message\"\n            rows=\"5\"\n          ></textarea>\n\n          <cx-form-errors [control]=\"form.get('message')\"></cx-form-errors>\n\n          <p class=\"cx-customer-ticket-input-hint\">\n            {{\n              'customerTicketing.charactersLeft'\n                | cxTranslate: { count: messagesCharacterLeft }\n            }}\n          </p>\n        </label>\n\n        <div>\n          <cx-file-upload\n            [formControl]=\"$any(form.get('file'))\"\n            [accept]=\"allowedTypes\"\n          >\n            <ng-template>\n              <cx-icon [type]=\"iconTypes.UPLOAD\"></cx-icon>\n              <span class=\"cx-message-footer-text\">{{\n                'customerTicketing.uploadFile' | cxTranslate\n              }}</span>\n            </ng-template>\n          </cx-file-upload>\n\n          <p class=\"cx-customer-ticket-file-upload-hint\">\n            {{\n              'customerTicketing.fileSizeLimit'\n                | cxTranslate: { count: maxSize }\n            }}\n          </p>\n          <p class=\"cx-customer-ticket-file-upload-hint\">\n            {{ 'customerTicketing.maximumAttachment' | cxTranslate }}\n          </p>\n\n          <cx-form-errors\n            [control]=\"form.get('file')\"\n            prefix=\"formErrors.file\"\n          ></cx-form-errors>\n        </div>\n      </div>\n\n      <div class=\"cx-customer-ticket-form-footer\">\n        <button\n          (click)=\"close('Close Create Request Dialog')\"\n          class=\"btn btn-secondary\"\n          type=\"button\"\n        >\n          {{ 'customerTicketing.cancel' | cxTranslate }}\n        </button>\n        <button\n          (click)=\"createTicketRequest()\"\n          class=\"btn btn-primary\"\n          type=\"button\"\n        >\n          {{ 'customerTicketing.submit' | cxTranslate }}\n        </button>\n      </div>\n    </div>\n  </form>\n</div>\n", dependencies: [{ kind: "directive", type: i1.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "component", type: i2.IconComponent, selector: "cx-icon,[cxIcon]", inputs: ["cxIcon", "type"] }, { kind: "directive", type: i2.FocusDirective, selector: "[cxFocus]", inputs: ["cxFocus"] }, { kind: "directive", type: i3.ɵNgNoValidate, selector: "form:not([ngNoForm]):not([ngNativeValidate])" }, { kind: "directive", type: i3.NgSelectOption, selector: "option", inputs: ["ngValue", "value"] }, { kind: "directive", type: i3.ɵNgSelectMultipleOption, selector: "option", inputs: ["ngValue", "value"] }, { kind: "directive", type: i3.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { kind: "directive", type: i3.SelectControlValueAccessor, selector: "select:not([multiple])[formControlName],select:not([multiple])[formControl],select:not([multiple])[ngModel]", inputs: ["compareWith"] }, { kind: "directive", type: i3.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i3.NgControlStatusGroup, selector: "[formGroupName],[formArrayName],[ngModelGroup],[formGroup],form:not([ngNoForm]),[ngForm]" }, { kind: "directive", type: i3.FormControlDirective, selector: "[formControl]", inputs: ["formControl", "disabled", "ngModel"], outputs: ["ngModelChange"], exportAs: ["ngForm"] }, { kind: "directive", type: i3.FormGroupDirective, selector: "[formGroup]", inputs: ["formGroup"], outputs: ["ngSubmit"], exportAs: ["ngForm"] }, { kind: "directive", type: i3.FormControlName, selector: "[formControlName]", inputs: ["formControlName", "disabled", "ngModel"], outputs: ["ngModelChange"] }, { kind: "component", type: i2.FormErrorsComponent, selector: "cx-form-errors", inputs: ["prefix", "translationParams", "control"] }, { kind: "component", type: i2.FileUploadComponent, selector: "cx-file-upload", inputs: ["accept", "multiple"], outputs: ["update"] }, { kind: "pipe", type: i1.AsyncPipe, name: "async" }, { kind: "pipe", type: i4.TranslatePipe, name: "cxTranslate" }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: CustomerTicketingCreateDialogComponent, decorators: [{
            type: Component,
            args: [{ selector: 'cx-customer-ticketing-create-dialog', template: "<div\n  [cxFocus]=\"focusConfig\"\n  (esc)=\"close('Escape clicked')\"\n  class=\"cx-customer-ticket-form-dialog\"\n>\n  <form [formGroup]=\"form\" class=\"cx-customer-ticket-form-container\">\n    <div class=\"modal-header cx-customer-ticket-form-header\">\n      <div class=\"cx-customer-ticket-form-title modal-title\">\n        {{ 'createCustomerTicket.addNewRequest' | cxTranslate }}\n      </div>\n      <button\n        (click)=\"close('Close Create Request Dialog')\"\n        [attr.aria-label]=\"'common.close' | cxTranslate\"\n        class=\"cx-customer-ticket-form-close close\"\n        type=\"button\"\n      >\n        <span aria-hidden=\"true\">\n          <cx-icon [type]=\"iconTypes.CLOSE\"></cx-icon>\n        </span>\n      </button>\n    </div>\n\n    <div class=\"cx-customer-ticket-form-body\">\n      <div class=\"cx-customer-ticket-form-row\">\n        <label>\n          <span class=\"cx-customer-ticket-label label-content\">\n            {{ 'createCustomerTicket.subject' | cxTranslate }}\n          </span>\n          <textarea\n            [maxLength]=\"inputCharactersForSubject\"\n            class=\"form-control\"\n            formControlName=\"subject\"\n            rows=\"1\"\n          ></textarea>\n\n          <cx-form-errors [control]=\"form.get('subject')\"></cx-form-errors>\n          <p class=\"cx-customer-ticket-input-hint\">\n            {{\n              'customerTicketing.charactersLeft'\n                | cxTranslate: { count: subjectCharacterLeft }\n            }}\n          </p>\n        </label>\n\n        <label *ngIf=\"ticketCategories$ | async as ticketCategories\">\n          <span class=\"cx-customer-ticket-label label-content\">\n            {{ 'createCustomerTicket.category' | cxTranslate }}\n          </span>\n          <select class=\"form-control\" formControlName=\"ticketCategory\">\n            <option value=\"\" disabled selected>\n              {{ 'createCustomerTicket.selectCategory' | cxTranslate }}\n            </option>\n            <option\n              *ngFor=\"let category of ticketCategories\"\n              [ngValue]=\"category\"\n              [selected]=\"category.id === selectedCategory?.id\"\n            >\n              {{ category.name }}\n            </option>\n          </select>\n\n          <cx-form-errors\n            [control]=\"form.get('ticketCategory')\"\n          ></cx-form-errors>\n        </label>\n\n        <ng-container\n          *ngIf=\"ticketAssociatedObjects$ | async as ticketAssociatedObjects\"\n        >\n          <label *ngIf=\"ticketAssociatedObjects.length > 0\">\n            <span class=\"cx-customer-ticket-label label-content\">\n              {{ 'createCustomerTicket.associateTo' | cxTranslate }}\n            </span>\n            <select class=\"form-control\" formControlName=\"associatedTo\">\n              <option value=\"\" disabled selected>\n                {{\n                  'createCustomerTicket.optionallySelectAssociatedObject'\n                    | cxTranslate\n                }}\n              </option>\n              <option\n                *ngFor=\"let associatedObject of ticketAssociatedObjects\"\n                [ngValue]=\"associatedObject\"\n                [selected]=\"\n                  associatedObject.code === selectedAssociatedObject?.code\n                \"\n              >\n                {{ associatedObject.type }}\n                {{ associatedObject.code }}\n              </option>\n            </select>\n          </label>\n        </ng-container>\n\n        <label>\n          <span class=\"cx-customer-ticket-label label-content\">\n            {{ 'customerTicketing.message' | cxTranslate }}\n          </span>\n          <textarea\n            [maxLength]=\"inputCharactersLimit\"\n            class=\"form-control\"\n            formControlName=\"message\"\n            rows=\"5\"\n          ></textarea>\n\n          <cx-form-errors [control]=\"form.get('message')\"></cx-form-errors>\n\n          <p class=\"cx-customer-ticket-input-hint\">\n            {{\n              'customerTicketing.charactersLeft'\n                | cxTranslate: { count: messagesCharacterLeft }\n            }}\n          </p>\n        </label>\n\n        <div>\n          <cx-file-upload\n            [formControl]=\"$any(form.get('file'))\"\n            [accept]=\"allowedTypes\"\n          >\n            <ng-template>\n              <cx-icon [type]=\"iconTypes.UPLOAD\"></cx-icon>\n              <span class=\"cx-message-footer-text\">{{\n                'customerTicketing.uploadFile' | cxTranslate\n              }}</span>\n            </ng-template>\n          </cx-file-upload>\n\n          <p class=\"cx-customer-ticket-file-upload-hint\">\n            {{\n              'customerTicketing.fileSizeLimit'\n                | cxTranslate: { count: maxSize }\n            }}\n          </p>\n          <p class=\"cx-customer-ticket-file-upload-hint\">\n            {{ 'customerTicketing.maximumAttachment' | cxTranslate }}\n          </p>\n\n          <cx-form-errors\n            [control]=\"form.get('file')\"\n            prefix=\"formErrors.file\"\n          ></cx-form-errors>\n        </div>\n      </div>\n\n      <div class=\"cx-customer-ticket-form-footer\">\n        <button\n          (click)=\"close('Close Create Request Dialog')\"\n          class=\"btn btn-secondary\"\n          type=\"button\"\n        >\n          {{ 'customerTicketing.cancel' | cxTranslate }}\n        </button>\n        <button\n          (click)=\"createTicketRequest()\"\n          class=\"btn btn-primary\"\n          type=\"button\"\n        >\n          {{ 'customerTicketing.submit' | cxTranslate }}\n        </button>\n      </div>\n    </div>\n  </form>\n</div>\n" }]
        }], propDecorators: { selectedCategory: [{
                type: Input
            }], selectedAssociatedObject: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3VzdG9tZXItdGlja2V0aW5nLWNyZWF0ZS1kaWFsb2cuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vZmVhdHVyZS1saWJzL2N1c3RvbWVyLXRpY2tldGluZy9jb21wb25lbnRzL2xpc3QvY3VzdG9tZXItdGlja2V0aW5nLWNyZWF0ZS9jdXN0b21lci10aWNrZXRpbmctY3JlYXRlLWRpYWxvZy9jdXN0b21lci10aWNrZXRpbmctY3JlYXRlLWRpYWxvZy5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi8uLi9mZWF0dXJlLWxpYnMvY3VzdG9tZXItdGlja2V0aW5nL2NvbXBvbmVudHMvbGlzdC9jdXN0b21lci10aWNrZXRpbmctY3JlYXRlL2N1c3RvbWVyLXRpY2tldGluZy1jcmVhdGUtZGlhbG9nL2N1c3RvbWVyLXRpY2tldGluZy1jcmVhdGUtZGlhbG9nLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7O0dBSUc7QUFFSCxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBcUIsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzVFLE9BQU8sRUFBRSxXQUFXLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3BFLE9BQU8sRUFHTCwwQkFBMEIsR0FHM0IsTUFBTSxvQ0FBb0MsQ0FBQztBQUM1QyxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDbEQsT0FBTyxFQUE0QixFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDcEQsT0FBTyxFQUFFLGdDQUFnQyxFQUFFLE1BQU0sK0VBQStFLENBQUM7QUFDakksT0FBTyxFQUNMLG9CQUFvQixFQUNwQixpQkFBaUIsRUFDakIsY0FBYyxFQUNkLGtCQUFrQixHQUNuQixNQUFNLGlCQUFpQixDQUFDO0FBQ3pCLE9BQU8sRUFBRSxVQUFVLEVBQUUsS0FBSyxF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QWlCLENBQUMsY0FBYyxDQUNqQyxDQUFDO2lCQUNIO1lBQ0gsQ0FBQyxDQUFDLENBQUM7U0FDSjthQUFNO1lBQ0wsSUFBSSxDQUFDLGtCQUFrQjtpQkFDcEIsU0FBUyxDQUFDLDJCQUEyQixDQUFDO2lCQUN0QyxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7aUJBQ2IsU0FBUyxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUU7Z0JBQ2xCLElBQUksQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUNwQixFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsRUFDYixpQkFBaUIsQ0FBQyxjQUFjLENBQ2pDLENBQUM7WUFDSixDQUFDLENBQUMsQ0FBQztTQUNOO1FBQ0QsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQ2pCLENBQUM7SUFFUyxVQUFVO1FBQ2xCLElBQUksQ0FBQyxLQUFLLENBQUMsNkJBQTZCLENBQUMsQ0FBQztJQUM1QyxDQUFDO0lBRVMsT0FBTztRQUNmLElBQUksQ0FBQyxLQUFLLENBQUMsc0JBQXNCLENBQUMsQ0FBQztJQUNyQyxDQUFDO0lBRUQsV0FBVztRQUNULElBQUksSUFBSSxDQUFDLFlBQVksRUFBRTtZQUNyQixJQUFJLENBQUMsWUFBWSxDQUFDLFdBQVcsRUFBRSxDQUFDO1NBQ2pDO0lBQ0gsQ0FBQzs7bUlBNUlVLHNDQUFzQzt1SEFBdEMsc0NBQXNDLDBNQzdCbkQsMG1MQW9LQTsyRkR2SWEsc0NBQXNDO2tCQUpsRCxTQUFTOytCQUNFLHFDQUFxQzs4QkFtQi9DLGdCQUFnQjtzQkFEZixLQUFLO2dCQUlOLHdCQUF3QjtzQkFEdkIsS0FBSyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBTUERYLUZpbGVDb3B5cmlnaHRUZXh0OiAyMDIzIFNBUCBTcGFydGFjdXMgdGVhbSA8c3BhcnRhY3VzLXRlYW1Ac2FwLmNvbT5cbiAqXG4gKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogQXBhY2hlLTIuMFxuICovXG5cbmltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE9uRGVzdHJveSwgT25Jbml0LCBpbmplY3QgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEZvcm1Db250cm9sLCBGb3JtR3JvdXAsIFZhbGlkYXRvcnMgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQge1xuICBBc3NvY2lhdGVkT2JqZWN0LFxuICBDYXRlZ29yeSxcbiAgTUFYX0VOVFJJRVNfRk9SX0FUVEFDSE1FTlQsXG4gIFRpY2tldERldGFpbHMsXG4gIFRpY2tldFN0YXJ0ZXIsXG59IGZyb20gJ0BzcGFydGFjdXMvY3VzdG9tZXItdGlja2V0aW5nL3Jvb3QnO1xuaW1wb3J0IHsgRm9ybVV0aWxzIH0gZnJvbSAnQHNwYXJ0YWN1cy9zdG9yZWZyb250JztcbmltcG9ydCB7IE9ic2VydmFibGUsIFN1YnNjcmlwdGlvbiwgb2YgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IEN1c3RvbWVyVGlja2V0aW5nRGlhbG9nQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vLi4vc2hhcmVkL2N1c3RvbWVyLXRpY2tldGluZy1kaWFsb2cvY3VzdG9tZXItdGlja2V0aW5nLWRpYWxvZy5jb21wb25lbnQnO1xuaW1wb3J0IHtcbiAgR2xvYmFsTWVzc2FnZVNlcnZpY2UsXG4gIEdsb2JhbE1lc3NhZ2VUeXBlLFxuICBIdHRwRXJyb3JNb2RlbCxcbiAgVHJhbnNsYXRpb25TZXJ2aWNlLFxufSBmcm9tICdAc3BhcnRhY3VzL2NvcmUnO1xuaW1wb3J0IHsgY2F0Y2hFcnJvciwgZmlyc3QgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdjeC1jdXN0b21lci10aWNrZXRpbmctY3JlYXRlLWRpYWxvZycsXG4gIHRlbXBsYXRlVXJsOiAnLi9jdXN0b21lci10aWNrZXRpbmctY3JlYXRlLWRpYWxvZy5jb21wb25lbnQuaHRtbCcsXG59KVxuZXhwb3J0IGNsYXNzIEN1c3RvbWVyVGlja2V0aW5nQ3JlYXRlRGlhbG9nQ29tcG9uZW50XG4gIGV4dGVuZHMgQ3VzdG9tZXJUaWNrZXRpbmdEaWFsb2dDb21wb25lbnRcbiAgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveVxue1xuICB0aWNrZXRDYXRlZ29yaWVzJDogT2JzZXJ2YWJsZTxDYXRlZ29yeVtdPiA9XG4gICAgdGhpcy5jdXN0b21lclRpY2tldGluZ0ZhY2FkZS5nZXRUaWNrZXRDYXRlZ29yaWVzKCk7XG4gIHRpY2tldEFzc29jaWF0ZWRPYmplY3RzJDogT2JzZXJ2YWJsZTxBc3NvY2lhdGVkT2JqZWN0W10+ID1cbiAgICB0aGlzLmN1c3RvbWVyVGlja2V0aW5nRmFjYWRlLmdldFRpY2tldEFzc29jaWF0ZWRPYmplY3RzKCkucGlwZShcbiAgICAgIGNhdGNoRXJyb3IoKGVycm9yOiBhbnkpID0+IHtcbiAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvcik7XG4gICAgICAgIHJldHVybiBvZihbXSk7XG4gICAgICB9KVxuICAgICk7XG4gIHN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xuXG4gIEBJbnB1dCgpXG4gIHNlbGVjdGVkQ2F0ZWdvcnk6IENhdGVnb3J5O1xuXG4gIEBJbnB1dCgpXG4gIHNlbGVjdGVkQXNzb2NpYXRlZE9iamVjdDogQXNzb2NpYXRlZE9iamVjdDtcblxuICBhdHRhY2htZW50OiBGaWxlO1xuXG4gIHByb3RlY3RlZCBnbG9iYWxNZXNzYWdlID0gaW5qZWN0KEdsb2JhbE1lc3NhZ2VTZXJ2aWNlKTtcblxuICBwcm90ZWN0ZWQgdHJhbnNsYXRpb25TZXJ2aWNlID0gaW5qZWN0KFRyYW5zbGF0aW9uU2VydmljZSk7XG5cbiAgcHJvdGVjdGVkIGdldENyZWF0ZVRpY2tldFBheWxvYWQoZm9ybTogRm9ybUdyb3VwKTogVGlja2V0U3RhcnRlciB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG1lc3NhZ2U6IGZvcm0/LmdldCgnbWVzc2FnZScpPy52YWx1ZSxcbiAgICAgIHN1YmplY3Q6IGZvcm0/LmdldCgnc3ViamVjdCcpPy52YWx1ZSxcbiAgICAgIGFzc29jaWF0ZWRUbzogZm9ybT8uZ2V0KCdhc3NvY2lhdGVkVG8nKT8udmFsdWUgfHwgdW5kZWZpbmVkLFxuICAgICAgdGlja2V0Q2F0ZWdvcnk6IGZvcm0/LmdldCgndGlja2V0Q2F0ZWdvcnknKT8udmFsdWUsXG4gICAgfTtcbiAgfVxuXG4gIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIHRoaXMuYnVpbGRGb3JtKCk7XG4gIH1cblxuICBwcm90ZWN0ZWQgYnVpbGRGb3JtKCk6IHZvaWQge1xuICAgIGNvbnN0IGZvcm0gPSBuZXcgRm9ybUdyb3VwKHt9KTtcbiAgICBmb3JtLnNldENvbnRyb2woXG4gICAgICAnc3ViamVjdCcsXG4gICAgICBuZXcgRm9ybUNvbnRyb2woJycsIFtcbiAgICAgICAgVmFsaWRhdG9ycy5yZXF1aXJlZCxcbiAgICAgICAgVmFsaWRhdG9ycy5tYXhMZW5ndGgodGhpcy5pbnB1dENoYXJhY3RlcnNGb3JTdWJqZWN0KSxcbiAgICAgIF0pXG4gICAgKTtcbiAgICBmb3JtLnNldENvbnRyb2woXG4gICAgICAndGlja2V0Q2F0ZWdvcnknLFxuICAgICAgbmV3IEZvcm1Db250cm9sKCcnLCBbVmFsaWRhdG9ycy5yZXF1aXJlZF0pXG4gICAgKTtcbiAgICBmb3JtLnNldENvbnRyb2woJ2Fzc29jaWF0ZWRUbycsIG5ldyBGb3JtQ29udHJvbCgnJykpO1xuICAgIGZvcm0uc2V0Q29udHJvbChcbiAgICAgICdtZXNzYWdlJyxcbiAgICAgIG5ldyBGb3JtQ29udHJvbCgnJywgW1xuICAgICAgICBWYWxpZGF0b3JzLnJlcXVpcmVkLFxuICAgICAgICBWYWxpZGF0b3JzLm1heExlbmd0aCh0aGlzLmlucHV0Q2hhcmFjdGVyc0xpbWl0KSxcbiAgICAgIF0pXG4gICAgKTtcbiAgICBmb3JtLnNldENvbnRyb2woXG4gICAgICAnZmlsZScsXG4gICAgICBuZXcgRm9ybUNvbnRyb2woJycsIFtcbiAgICAgICAgdGhpcy5maWxlc0Zvcm1WYWxpZGF0b3JzLm1heFNpemUodGhpcy5tYXhTaXplKSxcbiAgICAgICAgdGhpcy5maWxlc0Zvcm1WYWxpZGF0b3JzLm1heEVudHJpZXMoTUFYX0VOVFJJRVNfRk9SX0FUVEFDSE1FTlQpLFxuICAgICAgICB0aGlzLmZpbGVzRm9ybVZhbGlkYXRvcnMuYWxsb3dlZFR5cGVzKHRoaXMuYWxsb3dlZFR5cGVzKSxcbiAgICAgIF0pXG4gICAgKTtcbiAgICB0aGlzLmZvcm0gPSBmb3JtO1xuICB9XG5cbiAgY3JlYXRlVGlja2V0UmVxdWVzdCgpOiB2b2lkIHtcbiAgICB0aGlzLmF0dGFjaG1lbnQgPSB0aGlzLmZvcm0uZ2V0KCdmaWxlJyk/LnZhbHVlPy5bMF07XG4gICAgaWYgKHRoaXMuZm9ybS5pbnZhbGlkKSB7XG4gICAgICB0aGlzLmZvcm0ubWFya0FsbEFzVG91Y2hlZCgpO1xuICAgICAgRm9ybVV0aWxzLmRlZXBVcGRhdGVWYWx1ZUFuZFZhbGlkaXR5KHRoaXMuZm9ybSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc3Vic2NyaXB0aW9uID0gdGhpcy5jdXN0b21lclRpY2tldGluZ0ZhY2FkZVxuICAgICAgICAuY3JlYXRlVGlja2V0KHRoaXMuZ2V0Q3JlYXRlVGlja2V0UGF5bG9hZCh0aGlzLmZvcm0pKVxuICAgICAgICAuc3Vic2NyaWJlKHtcbiAgICAgICAgICBuZXh0OiAocmVzcG9uc2U6IFRpY2tldERldGFpbHMpID0+IHtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgcmVzcG9uc2UuaWQgJiZcbiAgICAgICAgICAgICAgdGhpcy5hdHRhY2htZW50ICYmXG4gICAgICAgICAgICAgIHJlc3BvbnNlLnRpY2tldEV2ZW50cz8uWzBdLmNvZGVcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICB0aGlzLmN1c3RvbWVyVGlja2V0aW5nRmFjYWRlLnVwbG9hZEF0dGFjaG1lbnQoXG4gICAgICAgICAgICAgICAgdGhpcy5hdHRhY2htZW50LFxuICAgICAgICAgICAgICAgIHJlc3BvbnNlLnRpY2tldEV2ZW50cz8uWzBdLmNvZGUsXG4gICAgICAgICAgICAgICAgcmVzcG9uc2UuaWRcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGNvbXBsZXRlOiAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uQ29tcGxldGUoKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGVycm9yOiAoZXJyb3I6IGFueSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvcik7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgcHJvdGVjdGVkIGhhbmRsZUVycm9yKGVycm9yOiBhbnkpOiB2b2lkIHtcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBIdHRwRXJyb3JNb2RlbCkge1xuICAgICAgKGVycm9yLmRldGFpbHMgPz8gW10pLmZvckVhY2goKGVycikgPT4ge1xuICAgICAgICBpZiAoZXJyLm1lc3NhZ2UpIHtcbiAgICAgICAgICB0aGlzLmdsb2JhbE1lc3NhZ2UuYWRkKFxuICAgICAgICAgICAgeyByYXc6IGVyci5tZXNzYWdlIH0sXG4gICAgICAgICAgICBHbG9iYWxNZXNzYWdlVHlwZS5NU0dfVFlQRV9FUlJPUlxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnRyYW5zbGF0aW9uU2VydmljZVxuICAgICAgICAudHJhbnNsYXRlKCdodHRwSGFuZGxlcnMudW5rbm93bkVycm9yJylcbiAgICAgICAgLnBpcGUoZmlyc3QoKSlcbiAgICAgICAgLnN1YnNjcmliZSgodGV4dCkgPT4ge1xuICAgICAgICAgIHRoaXMuZ2xvYmFsTWVzc2FnZS5hZGQoXG4gICAgICAgICAgICB7IHJhdzogdGV4dCB9LFxuICAgICAgICAgICAgR2xvYmFsTWVzc2FnZVR5cGUuTVNHX1RZUEVfRVJST1JcbiAgICAgICAgICApO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5vbkVycm9yKCk7XG4gIH1cblxuICBwcm90ZWN0ZWQgb25Db21wbGV0ZSgpOiB2b2lkIHtcbiAgICB0aGlzLmNsb3NlKCdUaWNrZXQgY3JlYXRlZCBzdWNjZXNzZnVsbHknKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBvbkVycm9yKCk6IHZvaWQge1xuICAgIHRoaXMuY2xvc2UoJ1NvbWV0aGluZyB3ZW50IHdyb25nJyk7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5zdWJzY3JpcHRpb24pIHtcbiAgICAgIHRoaXMuc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgfVxuICB9XG59XG4iLCI8ZGl2XG4gIFtjeEZvY3VzXT1cImZvY3VzQ29uZmlnXCJcbiAgKGVzYyk9XCJjbG9zZSgnRXNjYXBlIGNsaWNrZWQnKVwiXG4gIGNsYXNzPVwiY3gtY3VzdG9tZXItdGlja2V0LWZvcm0tZGlhbG9nXCJcbj5cbiAgPGZvcm0gW2Zvcm1Hcm91cF09XCJmb3JtXCIgY2xhc3M9XCJjeC1jdXN0b21lci10aWNrZXQtZm9ybS1jb250YWluZXJcIj5cbiAgICA8ZGl2IGNsYXNzPVwibW9kYWwtaGVhZGVyIGN4LWN1c3RvbWVyLXRpY2tldC1mb3JtLWhlYWRlclwiPlxuICAgICAgPGRpdiBjbGFzcz1cImN4LWN1c3RvbWVyLXRpY2tldC1mb3JtLXRpdGxlIG1vZGFsLXRpdGxlXCI+XG4gICAgICAgIHt7ICdjcmVhdGVDdXN0b21lclRpY2tldC5hZGROZXdSZXF1ZXN0JyB8IGN4VHJhbnNsYXRlIH19XG4gICAgICA8L2Rpdj5cbiAgICAgIDxidXR0b25cbiAgICAgICAgKGNsaWNrKT1cImNsb3NlKCdDbG9zZSBDcmVhdGUgUmVxdWVzdCBEaWFsb2cnKVwiXG4gICAgICAgIFthdHRyLmFyaWEtbGFiZWxdPVwiJ2NvbW1vbi5jbG9zZScgfCBjeFRyYW5zbGF0ZVwiXG4gICAgICAgIGNsYXNzPVwiY3gtY3VzdG9tZXItdGlja2V0LWZvcm0tY2xvc2UgY2xvc2VcIlxuICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgID5cbiAgICAgICAgPHNwYW4gYXJpYS1oaWRkZW49XCJ0cnVlXCI+XG4gICAgICAgICAgPGN4LWljb24gW3R5cGVdPVwiaWNvblR5cGVzLkNMT1NFXCI+PC9jeC1pY29uPlxuICAgICAgICA8L3NwYW4+XG4gICAgICA8L2J1dHRvbj5cbiAgICA8L2Rpdj5cblxuICAgIDxkaXYgY2xhc3M9XCJjeC1jdXN0b21lci10aWNrZXQtZm9ybS1ib2R5XCI+XG4gICAgICA8ZGl2IGNsYXNzPVwiY3gtY3VzdG9tZXItdGlja2V0LWZvcm0tcm93XCI+XG4gICAgICAgIDxsYWJlbD5cbiAgICAgICAgICA8c3BhbiBjbGFzcz1cImN4LWN1c3RvbWVyLXRpY2tldC1sYWJlbCBsYWJlbC1jb250ZW50XCI+XG4gICAgICAgICAgICB7eyAnY3JlYXRlQ3VzdG9tZXJUaWNrZXQuc3ViamVjdCcgfCBjeFRyYW5zbGF0ZSB9fVxuICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICA8dGV4dGFyZWFcbiAgICAgICAgICAgIFttYXhMZW5ndGhdPVwiaW5wdXRDaGFyYWN0ZXJzRm9yU3ViamVjdFwiXG4gICAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbFwiXG4gICAgICAgICAgICBmb3JtQ29udHJvbE5hbWU9XCJzdWJqZWN0XCJcbiAgICAgICAgICAgIHJvd3M9XCIxXCJcbiAgICAgICAgICA+PC90ZXh0YXJlYT5cblxuICAgICAgICAgIDxjeC1mb3JtLWVycm9ycyBbY29udHJvbF09XCJmb3JtLmdldCgnc3ViamVjdCcpXCI+PC9jeC1mb3JtLWVycm9ycz5cbiAgICAgICAgICA8cCBjbGFzcz1cImN4LWN1c3RvbWVyLXRpY2tldC1pbnB1dC1oaW50XCI+XG4gICAgICAgICAgICB7e1xuICAgICAgICAgICAgICAnY3VzdG9tZXJUaWNrZXRpbmcuY2hhcmFjdGVyc0xlZnQnXG4gICAgICAgICAgICAgICAgfCBjeFRyYW5zbGF0ZTogeyBjb3VudDogc3ViamVjdENoYXJhY3RlckxlZnQgfVxuICAgICAgICAgICAgfX1cbiAgICAgICAgICA8L3A+XG4gICAgICAgIDwvbGFiZWw+XG5cbiAgICAgICAgPGxhYmVsICpuZ0lmPVwidGlja2V0Q2F0ZWdvcmllcyQgfCBhc3luYyBhcyB0aWNrZXRDYXRlZ29yaWVzXCI+XG4gICAgICAgICAgPHNwYW4gY2xhc3M9XCJjeC1jdXN0b21lci10aWNrZXQtbGFiZWwgbGFiZWwtY29udGVudFwiPlxuICAgICAgICAgICAge3sgJ2NyZWF0ZUN1c3RvbWVyVGlja2V0LmNhdGVnb3J5JyB8IGN4VHJhbnNsYXRlIH19XG4gICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgIDxzZWxlY3QgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIiBmb3JtQ29udHJvbE5hbWU9XCJ0aWNrZXRDYXRlZ29yeVwiPlxuICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIlwiIGRpc2FibGVkIHNlbGVjdGVkPlxuICAgICAgICAgICAgICB7eyAnY3JlYXRlQ3VzdG9tZXJUaWNrZXQuc2VsZWN0Q2F0ZWdvcnknIHwgY3hUcmFuc2xhdGUgfX1cbiAgICAgICAgICAgIDwvb3B0aW9uPlxuICAgICAgICAgICAgPG9wdGlvblxuICAgICAgICAgICAgICAqbmdGb3I9XCJsZXQgY2F0ZWdvcnkgb2YgdGlja2V0Q2F0ZWdvcmllc1wiXG4gICAgICAgICAgICAgIFtuZ1ZhbHVlXT1cImNhdGVnb3J5XCJcbiAgICAgICAgICAgICAgW3NlbGVjdGVkXT1cImNhdGVnb3J5LmlkID09PSBzZWxlY3RlZENhdGVnb3J5Py5pZFwiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIHt7IGNhdGVnb3J5Lm5hbWUgfX1cbiAgICAgICAgICAgIDwvb3B0aW9uPlxuICAgICAgICAgIDwvc2VsZWN0PlxuXG4gICAgICAgICAgPGN4LWZvcm0tZXJyb3JzXG4gICAgICAgICAgICBbY29udHJvbF09XCJmb3JtLmdldCgndGlja2V0Q2F0ZWdvcnknKVwiXG4gICAgICAgICAgPjwvY3gtZm9ybS1lcnJvcnM+XG4gICAgICAgIDwvbGFiZWw+XG5cbiAgICAgICAgPG5nLWNvbnRhaW5lclxuICAgICAgICAgICpuZ0lmPVwidGlja2V0QXNzb2NpYXRlZE9iamVjdHMkIHwgYXN5bmMgYXMgdGlja2V0QXNzb2NpYXRlZE9iamVjdHNcIlxuICAgICAgICA+XG4gICAgICAgICAgPGxhYmVsICpuZ0lmPVwidGlja2V0QXNzb2NpYXRlZE9iamVjdHMubGVuZ3RoID4gMFwiPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJjeC1jdXN0b21lci10aWNrZXQtbGFiZWwgbGFiZWwtY29udGVudFwiPlxuICAgICAgICAgICAgICB7eyAnY3JlYXRlQ3VzdG9tZXJUaWNrZXQuYXNzb2NpYXRlVG8nIHwgY3hUcmFuc2xhdGUgfX1cbiAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgIDxzZWxlY3QgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIiBmb3JtQ29udHJvbE5hbWU9XCJhc3NvY2lhdGVkVG9cIj5cbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIlwiIGRpc2FibGVkIHNlbGVjdGVkPlxuICAgICAgICAgICAgICAgIHt7XG4gICAgICAgICAgICAgICAgICAnY3JlYXRlQ3VzdG9tZXJUaWNrZXQub3B0aW9uYWxseVNlbGVjdEFzc29jaWF0ZWRPYmplY3QnXG4gICAgICAgICAgICAgICAgICAgIHwgY3hUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICA8L29wdGlvbj5cbiAgICAgICAgICAgICAgPG9wdGlvblxuICAgICAgICAgICAgICAgICpuZ0Zvcj1cImxldCBhc3NvY2lhdGVkT2JqZWN0IG9mIHRpY2tldEFzc29jaWF0ZWRPYmplY3RzXCJcbiAgICAgICAgICAgICAgICBbbmdWYWx1ZV09XCJhc3NvY2lhdGVkT2JqZWN0XCJcbiAgICAgICAgICAgICAgICBbc2VsZWN0ZWRdPVwiXG4gICAgICAgICAgICAgICAgICBhc3NvY2lhdGVkT2JqZWN0LmNvZGUgPT09IHNlbGVjdGVkQXNzb2NpYXRlZE9iamVjdD8uY29kZVxuICAgICAgICAgICAgICAgIFwiXG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7eyBhc3NvY2lhdGVkT2JqZWN0LnR5cGUgfX1cbiAgICAgICAgICAgICAgICB7eyBhc3NvY2lhdGVkT2JqZWN0LmNvZGUgfX1cbiAgICAgICAgICAgICAgPC9vcHRpb24+XG4gICAgICAgICAgICA8L3NlbGVjdD5cbiAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICA8L25nLWNvbnRhaW5lcj5cblxuICAgICAgICA8bGFiZWw+XG4gICAgICAgICAgPHNwYW4gY2xhc3M9XCJjeC1jdXN0b21lci10aWNrZXQtbGFiZWwgbGFiZWwtY29udGVudFwiPlxuICAgICAgICAgICAge3sgJ2N1c3RvbWVyVGlja2V0aW5nLm1lc3NhZ2UnIHwgY3hUcmFuc2xhdGUgfX1cbiAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgPHRleHRhcmVhXG4gICAgICAgICAgICBbbWF4TGVuZ3RoXT1cImlucHV0Q2hhcmFjdGVyc0xpbWl0XCJcbiAgICAgICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sXCJcbiAgICAgICAgICAgIGZvcm1Db250cm9sTmFtZT1cIm1lc3NhZ2VcIlxuICAgICAgICAgICAgcm93cz1cIjVcIlxuICAgICAgICAgID48L3RleHRhcmVhPlxuXG4gICAgICAgICAgPGN4LWZvcm0tZXJyb3JzIFtjb250cm9sXT1cImZvcm0uZ2V0KCdtZXNzYWdlJylcIj48L2N4LWZvcm0tZXJyb3JzPlxuXG4gICAgICAgICAgPHAgY2xhc3M9XCJjeC1jdXN0b21lci10aWNrZXQtaW5wdXQtaGludFwiPlxuICAgICAgICAgICAge3tcbiAgICAgICAgICAgICAgJ2N1c3RvbWVyVGlja2V0aW5nLmNoYXJhY3RlcnNMZWZ0J1xuICAgICAgICAgICAgICAgIHwgY3hUcmFuc2xhdGU6IHsgY291bnQ6IG1lc3NhZ2VzQ2hhcmFjdGVyTGVmdCB9XG4gICAgICAgICAgICB9fVxuICAgICAgICAgIDwvcD5cbiAgICAgICAgPC9sYWJlbD5cblxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIDxjeC1maWxlLXVwbG9hZFxuICAgICAgICAgICAgW2Zvcm1Db250cm9sXT1cIiRhbnkoZm9ybS5nZXQoJ2ZpbGUnKSlcIlxuICAgICAgICAgICAgW2FjY2VwdF09XCJhbGxvd2VkVHlwZXNcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxuZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgPGN4LWljb24gW3R5cGVdPVwiaWNvblR5cGVzLlVQTE9BRFwiPjwvY3gtaWNvbj5cbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJjeC1tZXNzYWdlLWZvb3Rlci10ZXh0XCI+e3tcbiAgICAgICAgICAgICAgICAnY3VzdG9tZXJUaWNrZXRpbmcudXBsb2FkRmlsZScgfCBjeFRyYW5zbGF0ZVxuICAgICAgICAgICAgICB9fTwvc3Bhbj5cbiAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgPC9jeC1maWxlLXVwbG9hZD5cblxuICAgICAgICAgIDxwIGNsYXNzPVwiY3gtY3VzdG9tZXItdGlja2V0LWZpbGUtdXBsb2FkLWhpbnRcIj5cbiAgICAgICAgICAgIHt7XG4gICAgICAgICAgICAgICdjdXN0b21lclRpY2tldGluZy5maWxlU2l6ZUxpbWl0J1xuICAgICAgICAgICAgICAgIHwgY3hUcmFuc2xhdGU6IHsgY291bnQ6IG1heFNpemUgfVxuICAgICAgICAgICAgfX1cbiAgICAgICAgICA8L3A+XG4gICAgICAgICAgPHAgY2xhc3M9XCJjeC1jdXN0b21lci10aWNrZXQtZmlsZS11cGxvYWQtaGludFwiPlxuICAgICAgICAgICAge3sgJ2N1c3RvbWVyVGlja2V0aW5nLm1heGltdW1BdHRhY2htZW50JyB8IGN4VHJhbnNsYXRlIH19XG4gICAgICAgICAgPC9wPlxuXG4gICAgICAgICAgPGN4LWZvcm0tZXJyb3JzXG4gICAgICAgICAgICBbY29udHJvbF09XCJmb3JtLmdldCgnZmlsZScpXCJcbiAgICAgICAgICAgIHByZWZpeD1cImZvcm1FcnJvcnMuZmlsZVwiXG4gICAgICAgICAgPjwvY3gtZm9ybS1lcnJvcnM+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG5cbiAgICAgIDxkaXYgY2xhc3M9XCJjeC1jdXN0b21lci10aWNrZXQtZm9ybS1mb290ZXJcIj5cbiAgICAgICAgPGJ1dHRvblxuICAgICAgICAgIChjbGljayk9XCJjbG9zZSgnQ2xvc2UgQ3JlYXRlIFJlcXVlc3QgRGlhbG9nJylcIlxuICAgICAgICAgIGNsYXNzPVwiYnRuIGJ0bi1zZWNvbmRhcnlcIlxuICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICA+XG4gICAgICAgICAge3sgJ2N1c3RvbWVyVGlja2V0aW5nLmNhbmNlbCcgfCBjeFRyYW5zbGF0ZSB9fVxuICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgPGJ1dHRvblxuICAgICAgICAgIChjbGljayk9XCJjcmVhdGVUaWNrZXRSZXF1ZXN0KClcIlxuICAgICAgICAgIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5XCJcbiAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgPlxuICAgICAgICAgIHt7ICdjdXN0b21lclRpY2tldGluZy5zdWJtaXQnIHwgY3hUcmFuc2xhdGUgfX1cbiAgICAgICAgPC9idXR0b24+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgPC9mb3JtPlxuPC9kaXY+XG4iXX0=