{"version":3,"file":"spartacus-organization-account-summary-root.mjs","sources":["../../../feature-libs/organization/account-summary/root/config/default-account-summary-routing.config.ts","../../../feature-libs/organization/account-summary/root/config/index.ts","../../../feature-libs/organization/account-summary/root/feature-name.ts","../../../feature-libs/organization/account-summary/root/http-interceptors/blob-error.interceptor.ts","../../../feature-libs/organization/account-summary/root/account-summary-root.module.ts","../../../feature-libs/organization/account-summary/root/facade/account-summary.facade.ts","../../../feature-libs/organization/account-summary/root/facade/index.ts","../../../feature-libs/organization/account-summary/root/model/account-summary.model.ts","../../../feature-libs/organization/account-summary/root/model/index.ts","../../../feature-libs/organization/account-summary/root/http-interceptors/index.ts","../../../feature-libs/organization/account-summary/root/public_api.ts","../../../feature-libs/organization/account-summary/root/spartacus-organization-account-summary-root.ts"],"sourcesContent":["/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { RoutingConfig } from '@spartacus/core';\n\nconst listPath = `organization/account-summary`;\n\nexport const defaultAccountSummaryRoutingConfig: RoutingConfig = {\n  routing: {\n    routes: {\n      orgAccountSummary: {\n        paths: [`${listPath}`],\n      },\n      orgAccountSummaryDetails: {\n        paths: [`${listPath}/details/:orgUnit`],\n        paramsMapping: { orgUnit: 'uid' },\n      },\n    },\n  },\n};\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from './default-account-summary-routing.config';\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const ORGANIZATION_ACCOUNT_SUMMARY_FEATURE =\n  'organizationAccountSummary';\n\nexport const ORGANIZATION_ACCOUNT_SUMMARY_CORE_FEATURE =\n  'organizationAccountSummaryCore';\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {\n  HttpErrorResponse,\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n} from '@angular/common/http';\nimport { inject, Injectable } from '@angular/core';\nimport { FileReaderService } from '@spartacus/storefront';\nimport { WindowRef } from '@spartacus/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, switchMap } from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class BlobErrorInterceptor implements HttpInterceptor {\n  protected readonly fileReaderService = inject(FileReaderService);\n  protected readonly windowRef = inject(WindowRef);\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    return next.handle(request).pipe(\n      catchError((errResponse: any) => {\n        if (\n          this.windowRef.isBrowser() &&\n          errResponse instanceof HttpErrorResponse &&\n          errResponse.error instanceof Blob &&\n          errResponse.error.type === 'application/json'\n        ) {\n          return this.fileReaderService\n            .loadTextFile(errResponse.error as File)\n            .pipe(\n              switchMap((errorString: any) => {\n                const error = JSON.parse(errorString);\n                return throwError(\n                  new HttpErrorResponse({\n                    ...errResponse,\n                    error,\n                    url: errResponse.url ?? undefined,\n                  })\n                );\n              })\n            );\n        } else {\n          return throwError(errResponse);\n        }\n      })\n    );\n  }\n}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { RouterModule } from '@angular/router';\nimport {\n  CmsConfig,\n  provideDefaultConfig,\n  provideDefaultConfigFactory,\n} from '@spartacus/core';\nimport { CmsPageGuard, PageLayoutComponent } from '@spartacus/storefront';\nimport { defaultAccountSummaryRoutingConfig } from './config';\nimport { ORGANIZATION_ACCOUNT_SUMMARY_FEATURE } from './feature-name';\nimport { BlobErrorInterceptor } from './http-interceptors/blob-error.interceptor';\n\n// TODO: Inline this factory when we start releasing Ivy compiled libraries\nexport function defaultAccountSummaryComponentsConfig(): CmsConfig {\n  const config: CmsConfig = {\n    featureModules: {\n      [ORGANIZATION_ACCOUNT_SUMMARY_FEATURE]: {\n        cmsComponents: [\n          'ManageAccountSummaryListComponent',\n          'AccountSummaryHeaderComponent',\n          'AccountSummaryDocumentComponent',\n        ],\n      },\n    },\n  };\n\n  return config;\n}\n\n@NgModule({\n  imports: [\n    RouterModule.forChild([\n      {\n        // @ts-ignore\n        path: null,\n        canActivate: [CmsPageGuard],\n        component: PageLayoutComponent,\n        data: { cxRoute: 'orgAccountSummaryDetails' },\n      },\n    ]),\n  ],\n  providers: [\n    provideDefaultConfig(defaultAccountSummaryRoutingConfig),\n    provideDefaultConfigFactory(defaultAccountSummaryComponentsConfig),\n    {\n      provide: HTTP_INTERCEPTORS,\n      useExisting: BlobErrorInterceptor,\n      multi: true,\n    },\n  ],\n})\nexport class AccountSummaryRootModule {}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { facadeFactory } from '@spartacus/core';\nimport { ORGANIZATION_ACCOUNT_SUMMARY_FEATURE } from '../feature-name';\nimport {\n  AccountSummaryDetails,\n  AccountSummaryList,\n  DocumentQueryParams,\n} from '../model/account-summary.model';\n\n@Injectable({\n  providedIn: 'root',\n  useFactory: () =>\n    facadeFactory({\n      facade: AccountSummaryFacade,\n      feature: ORGANIZATION_ACCOUNT_SUMMARY_FEATURE,\n      methods: [\n        'getAccountSummary',\n        'getDocumentList',\n        'getDocumentAttachment',\n      ],\n    }),\n})\nexport abstract class AccountSummaryFacade {\n  /**\n   * Returns the account summary header details for a orgUnit and current logged in user\n   * @param orgUnitId If provided, it will be used, otherwise it will use orgUnitId from router state.\n   */\n  abstract getAccountSummary(\n    orgUnitId?: string\n  ): Observable<AccountSummaryDetails>;\n\n  /**\n   * Returns the result of account summary documents search\n   * @param params Search parameters\n   * @param orgUnitId If provided, it will be used, otherwise it will use orgUnitId from router state.\n   */\n  abstract getDocumentList(\n    params: DocumentQueryParams,\n    orgUnitId?: string\n  ): Observable<AccountSummaryList>;\n\n  /**\n   * Returns the document blob for given orgDocumentId and orgDocumentAttachmentId\n   * @param orgDocumentId organization document id\n   * @param orgDocumentAttachmentId attachment id belonging to a organization document id\n   * @param orgUnitId If provided, it will be used, otherwise it will use orgUnitId from router state.\n   */\n  abstract getDocumentAttachment(\n    orgDocumentId?: string,\n    orgDocumentAttachmentId?: string,\n    orgUnitId?: string\n  ): Observable<Blob>;\n}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from './account-summary.facade';\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {\n  Address,\n  B2BUnit,\n  Currency,\n  PaginationModel,\n  SortModel,\n} from '@spartacus/core';\n\ninterface OrgDocumentAttachment {\n  id?: string;\n}\n\nexport interface OrgDocumentType {\n  code?: string;\n  name?: string;\n  payableOrUsable?: string;\n}\n\ninterface AmountBalance {\n  currentBalance?: string;\n  dueBalances?: DueBalanceRange[];\n  openBalance?: string;\n  pastDueBalance?: string;\n}\n\ninterface DueBalanceRange {\n  amount?: string;\n  dayRange?: NumberOfDayRange;\n}\n\ninterface NumberOfDayRange {\n  minBoundary?: number;\n  maxBoundary?: number;\n}\n\nexport enum DocumentStatus {\n  ALL = 'all',\n  OPEN = 'open',\n  CLOSED = 'closed',\n}\n\nexport enum DocumentFields {\n  BASIC = 'BASIC',\n  DEFAULT = 'DEFAULT',\n  FULL = 'FULL',\n}\n\nexport enum FilterByOptions {\n  DOCUMENT_NUMBER = 'orgDocumentId',\n  DOCUMENT_NUMBER_RANGE = 'orgDocumentIdRange',\n  DOCUMENT_TYPE = 'orgDocumentType',\n  DATE_RANGE = 'createdAtDateRange',\n  DUE_DATE_RANGE = 'dueAtDateRange',\n  AMOUNT_RANGE = 'amountRange',\n  OPEN_AMOUNT_RANGE = 'openAmountRange',\n}\n\nexport interface AccountSummaryDetails {\n  accountManagerEmail?: string;\n  accountManagerName?: string;\n  amountBalance?: AmountBalance;\n  billingAddress?: Address;\n  creditLimit?: string;\n  orgUnit?: B2BUnit;\n}\n\nexport interface AccountSummaryDocument {\n  id?: string;\n  orgDocumentType?: OrgDocumentType;\n  status?: DocumentStatus;\n  createdAtDate?: string;\n  dueAtDate?: string;\n  formattedAmount?: string;\n  amount?: number;\n  formattedOpenAmount?: string;\n  openAmount?: number;\n  currency?: Currency;\n  attachments?: OrgDocumentAttachment[];\n}\n\nexport interface AccountSummaryDocumentType {\n  code?: string;\n  displayInAllList?: boolean;\n  includeInOpenBalance?: boolean;\n  name?: string;\n}\n\nexport interface AccountSummaryList {\n  orgDocumentTypes?: AccountSummaryDocumentType[];\n  orgDocuments?: AccountSummaryDocument[];\n  pagination?: PaginationModel;\n  sorts?: SortModel[];\n}\n\nexport interface DocumentQueryParams {\n  page?: number;\n  pageSize?: number;\n  sort?: string;\n  fields?: DocumentFields;\n  status?: DocumentStatus;\n  startRange?: string;\n  endRange?: string;\n  filterByKey?: FilterByOptions;\n  filterByValue?: string;\n}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from './account-summary.model';\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from './blob-error.interceptor';\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from './account-summary-root.module';\nexport * from './config/index';\nexport * from './facade/index';\nexport * from './feature-name';\nexport * from './model/index';\nexport * from './http-interceptors';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}