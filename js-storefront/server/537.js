"use strict";var __defProp=Object.defineProperty,__name=(target,value)=>__defProp(target,"name",{value,configurable:!0});exports.id=537,exports.ids=[537],exports.modules={53137:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{D:()=>debounce});var _innerSubscribe__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(65814);function debounce(durationSelector){return source=>source.lift(new DebounceOperator(durationSelector))}__name(debounce,"debounce");class DebounceOperator{constructor(durationSelector){this.durationSelector=durationSelector}call(subscriber,source){return source.subscribe(new DebounceSubscriber(subscriber,this.durationSelector))}}__name(DebounceOperator,"DebounceOperator");class DebounceSubscriber extends _innerSubscribe__WEBPACK_IMPORTED_MODULE_0__.Ds{constructor(destination,durationSelector){super(destination),this.durationSelector=durationSelector,this.hasValue=!1}_next(value){try{const result=this.durationSelector.call(this,value);result&&this._tryNext(value,result)}catch(err){this.destination.error(err)}}_complete(){this.emitValue(),this.destination.complete()}_tryNext(value,duration){let subscription=this.durationSubscription;this.value=value,this.hasValue=!0,subscription&&(subscription.unsubscribe(),this.remove(subscription)),subscription=(0,_innerSubscribe__WEBPACK_IMPORTED_MODULE_0__.ft)(duration,new _innerSubscribe__WEBPACK_IMPORTED_MODULE_0__.IY(this)),subscription&&!subscription.closed&&this.add(this.durationSubscription=subscription)}notifyNext(){this.emitValue()}notifyComplete(){this.emitValue()}emitValue(){if(this.hasValue){const value=this.value,subscription=this.durationSubscription;subscription&&(this.durationSubscription=void 0,subscription.unsubscribe(),this.remove(subscription)),this.value=void 0,this.hasValue=!1,super._next(value)}}}__name(DebounceSubscriber,"DebounceSubscriber")},49352:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$:()=>cartGroup_actions,CQ:()=>CartConnector,Eu:()=>CartVoucherAdapter,F5:()=>multiCartGroup_selectors,F7:()=>isSelectiveCart,Jp:()=>CartBaseCoreModule,N4:()=>MULTI_CART_DATA,Qx:()=>ProductImportInfoService,T6:()=>getCartIdByUserId,YA:()=>CART_VALIDATION_NORMALIZER,YW:()=>CartAdapter,i4:()=>CartValidationGuard,n5:()=>CartValidationAdapter,r_:()=>CartConfigService,vI:()=>CartEntryAdapter,xb:()=>isEmpty});var _angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(40305),_spartacus_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(46167),_ngrx_store__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(91464),_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(638),rxjs_operators__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(86466),rxjs_operators__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(26942),rxjs_operators__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2155),rxjs_operators__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(37505),rxjs_operators__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(35677),rxjs_operators__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(63714),rxjs_operators__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(49320),rxjs_operators__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(2026),rxjs_operators__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(38845),rxjs_operators__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(85171),rxjs_operators__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(95426),rxjs_operators__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(33029),rxjs_operators__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(21753),rxjs_operators__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(85872),rxjs_operators__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(53137),rxjs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(66904),rxjs__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(95202),rxjs__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(31765),rxjs__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(79156),rxjs__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(20085),rxjs__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(58834),rxjs__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(76424),rxjs__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(14614),_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(48030),_spartacus_storefront__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(25907),_spartacus_user_profile_root__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(86842),_angular_common__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(89318),_angular_router__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(9664);const MULTI_CART_DATA="[Multi Cart] Multi Cart Data";class CartAddEntry extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityProcessesIncrementAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type="[Cart-entry] Add Entry"}}__name(CartAddEntry,"CartAddEntry");class CartAddEntrySuccess extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityProcessesDecrementAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type="[Cart-entry] Add Entry Success"}}__name(CartAddEntrySuccess,"CartAddEntrySuccess");class CartAddEntryFail extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityProcessesDecrementAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type="[Cart-entry] Add Entry Fail"}}__name(CartAddEntryFail,"CartAddEntryFail");class CartRemoveEntry extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityProcessesIncrementAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type="[Cart-entry] Remove Entry"}}__name(CartRemoveEntry,"CartRemoveEntry");class CartRemoveEntrySuccess extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityProcessesDecrementAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type="[Cart-entry] Remove Entry Success"}}__name(CartRemoveEntrySuccess,"CartRemoveEntrySuccess");class CartRemoveEntryFail extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityProcessesDecrementAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type="[Cart-entry] Remove Entry Fail"}}__name(CartRemoveEntryFail,"CartRemoveEntryFail");class CartUpdateEntry extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityProcessesIncrementAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type="[Cart-entry] Update Entry"}}__name(CartUpdateEntry,"CartUpdateEntry");class CartUpdateEntrySuccess extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityProcessesDecrementAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type="[Cart-entry] Update Entry Success"}}__name(CartUpdateEntrySuccess,"CartUpdateEntrySuccess");class CartUpdateEntryFail extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityProcessesDecrementAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type="[Cart-entry] Update Entry Fail"}}__name(CartUpdateEntryFail,"CartUpdateEntryFail");const CART_ADD_VOUCHER="[Cart-voucher] Add Cart Vouchers",CART_ADD_VOUCHER_SUCCESS="[Cart-voucher] Add Cart Voucher Success",CART_REMOVE_VOUCHER="[Cart-voucher] Remove Cart Voucher";class CartAddVoucher extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityLoadAction{constructor(payload){super(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.BzF,"addVoucher"),this.payload=payload,this.type=CART_ADD_VOUCHER}}__name(CartAddVoucher,"CartAddVoucher");class CartAddVoucherFail extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityFailAction{constructor(payload){super(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.BzF,"addVoucher",payload.error),this.payload=payload,this.type="[Cart-voucher] Add Cart Voucher Fail"}}__name(CartAddVoucherFail,"CartAddVoucherFail");class CartAddVoucherSuccess extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntitySuccessAction{constructor(payload){super(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.BzF,"addVoucher"),this.payload=payload,this.type=CART_ADD_VOUCHER_SUCCESS}}__name(CartAddVoucherSuccess,"CartAddVoucherSuccess");class CartResetAddVoucher extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityLoaderResetAction{constructor(){super(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.BzF,"addVoucher"),this.type="[Cart-voucher] Reset Add Cart Voucher"}}__name(CartResetAddVoucher,"CartResetAddVoucher");class CartRemoveVoucher extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityProcessesIncrementAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type=CART_REMOVE_VOUCHER}}__name(CartRemoveVoucher,"CartRemoveVoucher");class CartRemoveVoucherFail extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityProcessesDecrementAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type="[Cart-voucher] Remove Cart Voucher Fail"}}__name(CartRemoveVoucherFail,"CartRemoveVoucherFail");class CartRemoveVoucherSuccess extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityProcessesDecrementAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type="[Cart-voucher] Remove Cart Voucher Success"}}__name(CartRemoveVoucherSuccess,"CartRemoveVoucherSuccess");const CREATE_CART="[Cart] Create Cart",CREATE_CART_SUCCESS="[Cart] Create Cart Success",LOAD_CART="[Cart] Load Cart",LOAD_CART_SUCCESS="[Cart] Load Cart Success",LOAD_CARTS_SUCCESS="[Cart] Load Carts Success",REMOVE_CART="[Cart] Remove Cart",DELETE_CART="[Cart] Delete Cart",DELETE_CART_SUCCESS="[Cart] Delete Cart Success";class CreateCart extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityLoadAction{constructor(payload){super(MULTI_CART_DATA,payload.tempCartId),this.payload=payload,this.type=CREATE_CART}}__name(CreateCart,"CreateCart");class CreateCartFail extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityFailAction{constructor(payload){super(MULTI_CART_DATA,payload.tempCartId),this.payload=payload,this.type="[Cart] Create Cart Fail"}}__name(CreateCartFail,"CreateCartFail");class CreateCartSuccess extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntitySuccessAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type=CREATE_CART_SUCCESS}}__name(CreateCartSuccess,"CreateCartSuccess");class AddEmailToCart extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityProcessesIncrementAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type="[Cart] Add Email to Cart"}}__name(AddEmailToCart,"AddEmailToCart");class AddEmailToCartFail extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityProcessesDecrementAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type="[Cart] Add Email to Cart Fail"}}__name(AddEmailToCartFail,"AddEmailToCartFail");class AddEmailToCartSuccess extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityProcessesDecrementAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type="[Cart] Add Email to Cart Success"}}__name(AddEmailToCartSuccess,"AddEmailToCartSuccess");class LoadCart extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityLoadAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type=LOAD_CART}}__name(LoadCart,"LoadCart");class LoadCartFail extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityFailAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId,payload.error),this.payload=payload,this.type="[Cart] Load Cart Fail"}}__name(LoadCartFail,"LoadCartFail");class LoadCartSuccess extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntitySuccessAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type=LOAD_CART_SUCCESS}}__name(LoadCartSuccess,"LoadCartSuccess");class LoadCartsSuccess extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntitySuccessAction{constructor(payload){super(MULTI_CART_DATA,payload.map(cart=>cart?.code??"")),this.payload=payload,this.type=LOAD_CARTS_SUCCESS}}__name(LoadCartsSuccess,"LoadCartsSuccess");class MergeCart{constructor(payload){this.payload=payload,this.type="[Cart] Merge Cart"}}__name(MergeCart,"MergeCart");class MergeCartSuccess extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityRemoveAction{constructor(payload){super(MULTI_CART_DATA,payload.oldCartId),this.payload=payload,this.type="[Cart] Merge Cart Success"}}__name(MergeCartSuccess,"MergeCartSuccess");class ResetCartDetails extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.ProcessesLoaderResetAction{constructor(){super(MULTI_CART_DATA),this.type="[Cart] Reset Cart Details"}}__name(ResetCartDetails,"ResetCartDetails");class RemoveCart extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityRemoveAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type=REMOVE_CART}}__name(RemoveCart,"RemoveCart");class DeleteCart{constructor(payload){this.payload=payload,this.type=DELETE_CART}}__name(DeleteCart,"DeleteCart");class DeleteCartSuccess extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityRemoveAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type=DELETE_CART_SUCCESS}}__name(DeleteCartSuccess,"DeleteCartSuccess");class DeleteCartFail{constructor(payload){this.payload=payload,this.type="[Cart] Delete Cart Fail"}}__name(DeleteCartFail,"DeleteCartFail");const CLEAR_CART_STATE="[Cart] Clear Cart State",SET_CART_TYPE_INDEX="[Cart] Set cart type index",SET_CART_DATA="[Cart] Set cart data";class CartProcessesIncrement extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityProcessesIncrementAction{constructor(payload){super(MULTI_CART_DATA,payload),this.payload=payload,this.type="[Cart] Cart Processes Increment"}}__name(CartProcessesIncrement,"CartProcessesIncrement");class CartProcessesDecrement extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityProcessesDecrementAction{constructor(payload){super(MULTI_CART_DATA,payload),this.payload=payload,this.type="[Cart] Cart Processes Decrement"}}__name(CartProcessesDecrement,"CartProcessesDecrement");class SetActiveCartId{constructor(payload){this.payload=payload,this.type="[Cart] Set Active Cart Id"}}__name(SetActiveCartId,"SetActiveCartId");class ClearCartState extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntityRemoveAllAction{constructor(){super(MULTI_CART_DATA),this.type=CLEAR_CART_STATE}}__name(ClearCartState,"ClearCartState");class SetCartTypeIndex{constructor(payload){this.payload=payload,this.type=SET_CART_TYPE_INDEX}}__name(SetCartTypeIndex,"SetCartTypeIndex");class SetCartData extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.EntitySuccessAction{constructor(payload){super(MULTI_CART_DATA,payload.cartId),this.payload=payload,this.type=SET_CART_DATA}}__name(SetCartData,"SetCartData");var cartGroup_actions=Object.freeze({__proto__:null,ADD_EMAIL_TO_CART:"[Cart] Add Email to Cart",ADD_EMAIL_TO_CART_FAIL:"[Cart] Add Email to Cart Fail",ADD_EMAIL_TO_CART_SUCCESS:"[Cart] Add Email to Cart Success",AddEmailToCart,AddEmailToCartFail,AddEmailToCartSuccess,CART_ADD_ENTRY:"[Cart-entry] Add Entry",CART_ADD_ENTRY_FAIL:"[Cart-entry] Add Entry Fail",CART_ADD_ENTRY_SUCCESS:"[Cart-entry] Add Entry Success",CART_ADD_VOUCHER,CART_ADD_VOUCHER_FAIL:"[Cart-voucher] Add Cart Voucher Fail",CART_ADD_VOUCHER_SUCCESS,CART_PROCESSES_DECREMENT:"[Cart] Cart Processes Decrement",CART_PROCESSES_INCREMENT:"[Cart] Cart Processes Increment",CART_REMOVE_ENTRY:"[Cart-entry] Remove Entry",CART_REMOVE_ENTRY_FAIL:"[Cart-entry] Remove Entry Fail",CART_REMOVE_ENTRY_SUCCESS:"[Cart-entry] Remove Entry Success",CART_REMOVE_VOUCHER,CART_REMOVE_VOUCHER_FAIL:"[Cart-voucher] Remove Cart Voucher Fail",CART_REMOVE_VOUCHER_SUCCESS:"[Cart-voucher] Remove Cart Voucher Success",CART_RESET_ADD_VOUCHER:"[Cart-voucher] Reset Add Cart Voucher",CART_UPDATE_ENTRY:"[Cart-entry] Update Entry",CART_UPDATE_ENTRY_FAIL:"[Cart-entry] Update Entry Fail",CART_UPDATE_ENTRY_SUCCESS:"[Cart-entry] Update Entry Success",CLEAR_CART_STATE,CREATE_CART,CREATE_CART_FAIL:"[Cart] Create Cart Fail",CREATE_CART_SUCCESS,CartAddEntry,CartAddEntryFail,CartAddEntrySuccess,CartAddVoucher,CartAddVoucherFail,CartAddVoucherSuccess,CartProcessesDecrement,CartProcessesIncrement,CartRemoveEntry,CartRemoveEntryFail,CartRemoveEntrySuccess,CartRemoveVoucher,CartRemoveVoucherFail,CartRemoveVoucherSuccess,CartResetAddVoucher,CartUpdateEntry,CartUpdateEntryFail,CartUpdateEntrySuccess,ClearCartState,CreateCart,CreateCartFail,CreateCartSuccess,DELETE_CART,DELETE_CART_FAIL:"[Cart] Delete Cart Fail",DELETE_CART_SUCCESS,DeleteCart,DeleteCartFail,DeleteCartSuccess,LOAD_CART,LOAD_CARTS_SUCCESS,LOAD_CART_FAIL:"[Cart] Load Cart Fail",LOAD_CART_SUCCESS,LoadCart,LoadCartFail,LoadCartSuccess,LoadCartsSuccess,MERGE_CART:"[Cart] Merge Cart",MERGE_CART_SUCCESS:"[Cart] Merge Cart Success",MergeCart,MergeCartSuccess,REMOVE_CART,RESET_CART_DETAILS:"[Cart] Reset Cart Details",RemoveCart,ResetCartDetails,SET_ACTIVE_CART_ID:"[Cart] Set Active Cart Id",SET_CART_DATA,SET_CART_TYPE_INDEX,SetActiveCartId,SetCartData,SetCartTypeIndex});class CartEntryAdapter{}__name(CartEntryAdapter,"CartEntryAdapter");class CartEntryConnector{constructor(adapter){this.adapter=adapter}add(userId,cartId,productCode,quantity,pickupStore){return this.adapter.add(userId,cartId,productCode,quantity,pickupStore)}update(userId,cartId,entryNumber,qty,pickupStore,pickupToDelivery=!1){return this.adapter.update(userId,cartId,entryNumber,qty,pickupStore,pickupToDelivery)}remove(userId,cartId,entryNumber){return this.adapter.remove(userId,cartId,entryNumber)}}__name(CartEntryConnector,"CartEntryConnector"),CartEntryConnector.\u0275fac=__name(function(t){return new(t||CartEntryConnector)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(CartEntryAdapter))},"CartEntryConnector_Factory"),CartEntryConnector.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:CartEntryConnector,factory:CartEntryConnector.\u0275fac,providedIn:"root"});class CartEntryEffects{constructor(actions$,cartEntryConnector){this.actions$=actions$,this.cartEntryConnector=cartEntryConnector,this.contextChange$=this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.l4)(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.dO9.CURRENCY_CHANGE,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.dO9.LANGUAGE_CHANGE)),this.logger=(0,_angular_core__WEBPACK_IMPORTED_MODULE_1__.f3M)(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.mQy),this.addEntry$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.l4)("[Cart-entry] Add Entry"),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(action=>action.payload),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.b)(payload=>this.cartEntryConnector.add(payload.userId,payload.cartId,payload.productCode,payload.quantity,payload.pickupStore).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(cartModification=>new CartAddEntrySuccess({...payload,...cartModification})),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.K)(error=>(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.D)([new CartAddEntryFail({...payload,error:(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.cxH)(error,this.logger)}),new LoadCart({cartId:payload.cartId,userId:payload.userId})])))),(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.FM_)(this.contextChange$))),this.removeEntry$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.l4)("[Cart-entry] Remove Entry"),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(action=>action.payload),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.b)(payload=>this.cartEntryConnector.remove(payload.userId,payload.cartId,payload.entryNumber).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(()=>new CartRemoveEntrySuccess({...payload})),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.K)(error=>(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.D)([new CartRemoveEntryFail({...payload,error:(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.cxH)(error,this.logger)}),new LoadCart({cartId:payload.cartId,userId:payload.userId})])))),(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.FM_)(this.contextChange$))),this.updateEntry$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.l4)("[Cart-entry] Update Entry"),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(action=>action.payload),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.b)(payload=>this.cartEntryConnector.update(payload.userId,payload.cartId,payload.entryNumber,payload.quantity,payload.pickupStore,payload.pickupToDelivery).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(()=>new CartUpdateEntrySuccess({...payload})),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.K)(error=>(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.D)([new CartUpdateEntryFail({...payload,error:(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.cxH)(error,this.logger)}),new LoadCart({cartId:payload.cartId,userId:payload.userId})])))),(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.FM_)(this.contextChange$)))}}__name(CartEntryEffects,"CartEntryEffects"),CartEntryEffects.\u0275fac=__name(function(t){return new(t||CartEntryEffects)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.eX),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(CartEntryConnector))},"CartEntryEffects_Factory"),CartEntryEffects.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:CartEntryEffects,factory:CartEntryEffects.\u0275fac});class CartVoucherAdapter{}__name(CartVoucherAdapter,"CartVoucherAdapter");class CartVoucherConnector{constructor(adapter){this.adapter=adapter}add(userId,cartId,voucherId){return this.adapter.add(userId,cartId,voucherId)}remove(userId,cartId,voucherId){return this.adapter.remove(userId,cartId,voucherId)}}__name(CartVoucherConnector,"CartVoucherConnector"),CartVoucherConnector.\u0275fac=__name(function(t){return new(t||CartVoucherConnector)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(CartVoucherAdapter))},"CartVoucherConnector_Factory"),CartVoucherConnector.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:CartVoucherConnector,factory:CartVoucherConnector.\u0275fac,providedIn:"root"});class CartVoucherEffects{constructor(actions$,cartVoucherConnector,messageService){this.actions$=actions$,this.cartVoucherConnector=cartVoucherConnector,this.messageService=messageService,this.logger=(0,_angular_core__WEBPACK_IMPORTED_MODULE_1__.f3M)(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.mQy),this.addCartVoucher$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.l4)(CART_ADD_VOUCHER),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(action=>action.payload),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.zg)(payload=>this.cartVoucherConnector.add(payload.userId,payload.cartId,payload.voucherId).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(()=>(this.showGlobalMessage("voucher.applyVoucherSuccess",payload.voucherId,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.xUg.MSG_TYPE_CONFIRMATION),new CartAddVoucherSuccess({...payload}))),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.K)(error=>(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.D)([new CartAddVoucherFail({...payload,error:(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.cxH)(error,this.logger)}),new CartProcessesDecrement(payload.cartId),new LoadCart({userId:payload.userId,cartId:payload.cartId})])))))),this.removeCartVoucher$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.l4)(CART_REMOVE_VOUCHER),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(action=>action.payload),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.zg)(payload=>this.cartVoucherConnector.remove(payload.userId,payload.cartId,payload.voucherId).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(()=>(this.showGlobalMessage("voucher.removeVoucherSuccess",payload.voucherId,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.xUg.MSG_TYPE_INFO),new CartRemoveVoucherSuccess({userId:payload.userId,cartId:payload.cartId,voucherId:payload.voucherId}))),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.K)(error=>(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.D)([new CartRemoveVoucherFail({error:(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.cxH)(error,this.logger),cartId:payload.cartId,userId:payload.userId,voucherId:payload.voucherId}),new LoadCart({userId:payload.userId,cartId:payload.cartId})]))))))}showGlobalMessage(text,param,messageType){this.messageService.add({key:text,params:{voucherCode:param}},messageType)}}function getCartIdByUserId(cart,userId){return userId===_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.Fds?cart?.guid??"":cart?.code??""}function isSelectiveCart(cartId=""){return cartId.startsWith("selectivecart")}function isCartNotFoundError(error){return"notFound"===error.reason&&"cart"===error.subjectType&&!isSelectiveCart(error.subject)}function voucherExceededError(error){return"coupon.already.redeemed"===error.message}function voucherInvalidError(error){return"coupon.invalid.code.provided"===error.message}function isVoucherError(error){return"VoucherOperationError"===error.type}function isCartError(error){return"CartError"===error.type||"CartAddressError"===error.type||"CartEntryError"===error.type||"CartEntryGroupError"===error.type}function isTempCartId(cartId){return cartId.startsWith("temp-")}function isEmpty(cart){return!cart||"object"==typeof cart&&0===Object.keys(cart).length}function isEmail(str){return!!str&&!!str.match(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.QIJ)}function isJustLoggedIn(userId,previousUserId){return userId!==_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.Fds&&previousUserId!==userId}__name(CartVoucherEffects,"CartVoucherEffects"),CartVoucherEffects.\u0275fac=__name(function(t){return new(t||CartVoucherEffects)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.eX),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(CartVoucherConnector),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.IWp))},"CartVoucherEffects_Factory"),CartVoucherEffects.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:CartVoucherEffects,factory:CartVoucherEffects.\u0275fac}),__name(getCartIdByUserId,"getCartIdByUserId"),__name(isSelectiveCart,"isSelectiveCart"),__name(isCartNotFoundError,"isCartNotFoundError"),__name(voucherExceededError,"voucherExceededError"),__name(voucherInvalidError,"voucherInvalidError"),__name(isVoucherError,"isVoucherError"),__name(isCartError,"isCartError"),__name(isTempCartId,"isTempCartId"),__name(isEmpty,"isEmpty"),__name(isEmail,"isEmail"),__name(isJustLoggedIn,"isJustLoggedIn");const getMultiCartState=(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.ZF)("cart"),getMultiCartEntities=(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.P1)(getMultiCartState,state=>state.carts),getCartEntitySelectorFactory=__name(cartId=>(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.P1)(getMultiCartEntities,state=>_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.entityProcessesLoaderStateSelector(state,cartId)),"getCartEntitySelectorFactory"),getCartSelectorFactory=__name(cartId=>(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.P1)(getMultiCartEntities,state=>_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.entityValueSelector(state,cartId)),"getCartSelectorFactory"),getCartIsStableSelectorFactory=__name(cartId=>(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.P1)(getMultiCartEntities,state=>_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.entityIsStableSelector(state,cartId)),"getCartIsStableSelectorFactory"),getCartHasPendingProcessesSelectorFactory=__name(cartId=>(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.P1)(getMultiCartEntities,state=>_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.entityHasPendingProcessesSelector(state,cartId)),"getCartHasPendingProcessesSelectorFactory"),getCartEntriesSelectorFactory=__name(cartId=>(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.P1)(getCartSelectorFactory(cartId),state=>state&&state.entries?state.entries:[]),"getCartEntriesSelectorFactory"),getCartEntrySelectorFactory=__name((cartId,productCode)=>(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.P1)(getCartEntriesSelectorFactory(cartId),state=>state.find(entry=>entry.product?.code===productCode)),"getCartEntrySelectorFactory"),getCartsSelectorFactory=(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.P1)(getMultiCartEntities,state=>Object.keys(state.entities).map(key=>_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.entityValueSelector(state,key))),getCartTypeIndex=(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.P1)(getMultiCartState,state=>state.index),getCartIdByTypeFactory=__name(type=>(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.P1)(getCartTypeIndex,state=>state&&state[type]),"getCartIdByTypeFactory");class CartAdapter{}__name(CartAdapter,"CartAdapter");class CartConnector{constructor(adapter){this.adapter=adapter}loadAll(userId){return this.adapter.loadAll(userId)}load(userId,cartId){return this.adapter.load(userId,cartId)}create(userId,oldCartId,toMergeCartGuid){return this.adapter.create(userId,oldCartId,toMergeCartGuid)}delete(userId,cartId){return this.adapter.delete(userId,cartId)}save(userId,cartId,saveCartName,saveCartDescription){return this.adapter.save(userId,cartId,saveCartName,saveCartDescription)}addEmail(userId,cartId,email){return this.adapter.addEmail(userId,cartId,email)}}__name(CartConnector,"CartConnector"),CartConnector.\u0275fac=__name(function(t){return new(t||CartConnector)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(CartAdapter))},"CartConnector_Factory"),CartConnector.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:CartConnector,factory:CartConnector.\u0275fac,providedIn:"root"});class CartEffects{handleLoadCartError(payload,error){if(error?.error?.errors){if(error.error.errors.filter(err=>"invalid"===err.reason).length>0)return(0,rxjs__WEBPACK_IMPORTED_MODULE_9__.of)(new LoadCart({...payload}));if(error.error.errors.filter(err=>isCartNotFoundError(err)||"UnknownResourceError"===err.reason).length>0)return(0,rxjs__WEBPACK_IMPORTED_MODULE_9__.of)(new RemoveCart({cartId:payload.cartId}))}return(0,rxjs__WEBPACK_IMPORTED_MODULE_9__.of)(new LoadCartFail({...payload,error:(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.cxH)(error,this.logger)}))}constructor(actions$,cartConnector,store){this.actions$=actions$,this.cartConnector=cartConnector,this.store=store,this.contextChange$=this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.l4)(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.dO9.CURRENCY_CHANGE,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.dO9.LANGUAGE_CHANGE)),this.logger=(0,_angular_core__WEBPACK_IMPORTED_MODULE_1__.f3M)(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.mQy),this.loadCart$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.l4)(LOAD_CART),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(action=>action.payload),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_10__.v)(payload=>payload.cartId),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.zg)(group$=>group$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(payload=>(0,rxjs__WEBPACK_IMPORTED_MODULE_9__.of)(payload).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.M)(this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.Ys)(getCartHasPendingProcessesSelectorFactory(payload.cartId)))))),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(([_,hasPendingProcesses])=>!hasPendingProcesses),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(([payload])=>payload),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(payload=>this.cartConnector.load(payload.userId,payload.cartId).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.zg)(cart=>{let actions=[];return cart?(actions.push(new LoadCartSuccess({...payload,cart,cartId:getCartIdByUserId(cart,payload.userId)})),payload.cartId===_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.gSv&&actions.push(new RemoveCart({cartId:_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.gSv}))):actions=[new LoadCartFail({...payload,error:{}})],actions}),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.K)(error=>this.handleLoadCartError(payload,error)))))),(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.FM_)(this.contextChange$))),this.createCart$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.l4)(CREATE_CART),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(action=>action.payload),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.zg)(payload=>this.cartConnector.create(payload.userId,payload.oldCartId,payload.toMergeCartGuid).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(cart=>{const conditionalActions=[];return payload.oldCartId&&conditionalActions.push(new MergeCartSuccess({extraData:payload.extraData,userId:payload.userId,tempCartId:payload.tempCartId,cartId:getCartIdByUserId(cart,payload.userId),oldCartId:payload.oldCartId})),[new CreateCartSuccess({...payload,cart,cartId:getCartIdByUserId(cart,payload.userId)}),new RemoveCart({cartId:payload.tempCartId}),...conditionalActions]}),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.K)(error=>(0,rxjs__WEBPACK_IMPORTED_MODULE_9__.of)(new CreateCartFail({...payload,error:(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.cxH)(error,this.logger)}))))),(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.FM_)(this.contextChange$))),this.mergeCart$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.l4)("[Cart] Merge Cart"),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(action=>action.payload),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(payload=>this.cartConnector.load(payload.userId,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.gSv).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(currentCart=>{if(currentCart?.code!==payload.cartId)return new CreateCart({userId:payload.userId,oldCartId:payload.cartId,toMergeCartGuid:currentCart?currentCart.guid:void 0,extraData:payload.extraData,tempCartId:payload.tempCartId})}),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.pTN))),(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.FM_)(this.contextChange$))),this.refresh$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.l4)(CART_ADD_VOUCHER_SUCCESS),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(action=>action.payload),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.b)(payload=>(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.D)([new CartProcessesDecrement(payload.cartId),new LoadCart({userId:payload.userId,cartId:payload.cartId})])))),this.refreshWithoutProcesses$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.l4)("[Cart-entry] Add Entry Success","[Cart-entry] Remove Entry Success","[Cart-entry] Update Entry Success","[Cart-voucher] Remove Cart Voucher Success"),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(action=>action.payload),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(payload=>new LoadCart({userId:payload.userId,cartId:payload.cartId})))),this.resetCartDetailsOnSiteContextChange$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.l4)(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.dO9.LANGUAGE_CHANGE,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.dO9.CURRENCY_CHANGE),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.zg)(()=>[new ResetCartDetails]))),this.addEmail$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.l4)("[Cart] Add Email to Cart"),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(action=>action.payload),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.zg)(payload=>this.cartConnector.addEmail(payload.userId,payload.cartId,payload.email).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.zg)(()=>[new AddEmailToCartSuccess({...payload}),new LoadCart({userId:payload.userId,cartId:payload.cartId})]),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.K)(error=>(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.D)([new AddEmailToCartFail({...payload,error:(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.cxH)(error,this.logger)}),new LoadCart({userId:payload.userId,cartId:payload.cartId})])))),(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.FM_)(this.contextChange$))),this.deleteCart$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.l4)(DELETE_CART),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(action=>action.payload),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.zg)(payload=>this.cartConnector.delete(payload.userId,payload.cartId).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(()=>new DeleteCartSuccess({...payload})),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.K)(error=>(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.D)([new DeleteCartFail({...payload,error:(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.cxH)(error,this.logger)}),new LoadCart({...payload})]))))))}}__name(CartEffects,"CartEffects"),CartEffects.\u0275fac=__name(function(t){return new(t||CartEffects)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.eX),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(CartConnector),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.yh))},"CartEffects_Factory"),CartEffects.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:CartEffects,factory:CartEffects.\u0275fac});class MultiCartEffectsService{getActiveCartTypeOnLoadSuccess(action){if(action?.payload?.extraData?.active)return action.payload?.cart.saveTime?new SetCartTypeIndex({cartType:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.EI.ACTIVE,cartId:""}):new SetCartTypeIndex({cartType:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.EI.ACTIVE,cartId:action.meta.entityId})}}__name(MultiCartEffectsService,"MultiCartEffectsService"),MultiCartEffectsService.\u0275fac=__name(function(t){return new(t||MultiCartEffectsService)},"MultiCartEffectsService_Factory"),MultiCartEffectsService.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:MultiCartEffectsService,factory:MultiCartEffectsService.\u0275fac});class MultiCartEffects{getActiveCartTypeOnLoad(action){if(action?.payload?.cartId===_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.gSv)return new SetCartTypeIndex({cartType:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.EI.ACTIVE,cartId:""})}getActiveCartTypeOnLoadSuccess(action){return this.multiCartEffectsService.getActiveCartTypeOnLoadSuccess(action)}getActiveCartTypeOnCreate(action){if(action?.payload?.extraData?.active)return new SetCartTypeIndex({cartType:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.EI.ACTIVE,cartId:action.meta.entityId})}constructor(actions$,multiCartEffectsService){this.actions$=actions$,this.multiCartEffectsService=multiCartEffectsService,this.processesIncrement$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.l4)(CART_ADD_VOUCHER),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(action=>action.payload),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(payload=>new CartProcessesIncrement(payload.cartId)))),this.setSelectiveId$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.l4)(LOAD_CART_SUCCESS),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(action=>{switch(action.type){case LOAD_CART_SUCCESS:{const payload=action.payload;if(isSelectiveCart(payload.cartId))return new SetCartTypeIndex({cartType:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.EI.SELECTIVE,cartId:payload.cartId});break}}}),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.pTN))),this.setActiveCartId$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.l4)(LOAD_CART_SUCCESS,LOAD_CART,CREATE_CART_SUCCESS,CREATE_CART,"[Cart] Set Active Cart Id"),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(action=>{switch(action.type){case LOAD_CART:return this.getActiveCartTypeOnLoad(action);case LOAD_CART_SUCCESS:return this.getActiveCartTypeOnLoadSuccess(action);case CREATE_CART:return this.getActiveCartTypeOnCreate(action);case CREATE_CART_SUCCESS:return new SetCartTypeIndex({cartType:action?.payload?.extraData?.active?_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.EI.ACTIVE:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.EI.NEW_CREATED,cartId:action.meta.entityId});case"[Cart] Set Active Cart Id":return new SetCartTypeIndex({cartType:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.EI.ACTIVE,cartId:action.payload})}}),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.pTN)))}}__name(MultiCartEffects,"MultiCartEffects"),MultiCartEffects.\u0275fac=__name(function(t){return new(t||MultiCartEffects)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.eX),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(MultiCartEffectsService))},"MultiCartEffects_Factory"),MultiCartEffects.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:MultiCartEffects,factory:MultiCartEffects.\u0275fac});const effects=[CartEntryEffects,CartVoucherEffects,CartEffects,MultiCartEffects],cartTypeIndexInitialState={[_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.EI.ACTIVE]:""};function cartTypeIndexReducer(state=cartTypeIndexInitialState,action){switch(action.type){case SET_CART_TYPE_INDEX:return{...state,[action.payload.cartType]:action.payload.cartId};case REMOVE_CART:case DELETE_CART_SUCCESS:return action.payload?.cartId===state[_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.EI.ACTIVE]?{...state,[_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.EI.ACTIVE]:""}:state;case CLEAR_CART_STATE:return cartTypeIndexInitialState}return state}__name(cartTypeIndexReducer,"cartTypeIndexReducer");const cartEntitiesInitialState=void 0;function cartEntitiesReducer(state=cartEntitiesInitialState,action){switch(action.type){case LOAD_CARTS_SUCCESS:return action.payload;case LOAD_CART_SUCCESS:case CREATE_CART_SUCCESS:case SET_CART_DATA:return action.payload.cart}return state}function clearMultiCartState(reducer){return function(state,action){return action.type===_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.uQL.LOGOUT&&(state=void 0),reducer(state,action)}}__name(cartEntitiesReducer,"cartEntitiesReducer"),__name(clearMultiCartState,"clearMultiCartState");const multiCartMetaReducers=[clearMultiCartState],multiCartReducerToken=new _angular_core__WEBPACK_IMPORTED_MODULE_1__.OlP("MultiCartReducers");function getMultiCartReducers(){return{carts:_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kPG.entityProcessesLoaderReducer(MULTI_CART_DATA,cartEntitiesReducer),index:cartTypeIndexReducer}}__name(getMultiCartReducers,"getMultiCartReducers");const multiCartReducerProvider={provide:multiCartReducerToken,useFactory:getMultiCartReducers};var multiCartGroup_selectors=Object.freeze({__proto__:null,getCartEntitySelectorFactory,getCartEntriesSelectorFactory,getCartEntrySelectorFactory,getCartHasPendingProcessesSelectorFactory,getCartIdByTypeFactory,getCartIsStableSelectorFactory,getCartSelectorFactory,getCartTypeIndex,getCartsSelectorFactory,getMultiCartEntities,getMultiCartState});class MultiCartStatePersistenceService{constructor(statePersistenceService,store,siteContextParamsService){this.statePersistenceService=statePersistenceService,this.store=store,this.siteContextParamsService=siteContextParamsService,this.subscription=new rxjs__WEBPACK_IMPORTED_MODULE_15__.w}initSync(){this.subscription.add(this.statePersistenceService.syncWithStorage({key:"cart",state$:this.getCartState(),context$:this.siteContextParamsService.getValues([_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.iEg]),storageType:_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.iHd.LOCAL_STORAGE,onRead:state=>this.onRead(state)}))}getCartState(){return this.store.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(store=>!!store.cart),(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.Ys)(getMultiCartState),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(state=>!!state),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(state=>state.index),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_16__.g)("Active"),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(indexState=>({active:indexState[_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.EI.ACTIVE]??""})))}onRead(state){this.store.dispatch(new ClearCartState),state?this.store.dispatch(new SetActiveCartId(state.active)):this.store.dispatch(new SetActiveCartId(""))}ngOnDestroy(){this.subscription.unsubscribe()}}function cartStatePersistenceFactory(cartStatePersistenceService,configInit){return __name(()=>configInit.getStable("context").pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_17__.b)(()=>{cartStatePersistenceService.initSync()})).toPromise(),"result")}function uninitializeActiveCartMetaReducerFactory(){return __name(reducer=>(state,action)=>{const newState={...state};return"@ngrx/store/init"===action.type&&(newState.cart={...newState.cart,index:{[_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.EI.ACTIVE]:void 0}}),reducer(newState,action)},"metaReducer")}__name(MultiCartStatePersistenceService,"MultiCartStatePersistenceService"),MultiCartStatePersistenceService.\u0275fac=__name(function(t){return new(t||MultiCartStatePersistenceService)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.WBb),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.yh),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.Qnj))},"MultiCartStatePersistenceService_Factory"),MultiCartStatePersistenceService.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:MultiCartStatePersistenceService,factory:MultiCartStatePersistenceService.\u0275fac,providedIn:"root"}),__name(cartStatePersistenceFactory,"cartStatePersistenceFactory"),__name(uninitializeActiveCartMetaReducerFactory,"uninitializeActiveCartMetaReducerFactory");class CartPersistenceModule{}__name(CartPersistenceModule,"CartPersistenceModule"),CartPersistenceModule.\u0275fac=__name(function(t){return new(t||CartPersistenceModule)},"CartPersistenceModule_Factory"),CartPersistenceModule.\u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_1__.oAB({type:CartPersistenceModule}),CartPersistenceModule.\u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_1__.cJS({providers:[{provide:_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.z4I,useFactory:cartStatePersistenceFactory,deps:[MultiCartStatePersistenceService,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.yUt],multi:!0},{provide:_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.sr,useFactory:uninitializeActiveCartMetaReducerFactory,multi:!0}]});class CartValidationAdapter{}__name(CartValidationAdapter,"CartValidationAdapter");class CartValidationConnector{constructor(adapter){this.adapter=adapter}validate(cartId,userId){return this.adapter.validate(cartId,userId)}}__name(CartValidationConnector,"CartValidationConnector"),CartValidationConnector.\u0275fac=__name(function(t){return new(t||CartValidationConnector)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(CartValidationAdapter))},"CartValidationConnector_Factory"),CartValidationConnector.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:CartValidationConnector,factory:CartValidationConnector.\u0275fac,providedIn:"root"});class CartEventBuilder{constructor(actionsSubject,event,activeCartService,stateEventService){this.actionsSubject=actionsSubject,this.event=event,this.activeCartService=activeCartService,this.stateEventService=stateEventService,this.register()}register(){this.registerCreateCart(),this.registerAddEntry(),this.registerRemoveEntry(),this.registerUpdateEntry(),this.registerDeleteCart(),this.registerAddCartVoucher(),this.registerRemoveCartVoucher(),this.registerMergeCartSuccess()}registerAddEntry(){this.registerMapped({action:"[Cart-entry] Add Entry",event:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.uP}),this.registerMapped({action:"[Cart-entry] Add Entry Success",event:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.VD}),this.registerMapped({action:"[Cart-entry] Add Entry Fail",event:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.K$})}registerRemoveEntry(){this.registerMapped({action:"[Cart-entry] Remove Entry Success",event:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.A7}),this.registerMapped({action:"[Cart-entry] Remove Entry Fail",event:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.dC})}registerUpdateEntry(){this.registerMapped({action:"[Cart-entry] Update Entry Success",event:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.X}),this.registerMapped({action:"[Cart-entry] Update Entry Fail",event:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.gI})}registerMergeCartSuccess(){this.registerMapped({action:"[Cart] Merge Cart Success",event:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.pA})}registerCreateCart(){this.stateEventService.register({action:CREATE_CART,event:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.su}),this.stateEventService.register({action:CREATE_CART_SUCCESS,event:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.cA}),this.stateEventService.register({action:"[Cart] Create Cart Fail",event:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.Cj})}registerDeleteCart(){this.stateEventService.register({action:DELETE_CART,event:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.aY,factory:action=>(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.PjU)(_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.aY,{...action.payload,cartCode:action.payload.cartId})}),this.stateEventService.register({action:DELETE_CART_SUCCESS,event:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.N0,factory:action=>(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.PjU)(_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.N0,{...action.payload,cartCode:action.payload.cartId})}),this.stateEventService.register({action:"[Cart] Delete Cart Fail",event:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.Ks,factory:action=>(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.PjU)(_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.Ks,{...action.payload,cartCode:action.payload.cartId})})}registerAddCartVoucher(){this.stateEventService.register({action:CART_ADD_VOUCHER,event:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.aT}),this.stateEventService.register({action:CART_ADD_VOUCHER_SUCCESS,event:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.Es}),this.stateEventService.register({action:"[Cart-voucher] Add Cart Voucher Fail",event:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.re})}registerRemoveCartVoucher(){this.stateEventService.register({action:CART_REMOVE_VOUCHER,event:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.uX}),this.stateEventService.register({action:"[Cart-voucher] Remove Cart Voucher Success",event:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.FC}),this.stateEventService.register({action:"[Cart-voucher] Remove Cart Voucher Fail",event:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.kd})}registerMapped(mapping){const eventStream$=this.getAction(mapping.action).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(action=>(0,rxjs__WEBPACK_IMPORTED_MODULE_9__.of)(action).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.M)(this.activeCartService.getActive(),this.activeCartService.getActiveCartId()))),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(([action,_activeCart,activeCartId])=>action.payload.cartId===activeCartId),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(([action,activeCart])=>(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.PjU)(mapping.event,{...action.payload,cartCode:activeCart.code,entry:action.payload.entry?action.payload.entry:activeCart.entries?.[Number(action.payload.entryNumber)]})));return this.event.register(mapping.event,eventStream$)}getAction(actionType){return this.actionsSubject.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.l4)(...[].concat(actionType)))}}__name(CartEventBuilder,"CartEventBuilder"),CartEventBuilder.\u0275fac=__name(function(t){return new(t||CartEventBuilder)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.UO),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.POd),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.bu),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.vL$))},"CartEventBuilder_Factory"),CartEventBuilder.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:CartEventBuilder,factory:CartEventBuilder.\u0275fac,providedIn:"root"});class CartEventModule{constructor(_CartEventBuilder){}}__name(CartEventModule,"CartEventModule"),CartEventModule.\u0275fac=__name(function(t){return new(t||CartEventModule)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(CartEventBuilder))},"CartEventModule_Factory"),CartEventModule.\u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_1__.oAB({type:CartEventModule}),CartEventModule.\u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_1__.cJS({});class CartPageEventBuilder{constructor(eventService){this.eventService=eventService,this.register()}register(){this.eventService.register(_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.uB,this.buildCartPageEvent())}buildCartPageEvent(){return this.eventService.get(_spartacus_storefront__WEBPACK_IMPORTED_MODULE_18__.z4w).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(navigationEvent=>"cart"===navigationEvent.semanticRoute),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(navigationEvent=>(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.PjU)(_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.uB,{navigation:navigationEvent})))}}__name(CartPageEventBuilder,"CartPageEventBuilder"),CartPageEventBuilder.\u0275fac=__name(function(t){return new(t||CartPageEventBuilder)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.POd))},"CartPageEventBuilder_Factory"),CartPageEventBuilder.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:CartPageEventBuilder,factory:CartPageEventBuilder.\u0275fac,providedIn:"root"});class CartPageEventModule{constructor(_cartPageEventBuilder){}}__name(CartPageEventModule,"CartPageEventModule"),CartPageEventModule.\u0275fac=__name(function(t){return new(t||CartPageEventModule)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(CartPageEventBuilder))},"CartPageEventModule_Factory"),CartPageEventModule.\u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_1__.oAB({type:CartPageEventModule}),CartPageEventModule.\u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_1__.cJS({});class ActiveCartService{constructor(multiCartFacade,userIdService,winRef){this.multiCartFacade=multiCartFacade,this.userIdService=userIdService,this.winRef=winRef,this.subscription=new rxjs__WEBPACK_IMPORTED_MODULE_15__.w,this.activeCartId$=this.userIdService.getUserId().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_19__.q)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(()=>this.multiCartFacade.getCartIdByType(_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.EI.ACTIVE)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(cartId=>void 0!==cartId),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(cartId=>""===cartId?_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.gSv:cartId)),this.cartEntity$=this.activeCartId$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(cartId=>this.multiCartFacade.getCartEntity(cartId))),this.shouldLoadCartOnCodeFlow=!0,this.checkInitLoad=void 0,this.initActiveCart(),this.detectUserChange()}initActiveCart(){const cartValue$=this.cartEntity$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(cartEntity=>({cart:cartEntity.value,isStable:!cartEntity.loading&&0===cartEntity.processesCount,loaded:Boolean((cartEntity.error||cartEntity.success)&&!cartEntity.loading)})),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(({isStable,cart})=>isStable||isEmpty(cart))),loading=cartValue$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.M)(this.activeCartId$,this.userIdService.getUserId()),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_17__.b)(([{cart,loaded,isStable},cartId,userId])=>{isStable&&isEmpty(cart)&&!loaded&&!isTempCartId(cartId)&&this.shouldLoadCartOnCodeFlow&&this.load(cartId,userId)}));this.activeCart$=(0,rxjs__WEBPACK_IMPORTED_MODULE_20__.g)(()=>loading.subscribe(),()=>cartValue$).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(({cart})=>cart||{}),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_21__.x)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_22__.d)({bufferSize:1,refCount:!0}))}detectUserChange(){this.subscription.add(this.userIdService.getUserId().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_23__.G)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.M)(this.activeCartId$)).subscribe(([[previousUserId,userId],cartId])=>{isJustLoggedIn(userId,previousUserId)&&this.loadOrMerge(cartId,userId,previousUserId)})),this.isLoggedInWithCodeFlow()&&(this.shouldLoadCartOnCodeFlow=!1,this.subscription.add(this.userIdService.getUserId().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.M)(this.activeCartId$)).subscribe(([userId,cartId])=>{this.loadOrMerge(cartId,userId,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.Fds),this.winRef?.localStorage?.removeItem(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.VXE)})))}getActive(){return this.activeCart$}takeActive(){return this.isStable().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(isStable=>isStable),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(()=>this.getActive()),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(cart=>!!cart),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_19__.q)(1))}getActiveCartId(){return this.activeCart$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.M)(this.userIdService.getUserId()),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(([cart,userId])=>getCartIdByUserId(cart,userId)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_21__.x)())}takeActiveCartId(){return this.isStable().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(isStable=>isStable),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(()=>this.getActiveCartId()),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(cartId=>!!cartId),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_19__.q)(1))}getEntries(){return this.activeCartId$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(cartId=>this.multiCartFacade.getEntries(cartId)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_21__.x)())}getLastEntry(productCode){return this.activeCartId$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(cartId=>this.multiCartFacade.getLastEntry(cartId,productCode)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_21__.x)())}getLoading(){return this.cartEntity$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(cartEntity=>Boolean(cartEntity.loading)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_21__.x)())}isStable(){return this.activeCartId$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(cartId=>this.multiCartFacade.isStable(cartId)))}load(cartId,userId){userId===_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.Fds&&cartId===_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.gSv||this.multiCartFacade.loadCart({userId,cartId,extraData:{active:!0}})}loadOrMerge(cartId,userId,previousUserId){cartId===_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.gSv||previousUserId!==_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.Fds?this.multiCartFacade.loadCart({userId,cartId,extraData:{active:!0}}):Boolean((0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.P51)(this.isGuestCart()))?this.guestCartMerge(cartId):this.multiCartFacade.mergeToCurrentCart({userId,cartId,extraData:{active:!0}})}guestCartMerge(cartId){this.getEntries().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_19__.q)(1)).subscribe(entries=>{this.multiCartFacade.deleteCart(cartId,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.Fds),this.addEntriesGuestMerge(entries)})}addEntriesGuestMerge(cartEntries){const entriesToAdd=cartEntries.map(entry=>({productCode:entry.product?.code??"",quantity:entry.quantity??0}));this.requireLoadedCart(!0).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.M)(this.userIdService.getUserId())).subscribe(([cart,userId])=>{this.multiCartFacade.addEntries(userId,getCartIdByUserId(cart,userId),entriesToAdd)})}isCartCreating(cartState,cartId){return isTempCartId(cartId)&&(cartState.loading||cartState.success||cartState.error)}isLoggedInWithCodeFlow(){return!!this.winRef?.localStorage?.getItem(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.VXE)}requireLoadedCart(forGuestMerge=!1){this.checkInitLoad=void 0===this.checkInitLoad;const cartSelector$=(forGuestMerge?this.cartEntity$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(()=>!Boolean((0,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.P51)(this.isGuestCart())))):this.cartEntity$).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(cartState=>!cartState.loading||!!this.checkInitLoad));return this.activeCartId$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.M)(cartSelector$),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(([cartId,cartState])=>!this.isCartCreating(cartState,cartId)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(([,cartState])=>cartState),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_19__.q)(1)).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.M)(this.userIdService.getUserId()),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_17__.b)(([cartState,userId])=>{isEmpty(cartState.value)&&userId!==_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.Fds&&!cartState.loading&&this.load(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.gSv,userId),this.checkInitLoad=!1}),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(()=>cartSelector$),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.M)(this.userIdService.getUserId()),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(([cartState,userId])=>Boolean(userId===_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.Fds||cartState.success||cartState.error)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_19__.q)(1)).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_17__.b)(([cartState,userId])=>{isEmpty(cartState.value)&&this.multiCartFacade.createCart({userId,extraData:{active:!0}})}),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(()=>cartSelector$),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(cartState=>Boolean(cartState.success||cartState.error)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.M)(this.activeCartId$),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(([cartState,cartId])=>!this.isCartCreating(cartState,cartId)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(([cartState])=>cartState.value),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(cart=>!isEmpty(cart)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_19__.q)(1))}addEntry(productCode,quantity,pickupStore){this.requireLoadedCart().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.M)(this.userIdService.getUserId())).subscribe(([cart,userId])=>{this.multiCartFacade.addEntry(userId,getCartIdByUserId(cart,userId),productCode,quantity,pickupStore)})}removeEntry(entry){this.activeCartId$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.M)(this.userIdService.getUserId()),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_19__.q)(1)).subscribe(([cartId,userId])=>{this.multiCartFacade.removeEntry(userId,cartId,entry.entryNumber)})}updateEntry(entryNumber,quantity,pickupStore,pickupToDelivery=!1){this.activeCartId$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.M)(this.userIdService.getUserId()),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_19__.q)(1)).subscribe(([cartId,userId])=>{this.multiCartFacade.updateEntry(userId,cartId,entryNumber,quantity,pickupStore,pickupToDelivery)})}getEntry(productCode){return this.activeCartId$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(cartId=>this.multiCartFacade.getEntry(cartId,productCode)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_21__.x)())}addEmail(email){this.activeCartId$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.M)(this.userIdService.getUserId()),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_19__.q)(1)).subscribe(([cartId,userId])=>{this.multiCartFacade.assignEmail(cartId,userId,email)})}getAssignedUser(){return this.activeCart$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(cart=>cart.user))}isGuestCart(cart){return cart?(0,rxjs__WEBPACK_IMPORTED_MODULE_9__.of)(this.isCartUserGuest(cart)):this.activeCart$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(activeCart=>this.isCartUserGuest(activeCart)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_21__.x)())}isCartUserGuest(cart){const cartUser=cart.user;return Boolean(cartUser&&(cartUser.name===_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.YI5||isEmail(cartUser.uid?.split("|").slice(1).join("|"))))}addEntries(cartEntries){const entriesToAdd=cartEntries.map(entry=>({productCode:entry.product?.code??"",quantity:entry.quantity??0}));this.requireLoadedCart().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.M)(this.userIdService.getUserId())).subscribe(([cart,userId])=>{cart&&this.multiCartFacade.addEntries(userId,getCartIdByUserId(cart,userId),entriesToAdd)})}reloadActiveCart(){(0,rxjs__WEBPACK_IMPORTED_MODULE_24__.aj)([this.getActiveCartId(),this.userIdService.takeUserId()]).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_19__.q)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(([cartId,userId])=>{this.multiCartFacade.loadCart({cartId,userId,extraData:{active:!0}})})).subscribe()}hasPickupItems(){return this.getActive().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(cart=>!!cart.pickupItemsQuantity&&cart.pickupItemsQuantity>0))}hasDeliveryItems(){return this.getActive().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(cart=>!!cart.deliveryItemsQuantity&&cart.deliveryItemsQuantity>0))}getPickupEntries(){return this.getEntries().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(entries=>entries.filter(entry=>void 0!==entry.deliveryPointOfService)))}getDeliveryEntries(){return this.getEntries().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(entries=>entries.filter(entry=>void 0===entry.deliveryPointOfService)))}ngOnDestroy(){this.subscription.unsubscribe()}}__name(ActiveCartService,"ActiveCartService"),ActiveCartService.\u0275fac=__name(function(t){return new(t||ActiveCartService)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.WT),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.XBV),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.X9E,8))},"ActiveCartService_Factory"),ActiveCartService.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:ActiveCartService,factory:ActiveCartService.\u0275fac});class CartValidationStateService{constructor(routingService){this.routingService=routingService,this.NAVIGATION_SKIPS=2,this.navigationIdCount=0,this.subscription=new rxjs__WEBPACK_IMPORTED_MODULE_15__.w,this.cartValidationResult$=new rxjs__WEBPACK_IMPORTED_MODULE_25__.t(1),this.checkForValidationResultClear$=this.routingService.getRouterState().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.M)(this.cartValidationResult$),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_17__.b)(([routerState,cartModifications])=>{this.navigationIdCount+this.NAVIGATION_SKIPS<=routerState.navigationId&&cartModifications.length&&(this.cartValidationResult$.next([]),this.navigationIdCount=routerState.navigationId)})),this.setInitialState()}ngOnDestroy(){this.subscription.unsubscribe()}setInitialState(){this.setNavigationIdStep(),this.subscription.add(this.checkForValidationResultClear$.subscribe())}updateValidationResultAndRoutingId(cartModification){this.cartValidationResult$.next(cartModification),this.setNavigationIdStep()}setNavigationIdStep(){this.routingService.getRouterState().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_19__.q)(1)).subscribe(routerState=>this.navigationIdCount=routerState.navigationId)}}__name(CartValidationStateService,"CartValidationStateService"),CartValidationStateService.\u0275fac=__name(function(t){return new(t||CartValidationStateService)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.Znh))},"CartValidationStateService_Factory"),CartValidationStateService.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:CartValidationStateService,factory:CartValidationStateService.\u0275fac,providedIn:"root"});class CartValidationService{constructor(cartValidationConnector,command,userIdService,activeCartFacade,cartValidationStateService){this.cartValidationConnector=cartValidationConnector,this.command=command,this.userIdService=userIdService,this.activeCartFacade=activeCartFacade,this.cartValidationStateService=cartValidationStateService,this.validateCartCommand=this.command.create(()=>(0,rxjs__WEBPACK_IMPORTED_MODULE_24__.aj)([this.activeCartFacade.getActiveCartId(),this.userIdService.takeUserId(),this.activeCartFacade.isStable()]).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(([_,__,loaded])=>loaded),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_19__.q)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(([cartId,userId])=>this.cartValidationConnector.validate(cartId,userId))),{strategy:_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.flE.CancelPrevious})}validateCart(){return this.validateCartCommand.execute()}getValidationResults(){return this.cartValidationStateService.cartValidationResult$}}__name(CartValidationService,"CartValidationService"),CartValidationService.\u0275fac=__name(function(t){return new(t||CartValidationService)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(CartValidationConnector),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.VDr),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.XBV),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.bu),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(CartValidationStateService))},"CartValidationService_Factory"),CartValidationService.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:CartValidationService,factory:CartValidationService.\u0275fac});class CartVoucherService{constructor(store,activeCartFacade,userIdService){this.store=store,this.activeCartFacade=activeCartFacade,this.userIdService=userIdService}addVoucher(voucherId,cartId){this.combineUserAndCartId(cartId).subscribe(([occUserId,cartIdentifier])=>this.store.dispatch(new CartAddVoucher({userId:occUserId,cartId:cartIdentifier,voucherId})))}removeVoucher(voucherId,cartId){this.combineUserAndCartId(cartId).subscribe(([occUserId,cartIdentifier])=>this.store.dispatch(new CartRemoveVoucher({userId:occUserId,cartId:cartIdentifier,voucherId})))}getAddVoucherResultError(){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.Ys)(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.VkE.getProcessErrorFactory("addVoucher")))}getAddVoucherResultSuccess(){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.Ys)(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.VkE.getProcessSuccessFactory("addVoucher")))}getAddVoucherResultLoading(){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.Ys)(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.VkE.getProcessLoadingFactory("addVoucher")))}resetAddVoucherProcessingState(){this.store.dispatch(new CartResetAddVoucher)}combineUserAndCartId(cartId){return cartId?this.userIdService.getUserId().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_19__.q)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(userId=>[userId,cartId])):(0,rxjs__WEBPACK_IMPORTED_MODULE_24__.aj)([this.userIdService.getUserId(),this.activeCartFacade.getActiveCartId()]).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_19__.q)(1))}}__name(CartVoucherService,"CartVoucherService"),CartVoucherService.\u0275fac=__name(function(t){return new(t||CartVoucherService)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.yh),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.bu),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.XBV))},"CartVoucherService_Factory"),CartVoucherService.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:CartVoucherService,factory:CartVoucherService.\u0275fac});class MultiCartService{constructor(store,userIdService){this.store=store,this.userIdService=userIdService}getCart(cartId){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.Ys)(getCartSelectorFactory(cartId)))}getCarts(){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.Ys)(getCartsSelectorFactory))}getCartEntity(cartId){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.Ys)(getCartEntitySelectorFactory(cartId)))}isStable(cartId){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.Ys)(getCartIsStableSelectorFactory(cartId)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_26__.D)(isStable=>isStable?(0,rxjs__WEBPACK_IMPORTED_MODULE_27__.H)(0):rxjs__WEBPACK_IMPORTED_MODULE_28__.E),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_21__.x)())}generateTempCartId(){return`temp-${Math.random().toString(36).substring(2,11)}`}createCart({userId,oldCartId,toMergeCartGuid,extraData}){const tempCartId=this.generateTempCartId();return this.store.dispatch(new CreateCart({extraData,userId,oldCartId,toMergeCartGuid,tempCartId})),this.getCartIdByType(extraData?.active?_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.EI.ACTIVE:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.EI.NEW_CREATED).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(cartId=>this.getCart(cartId)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.pTN))}mergeToCurrentCart({userId,cartId,extraData}){const tempCartId=this.generateTempCartId();this.store.dispatch(new MergeCart({userId,cartId,extraData,tempCartId}))}loadCart({cartId,userId,extraData}){this.store.dispatch(new LoadCart({userId,cartId,extraData}))}getEntries(cartId){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.Ys)(getCartEntriesSelectorFactory(cartId)))}getLastEntry(cartId,productCode){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.Ys)(getCartEntriesSelectorFactory(cartId)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(entries=>{const filteredEntries=entries.filter(entry=>entry.product?.code===productCode);return filteredEntries?filteredEntries[filteredEntries.length-1]:void 0}))}addEntry(userId,cartId,productCode,quantity,pickupStore){this.store.dispatch(new CartAddEntry({userId,cartId,productCode,quantity,pickupStore}))}addEntries(userId,cartId,products){products.forEach(product=>{this.store.dispatch(new CartAddEntry({userId,cartId,productCode:product.productCode,quantity:product.quantity}))})}removeEntry(userId,cartId,entryNumber){this.store.dispatch(new CartRemoveEntry({userId,cartId,entryNumber:`${entryNumber}`}))}updateEntry(userId,cartId,entryNumber,quantity,pickupStore,pickupToDelivery=!1){void 0!==quantity&&quantity<=0?this.removeEntry(userId,cartId,entryNumber):this.store.dispatch(new CartUpdateEntry({userId,cartId,pickupStore,pickupToDelivery,entryNumber:`${entryNumber}`,quantity}))}getEntry(cartId,productCode){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.Ys)(getCartEntrySelectorFactory(cartId,productCode)))}assignEmail(cartId,userId,email){this.store.dispatch(new AddEmailToCart({userId,cartId,email}))}removeCart(cartId){this.store.dispatch(new RemoveCart({cartId}))}deleteCart(cartId,userId){this.store.dispatch(new DeleteCart({userId,cartId}))}reloadCart(cartId,extraData){this.userIdService.takeUserId().subscribe(userId=>this.store.dispatch(new LoadCart({userId,cartId,extraData})))}getCartIdByType(cartType){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.Ys)(getCartIdByTypeFactory(cartType)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_21__.x)())}}__name(MultiCartService,"MultiCartService"),MultiCartService.\u0275fac=__name(function(t){return new(t||MultiCartService)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.yh),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.XBV))},"MultiCartService_Factory"),MultiCartService.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:MultiCartService,factory:MultiCartService.\u0275fac});class SelectiveCartService{constructor(userProfileFacade,multiCartFacade,baseSiteService,userIdService){this.userProfileFacade=userProfileFacade,this.multiCartFacade=multiCartFacade,this.baseSiteService=baseSiteService,this.userIdService=userIdService}getCart(){return this.selectiveCart$||(this.selectiveCart$=(0,rxjs__WEBPACK_IMPORTED_MODULE_24__.aj)([this.getSelectiveCartId(),this.userProfileFacade.get(),this.userIdService.getUserId(),this.baseSiteService.getActive()]).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_21__.x)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_17__.b)(([selectiveId,user,userId,activeBaseSite])=>{!Boolean(selectiveId)&&userId!==_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.Fds&&user?.customerId&&this.multiCartFacade.loadCart({userId,cartId:`selectivecart${activeBaseSite}${user.customerId}`})}),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(([selectiveId])=>Boolean(selectiveId)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(([selectiveId])=>this.multiCartFacade.getCart(selectiveId)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_22__.d)({bufferSize:1,refCount:!0}))),this.selectiveCart$}getEntries(){return this.getSelectiveCartId().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(selectiveId=>this.multiCartFacade.getEntries(selectiveId)))}isStable(){return this.getSelectiveCartId().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(selectiveId=>this.multiCartFacade.isStable(selectiveId)))}addEntry(productCode,quantity){this.getSelectiveIdWithUserId().subscribe(([selectiveId,userId])=>{this.multiCartFacade.addEntry(userId,selectiveId,productCode,quantity)})}removeEntry(entry){this.getSelectiveIdWithUserId().subscribe(([selectiveId,userId])=>{this.multiCartFacade.removeEntry(userId,selectiveId,entry.entryNumber)})}updateEntry(entryNumber,quantity){this.getSelectiveIdWithUserId().subscribe(([selectiveId,userId])=>{this.multiCartFacade.updateEntry(userId,selectiveId,entryNumber,quantity)})}getEntry(productCode){return this.getSelectiveCartId().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.w)(selectiveId=>this.multiCartFacade.getEntry(selectiveId,productCode)))}getSelectiveCartId(){return this.multiCartFacade.getCartIdByType(_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.EI.SELECTIVE)}getSelectiveIdWithUserId(){return this.getSelectiveCartId().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_21__.x)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.M)(this.userIdService.getUserId()),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_19__.q)(1))}}__name(SelectiveCartService,"SelectiveCartService"),SelectiveCartService.\u0275fac=__name(function(t){return new(t||SelectiveCartService)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_user_profile_root__WEBPACK_IMPORTED_MODULE_29__.aT),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.WT),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.Do$),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.XBV))},"SelectiveCartService_Factory"),SelectiveCartService.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:SelectiveCartService,factory:SelectiveCartService.\u0275fac});const facadeProviders=[ActiveCartService,{provide:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.bu,useExisting:ActiveCartService},CartVoucherService,{provide:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.LN,useExisting:CartVoucherService},MultiCartService,{provide:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.WT,useExisting:MultiCartService},SelectiveCartService,{provide:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.Oo,useExisting:SelectiveCartService},CartValidationService,{provide:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.mU,useExisting:CartValidationService}];class BadCartRequestHandler extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kck{constructor(){super(...arguments),this.responseStatus=_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.sdw.BAD_REQUEST}getPriority(){return 0}hasMatch(errorResponse){return super.hasMatch(errorResponse)&&this.getErrors(errorResponse).some(isCartError)}handleError(request,response){this.handleCartNotFoundError(request,response),this.handleOtherCartErrors(request,response)}handleCartNotFoundError(_request,response){this.getErrors(response).filter(e=>isCartNotFoundError(e)).forEach(()=>{this.globalMessageService.add({key:"httpHandlers.cartNotFound"},_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.xUg.MSG_TYPE_ERROR)})}handleOtherCartErrors(_request,response){this.getErrors(response).filter(e=>"notFound"!==e.reason||"cart"!==e.subjectType).forEach(error=>{this.globalMessageService.add(error.message?error.message:{key:"httpHandlers.otherCartErrors"},_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.xUg.MSG_TYPE_ERROR)})}getErrors(response){return(response.error?.errors||[]).filter(error=>"JaloObjectNoLongerValidError"!==error.type)}}__name(BadCartRequestHandler,"BadCartRequestHandler"),BadCartRequestHandler.\u0275fac=function(){let \u0275BadCartRequestHandler_BaseFactory;return __name(function(t){return(\u0275BadCartRequestHandler_BaseFactory||(\u0275BadCartRequestHandler_BaseFactory=_angular_core__WEBPACK_IMPORTED_MODULE_1__.n5z(BadCartRequestHandler)))(t||BadCartRequestHandler)},"BadCartRequestHandler_Factory")}(),BadCartRequestHandler.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:BadCartRequestHandler,factory:BadCartRequestHandler.\u0275fac,providedIn:"root"});class BadVoucherRequestHandler extends _spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kck{constructor(){super(...arguments),this.responseStatus=_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.sdw.BAD_REQUEST}getPriority(){return 0}hasMatch(errorResponse){return super.hasMatch(errorResponse)&&this.getErrors(errorResponse).some(isVoucherError)}handleError(request,response){this.handleVoucherExceededError(request,response),this.handleVoucherInvalidError(request,response)}handleVoucherExceededError(_request,response){this.getErrors(response).filter(e=>voucherExceededError(e)).forEach(()=>{this.globalMessageService.add({key:"httpHandlers.voucherExceeded"},_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.xUg.MSG_TYPE_ERROR)})}handleVoucherInvalidError(_request,response){this.getErrors(response).filter(e=>voucherInvalidError(e)).forEach(()=>{this.globalMessageService.add({key:"httpHandlers.invalidCodeProvided"},_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.xUg.MSG_TYPE_ERROR)})}getErrors(response){return(response.error?.errors||[]).filter(error=>"JaloObjectNoLongerValidError"!==error.type)}}__name(BadVoucherRequestHandler,"BadVoucherRequestHandler"),BadVoucherRequestHandler.\u0275fac=function(){let \u0275BadVoucherRequestHandler_BaseFactory;return __name(function(t){return(\u0275BadVoucherRequestHandler_BaseFactory||(\u0275BadVoucherRequestHandler_BaseFactory=_angular_core__WEBPACK_IMPORTED_MODULE_1__.n5z(BadVoucherRequestHandler)))(t||BadVoucherRequestHandler)},"BadVoucherRequestHandler_Factory")}(),BadVoucherRequestHandler.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:BadVoucherRequestHandler,factory:BadVoucherRequestHandler.\u0275fac,providedIn:"root"});class MultiCartStoreModule{}__name(MultiCartStoreModule,"MultiCartStoreModule"),MultiCartStoreModule.\u0275fac=__name(function(t){return new(t||MultiCartStoreModule)},"MultiCartStoreModule_Factory"),MultiCartStoreModule.\u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_1__.oAB({type:MultiCartStoreModule}),MultiCartStoreModule.\u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_1__.cJS({providers:[multiCartReducerProvider,MultiCartEffectsService],imports:[_angular_common__WEBPACK_IMPORTED_MODULE_30__.ez,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.vUS,_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.Aw.forFeature("cart",multiCartReducerToken,{metaReducers:multiCartMetaReducers}),_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.sQ.forFeature(effects)]});class CartBaseCoreModule{}__name(CartBaseCoreModule,"CartBaseCoreModule"),CartBaseCoreModule.\u0275fac=__name(function(t){return new(t||CartBaseCoreModule)},"CartBaseCoreModule_Factory"),CartBaseCoreModule.\u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_1__.oAB({type:CartBaseCoreModule}),CartBaseCoreModule.\u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_1__.cJS({providers:[CartConnector,CartEntryConnector,CartVoucherConnector,CartValidationConnector,...facadeProviders,{provide:_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kck,useExisting:BadCartRequestHandler,multi:!0},{provide:_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.kck,useExisting:BadVoucherRequestHandler,multi:!0}],imports:[CartEventModule,MultiCartStoreModule,CartPersistenceModule,CartPageEventModule]});const CART_VALIDATION_NORMALIZER=new _angular_core__WEBPACK_IMPORTED_MODULE_1__.OlP("CartValidationNormalizer");class CartConfigService{constructor(config){this.config=config}isSelectiveCartEnabled(){return Boolean(this.config?.cart?.selectiveCart?.enabled)}isCartValidationEnabled(){return Boolean(this.config?.cart?.validation?.enabled)}}__name(CartConfigService,"CartConfigService"),CartConfigService.\u0275fac=__name(function(t){return new(t||CartConfigService)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.qB))},"CartConfigService_Factory"),CartConfigService.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:CartConfigService,factory:CartConfigService.\u0275fac,providedIn:"root"});class CartValidationGuard{constructor(cartValidationService,semanticPathService,router,globalMessageService,activeCartService,cartValidationStateService,cartConfigService){this.cartValidationService=cartValidationService,this.semanticPathService=semanticPathService,this.router=router,this.globalMessageService=globalMessageService,this.activeCartService=activeCartService,this.cartValidationStateService=cartValidationStateService,this.cartConfigService=cartConfigService,this.GLOBAL_MESSAGE_TIMEOUT=1e4}canActivate(){return this.cartConfigService.isCartValidationEnabled()?this.cartValidationService.validateCart().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.M)(this.activeCartService.getEntries()),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(([cartModificationList,cartEntries])=>{if(this.cartValidationStateService.updateValidationResultAndRoutingId(cartModificationList.cartModifications??[]),void 0!==cartModificationList.cartModifications&&0!==cartModificationList.cartModifications.length){let validationResultMessage;const modification=cartModificationList.cartModifications[0];return validationResultMessage=1===cartEntries.length&&cartEntries[0].product?.code===modification.entry?.product?.code&&modification.statusCode===_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.v$.NO_STOCK?{key:"validation.cartEntryRemoved",params:{name:modification.entry?.product?.name}}:{key:"validation.cartEntriesChangeDuringCheckout"},this.globalMessageService.add(validationResultMessage,_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.xUg.MSG_TYPE_ERROR,this.GLOBAL_MESSAGE_TIMEOUT),this.activeCartService.reloadActiveCart(),this.router.parseUrl(this.semanticPathService.get("cart")??"")}return!0})):(0,rxjs__WEBPACK_IMPORTED_MODULE_9__.of)(!0)}}__name(CartValidationGuard,"CartValidationGuard"),CartValidationGuard.\u0275fac=__name(function(t){return new(t||CartValidationGuard)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.mU),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.hCH),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_angular_router__WEBPACK_IMPORTED_MODULE_31__.F0),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.IWp),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.bu),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(CartValidationStateService),_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(CartConfigService))},"CartValidationGuard_Factory"),CartValidationGuard.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:CartValidationGuard,factory:CartValidationGuard.\u0275fac,providedIn:"root"});class ProductImportInfoService{constructor(actionsSubject){this.actionsSubject=actionsSubject,this.logger=(0,_angular_core__WEBPACK_IMPORTED_MODULE_1__.f3M)(_spartacus_core__WEBPACK_IMPORTED_MODULE_0__.mQy)}getResults(cartId){return this.actionsSubject.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_2__.l4)("[Cart-entry] Add Entry Success","[Cart-entry] Add Entry Fail"),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.h)(action=>action.payload.cartId===cartId),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.U)(action=>this.mapMessages(action)))}mapMessages(action){const{productCode}=action.payload;if(action instanceof CartAddEntrySuccess){const{quantity,quantityAdded,entry,statusCode}=action.payload;if(statusCode===_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.QX.LOW_STOCK)return{productCode,statusCode,productName:entry?.product?.name,quantity,quantityAdded};if(statusCode===_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.QX.SUCCESS||statusCode===_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.QX.NO_STOCK)return{productCode,statusCode,productName:entry?.product?.name}}else if(action instanceof CartAddEntryFail){const{error}=action.payload;if("UnknownIdentifierError"===error?.details[0]?.type)return{productCode,statusCode:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.QX.UNKNOWN_IDENTIFIER}}return(0,_angular_core__WEBPACK_IMPORTED_MODULE_1__.X6Q)()&&this.logger.warn("Unrecognized cart add entry action type while mapping messages",action),{productCode,statusCode:_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_14__.QX.UNKNOWN_ERROR}}}__name(ProductImportInfoService,"ProductImportInfoService"),ProductImportInfoService.\u0275fac=__name(function(t){return new(t||ProductImportInfoService)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.LFG(_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.UO))},"ProductImportInfoService_Factory"),ProductImportInfoService.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Yz7({token:ProductImportInfoService,factory:ProductImportInfoService.\u0275fac,providedIn:"root"})},59537:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{CONFIGURATOR_TYPE_TEXTFIELD:()=>CONFIGURATOR_TYPE_TEXTFIELD$1,ConfiguratorTextfieldAddToCartButtonComponent:()=>ConfiguratorTextfieldAddToCartButtonComponent,ConfiguratorTextfieldFormComponent:()=>ConfiguratorTextfieldFormComponent,ConfiguratorTextfieldInputFieldComponent:()=>ConfiguratorTextfieldInputFieldComponent,ConfiguratorTextfieldInputFieldReadonlyComponent:()=>ConfiguratorTextfieldInputFieldReadonlyComponent,OccConfiguratorTextfieldAdapter:()=>OccConfiguratorTextfieldAdapter,OccConfiguratorTextfieldAddToCartSerializer:()=>OccConfiguratorTextfieldAddToCartSerializer,OccConfiguratorTextfieldNormalizer:()=>OccConfiguratorTextfieldNormalizer,TextfieldConfiguratorComponentsModule:()=>TextfieldConfiguratorComponentsModule,TextfieldConfiguratorCoreModule:()=>TextfieldConfiguratorCoreModule,TextfieldConfiguratorModule:()=>TextfieldConfiguratorModule,TextfieldConfiguratorOccModule:()=>TextfieldConfiguratorOccModule});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(40305),_spartacus_product_configurator_common__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(71506),_ngrx_store__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(91464),_spartacus_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(46167),rxjs_operators__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(85171),rxjs_operators__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(86466),rxjs_operators__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(2026),rxjs_operators__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(95426),rxjs_operators__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(63714),rxjs_operators__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(2155),_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(638),_angular_router__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(9664),_angular_common__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(89318),_angular_forms__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(43070),_ng_select_ng_select__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(80060),_ngrx_effects__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(48030),_spartacus_cart_base_core__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(49352),rxjs__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(95202),_angular_common_http__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(48664);const _c0=__name(function(){return{cxRoute:"cart"}},"_c0"),_c1=__name(function(a0,a1){return{value:a0,attribute:a1}},"_c1");function ConfiguratorTextfieldFormComponent_ng_container_0_ng_container_1_div_4_Template(rf,ctx){if(1&rf){const _r9=_angular_core__WEBPACK_IMPORTED_MODULE_0__.EpF();_angular_core__WEBPACK_IMPORTED_MODULE_0__.TgZ(0,"div",6)(1,"cx-configurator-textfield-input-field",7),_angular_core__WEBPACK_IMPORTED_MODULE_0__.NdJ("inputChange",__name(function($event){_angular_core__WEBPACK_IMPORTED_MODULE_0__.CHM(_r9);const ctx_r8=_angular_core__WEBPACK_IMPORTED_MODULE_0__.oxw(3);return _angular_core__WEBPACK_IMPORTED_MODULE_0__.KtG(ctx_r8.updateConfiguration($event))},"ConfiguratorTextfieldFormComponent_ng_container_0_ng_container_1_div_4_Template_cx_configurator_textfield_input_field_inputChange_1_listener")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.qZA()()}if(2&rf){const attribute_r7=ctx.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Q6J("attribute",attribute_r7)}}function ConfiguratorTextfieldFormComponent_ng_container_0_ng_container_1_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.ynx(0),_angular_core__WEBPACK_IMPORTED_MODULE_0__.TgZ(1,"span",3),_angular_core__WEBPACK_IMPORTED_MODULE_0__._uU(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.ALo(3,"cxTranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.YNc(4,ConfiguratorTextfieldFormComponent_ng_container_0_ng_container_1_div_4_Template,2,1,"div",4),_angular_core__WEBPACK_IMPORTED_MODULE_0__._UZ(5,"cx-configurator-textfield-add-to-cart-button",5),_angular_core__WEBPACK_IMPORTED_MODULE_0__.BQk()),2&rf){const configuration_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__.oxw().ngIf;_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.hij(" ",_angular_core__WEBPACK_IMPORTED_MODULE_0__.lcZ(3,3,"configurator.a11y.editAttributesAndValues")," "),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Q6J("ngForOf",configuration_r1.configurationInfos),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Q6J("configuration",configuration_r1)}}function ConfiguratorTextfieldFormComponent_ng_container_0_ng_template_3_div_3_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.TgZ(0,"div",6),_angular_core__WEBPACK_IMPORTED_MODULE_0__._UZ(1,"cx-configurator-textfield-input-field-readonly",8),_angular_core__WEBPACK_IMPORTED_MODULE_0__.qZA()),2&rf){const attribute_r12=ctx.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Q6J("attribute",attribute_r12)}}function ConfiguratorTextfieldFormComponent_ng_container_0_ng_template_3_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.TgZ(0,"span",3),_angular_core__WEBPACK_IMPORTED_MODULE_0__._uU(1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.ALo(2,"cxTranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.YNc(3,ConfiguratorTextfieldFormComponent_ng_container_0_ng_template_3_div_3_Template,2,1,"div",4)),2&rf){const configuration_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__.oxw().ngIf;_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.hij(" ",_angular_core__WEBPACK_IMPORTED_MODULE_0__.lcZ(2,2,"configurator.a11y.listOfAttributesAndValues")," "),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Q6J("ngForOf",configuration_r1.configurationInfos)}}function ConfiguratorTextfieldFormComponent_ng_container_0_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.ynx(0),_angular_core__WEBPACK_IMPORTED_MODULE_0__.YNc(1,ConfiguratorTextfieldFormComponent_ng_container_0_ng_container_1_Template,6,5,"ng-container",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.ALo(2,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.YNc(3,ConfiguratorTextfieldFormComponent_ng_container_0_ng_template_3_Template,4,4,"ng-template",null,2,_angular_core__WEBPACK_IMPORTED_MODULE_0__.W1O),_angular_core__WEBPACK_IMPORTED_MODULE_0__.BQk()),2&rf){const _r3=_angular_core__WEBPACK_IMPORTED_MODULE_0__.MAs(4),ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__.oxw();_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Q6J("ngIf",_angular_core__WEBPACK_IMPORTED_MODULE_0__.lcZ(2,2,ctx_r0.isEditable$))("ngIfElse",_r3)}}var ConfiguratorTextfield;__name(ConfiguratorTextfieldFormComponent_ng_container_0_ng_container_1_div_4_Template,"ConfiguratorTextfieldFormComponent_ng_container_0_ng_container_1_div_4_Template"),__name(ConfiguratorTextfieldFormComponent_ng_container_0_ng_container_1_Template,"ConfiguratorTextfieldFormComponent_ng_container_0_ng_container_1_Template"),__name(ConfiguratorTextfieldFormComponent_ng_container_0_ng_template_3_div_3_Template,"ConfiguratorTextfieldFormComponent_ng_container_0_ng_template_3_div_3_Template"),__name(ConfiguratorTextfieldFormComponent_ng_container_0_ng_template_3_Template,"ConfiguratorTextfieldFormComponent_ng_container_0_ng_template_3_Template"),__name(ConfiguratorTextfieldFormComponent_ng_container_0_Template,"ConfiguratorTextfieldFormComponent_ng_container_0_Template"),function(ConfiguratorTextfield2){let ConfigurationStatus;var ConfigurationStatus2;(ConfigurationStatus2=ConfigurationStatus=ConfiguratorTextfield2.ConfigurationStatus||(ConfiguratorTextfield2.ConfigurationStatus={})).SUCCESS="SUCCESS",ConfigurationStatus2.ERROR="ERROR"}(ConfiguratorTextfield||(ConfiguratorTextfield={}));const CONFIGURATION_TEXTFIELD_DATA="[ConfiguratorTextfield] Configuration Data",CREATE_CONFIGURATION="[Configurator] Create Configuration Textfield",CREATE_CONFIGURATION_SUCCESS="[Configurator] Create Configuration Textfield Success",UPDATE_CONFIGURATION="[Configurator] Update Configuration Textfield",ADD_TO_CART="[Configurator] Add to cart Textfield",READ_CART_ENTRY_CONFIGURATION_SUCCESS="[Configurator] Read cart entry configuration Textfield Success",READ_ORDER_ENTRY_CONFIGURATION_SUCCESS="[Configurator] Read order entry configuration textfield Success",REMOVE_CONFIGURATION="[Configurator] Remove Configuration Textfield";class CreateConfiguration extends _spartacus_core__WEBPACK_IMPORTED_MODULE_1__.kPG.LoaderLoadAction{constructor(payload){super(CONFIGURATION_TEXTFIELD_DATA),this.payload=payload,this.type=CREATE_CONFIGURATION}}__name(CreateConfiguration,"CreateConfiguration");class CreateConfigurationFail extends _spartacus_core__WEBPACK_IMPORTED_MODULE_1__.kPG.LoaderFailAction{constructor(payload){super(CONFIGURATION_TEXTFIELD_DATA,payload),this.payload=payload,this.type="[Configurator] Create Configuration Textfield Fail"}}__name(CreateConfigurationFail,"CreateConfigurationFail");class CreateConfigurationSuccess extends _spartacus_core__WEBPACK_IMPORTED_MODULE_1__.kPG.LoaderSuccessAction{constructor(payload){super(CONFIGURATION_TEXTFIELD_DATA),this.payload=payload,this.type=CREATE_CONFIGURATION_SUCCESS}}__name(CreateConfigurationSuccess,"CreateConfigurationSuccess");class UpdateConfiguration extends _spartacus_core__WEBPACK_IMPORTED_MODULE_1__.kPG.LoaderLoadAction{constructor(payload){super(CONFIGURATION_TEXTFIELD_DATA),this.payload=payload,this.type=UPDATE_CONFIGURATION}}__name(UpdateConfiguration,"UpdateConfiguration");class AddToCart extends _spartacus_core__WEBPACK_IMPORTED_MODULE_1__.kPG.LoaderLoadAction{constructor(payload){super(CONFIGURATION_TEXTFIELD_DATA),this.payload=payload,this.type=ADD_TO_CART}}__name(AddToCart,"AddToCart");class AddToCartFail extends _spartacus_core__WEBPACK_IMPORTED_MODULE_1__.kPG.LoaderFailAction{constructor(payload){super(CONFIGURATION_TEXTFIELD_DATA,payload),this.payload=payload,this.type="[Configurator] Add to cart Textfield Fail"}}__name(AddToCartFail,"AddToCartFail");class UpdateCartEntryConfiguration extends _spartacus_core__WEBPACK_IMPORTED_MODULE_1__.kPG.LoaderLoadAction{constructor(payload){super(CONFIGURATION_TEXTFIELD_DATA),this.payload=payload,this.type="[Configurator] Update cart entry configuration Textfield"}}__name(UpdateCartEntryConfiguration,"UpdateCartEntryConfiguration");class UpdateCartEntryConfigurationFail extends _spartacus_core__WEBPACK_IMPORTED_MODULE_1__.kPG.LoaderFailAction{constructor(payload){super(CONFIGURATION_TEXTFIELD_DATA,payload),this.payload=payload,this.type="[Configurator] Update cart entry configuration Textfield Fail"}}__name(UpdateCartEntryConfigurationFail,"UpdateCartEntryConfigurationFail");class ReadCartEntryConfiguration extends _spartacus_core__WEBPACK_IMPORTED_MODULE_1__.kPG.LoaderLoadAction{constructor(payload){super(CONFIGURATION_TEXTFIELD_DATA),this.payload=payload,this.type="[Configurator] Read cart entry configuration Textfield"}}__name(ReadCartEntryConfiguration,"ReadCartEntryConfiguration");class ReadCartEntryConfigurationSuccess extends _spartacus_core__WEBPACK_IMPORTED_MODULE_1__.kPG.LoaderSuccessAction{constructor(payload){super(CONFIGURATION_TEXTFIELD_DATA),this.payload=payload,this.type=READ_CART_ENTRY_CONFIGURATION_SUCCESS}}__name(ReadCartEntryConfigurationSuccess,"ReadCartEntryConfigurationSuccess");class ReadCartEntryConfigurationFail extends _spartacus_core__WEBPACK_IMPORTED_MODULE_1__.kPG.LoaderFailAction{constructor(payload){super(CONFIGURATION_TEXTFIELD_DATA,payload),this.payload=payload,this.type="[Configurator] Read cart entry configuration Textfield Fail"}}__name(ReadCartEntryConfigurationFail,"ReadCartEntryConfigurationFail");class ReadOrderEntryConfiguration extends _spartacus_core__WEBPACK_IMPORTED_MODULE_1__.kPG.LoaderLoadAction{constructor(payload){super(CONFIGURATION_TEXTFIELD_DATA),this.payload=payload,this.type="[Configurator] Read order entry configuration textfield"}}__name(ReadOrderEntryConfiguration,"ReadOrderEntryConfiguration");class ReadOrderEntryConfigurationSuccess extends _spartacus_core__WEBPACK_IMPORTED_MODULE_1__.kPG.LoaderSuccessAction{constructor(payload){super(CONFIGURATION_TEXTFIELD_DATA),this.payload=payload,this.type=READ_ORDER_ENTRY_CONFIGURATION_SUCCESS}}__name(ReadOrderEntryConfigurationSuccess,"ReadOrderEntryConfigurationSuccess");class ReadOrderEntryConfigurationFail extends _spartacus_core__WEBPACK_IMPORTED_MODULE_1__.kPG.LoaderFailAction{constructor(payload){super(CONFIGURATION_TEXTFIELD_DATA,payload),this.payload=payload,this.type="[Configurator] Read order entry configuration textfield Fail"}}__name(ReadOrderEntryConfigurationFail,"ReadOrderEntryConfigurationFail");class RemoveConfiguration extends _spartacus_core__WEBPACK_IMPORTED_MODULE_1__.kPG.LoaderResetAction{constructor(){super(CONFIGURATION_TEXTFIELD_DATA),this.type=REMOVE_CONFIGURATION}}__name(RemoveConfiguration,"RemoveConfiguration");const getConfigurationContentSelector=__name(state=>state.loaderState.value,"getConfigurationContentSelector"),getConfigurationsState=(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_2__.ZF)("productConfigurationTextfield"),getConfigurationContent=(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_2__.P1)(getConfigurationsState,getConfigurationContentSelector);class ConfiguratorTextfieldService{constructor(store,activeCartService,configuratorUtils,userIdService){this.store=store,this.activeCartService=activeCartService,this.configuratorUtils=configuratorUtils,this.userIdService=userIdService,this.ensureConfigurationDefined=configuration=>configuration??{configurationInfos:[],owner:_spartacus_product_configurator_common__WEBPACK_IMPORTED_MODULE_3__.mR.createInitialOwner()}}createConfiguration(owner){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_2__.Ys)(getConfigurationsState),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.b)(configurationState=>{const configuration=configurationState.loaderState.value,isAvailableForProduct=void 0!==configuration&&!_spartacus_product_configurator_common__WEBPACK_IMPORTED_MODULE_3__.mR.isInitialOwner(configuration.owner),isLoading=configurationState.loaderState.loading;!isAvailableForProduct&&!isLoading&&this.store.dispatch(new CreateConfiguration({productCode:owner.id,owner}))}),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(configurationState=>configurationState.loaderState.value),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.h)(configuration=>!this.isConfigurationInitial(configuration)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(this.ensureConfigurationDefined))}updateConfiguration(changedAttribute){this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_2__.Ys)(getConfigurationContent),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.q)(1)).subscribe(oldConfiguration=>{oldConfiguration&&this.store.dispatch(new UpdateConfiguration(this.createNewConfigurationWithChange(changedAttribute,oldConfiguration)))})}addToCart(productCode,configuration){this.activeCartService.requireLoadedCart().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.q)(1)).subscribe(cart=>{this.userIdService.getUserId().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.q)(1)).subscribe(userId=>{const addToCartParameters={userId,cartId:this.configuratorUtils.getCartId(cart),productCode,configuration,quantity:1};this.store.dispatch(new AddToCart(addToCartParameters))})})}updateCartEntry(cartEntryNumber,configuration){this.activeCartService.requireLoadedCart().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.q)(1)).subscribe(cart=>{this.userIdService.getUserId().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.q)(1)).subscribe(userId=>{const updateCartParameters={userId,cartId:this.configuratorUtils.getCartId(cart),cartEntryNumber,configuration};this.store.dispatch(new UpdateCartEntryConfiguration(updateCartParameters))})})}readConfigurationForCartEntry(owner){return this.activeCartService.requireLoadedCart().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.w)(cart=>this.userIdService.getUserId().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.q)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(userId=>({cart,userId}))).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(cont=>({userId:cont.userId,cartId:this.configuratorUtils.getCartId(cont.cart),cartEntryNumber:owner.id,owner})),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.b)(readFromCartEntryParameters=>this.store.dispatch(new ReadCartEntryConfiguration(readFromCartEntryParameters))),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.w)(()=>this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_2__.Ys)(getConfigurationContent))),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.h)(configuration=>!this.isConfigurationInitial(configuration)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(this.ensureConfigurationDefined))))}readConfigurationForOrderEntry(owner){const ownerIdParts=this.configuratorUtils.decomposeOwnerId(owner.id),readFromOrderEntryParameters={userId:_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.zyp,orderId:ownerIdParts.documentId,orderEntryNumber:ownerIdParts.entryNumber,owner};return this.store.dispatch(new ReadOrderEntryConfiguration(readFromOrderEntryParameters)),this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_2__.Ys)(getConfigurationContent),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.h)(configuration=>!this.isConfigurationInitial(configuration)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(this.ensureConfigurationDefined))}createNewConfigurationWithChange(changedAttribute,oldConfiguration){const newConfiguration={configurationInfos:[],owner:oldConfiguration.owner};return oldConfiguration.configurationInfos.forEach(info=>{info.configurationLabel===changedAttribute.configurationLabel?(changedAttribute.status=ConfiguratorTextfield.ConfigurationStatus.SUCCESS,newConfiguration.configurationInfos.push(changedAttribute)):newConfiguration.configurationInfos.push(info)}),newConfiguration}isConfigurationInitial(configuration){return void 0===configuration||_spartacus_product_configurator_common__WEBPACK_IMPORTED_MODULE_3__.mR.isInitialOwner(configuration.owner)}}__name(ConfiguratorTextfieldService,"ConfiguratorTextfieldService"),ConfiguratorTextfieldService.\u0275fac=__name(function(t){return new(t||ConfiguratorTextfieldService)(_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(_ngrx_store__WEBPACK_IMPORTED_MODULE_2__.yh),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_9__.bu),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(_spartacus_product_configurator_common__WEBPACK_IMPORTED_MODULE_3__.NU),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.XBV))},"ConfiguratorTextfieldService_Factory"),ConfiguratorTextfieldService.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__.Yz7({token:ConfiguratorTextfieldService,factory:ConfiguratorTextfieldService.\u0275fac,providedIn:"root"});class ConfiguratorTextfieldAddToCartButtonComponent{constructor(configuratorTextfieldService){this.configuratorTextfieldService=configuratorTextfieldService}onAddToCart(){const owner=this.configuration.owner;switch(owner.type){case _spartacus_product_configurator_common__WEBPACK_IMPORTED_MODULE_3__.$g.OwnerType.PRODUCT:this.configuratorTextfieldService.addToCart(owner.id,this.configuration);break;case _spartacus_product_configurator_common__WEBPACK_IMPORTED_MODULE_3__.$g.OwnerType.CART_ENTRY:this.configuratorTextfieldService.updateCartEntry(owner.id,this.configuration)}}getButtonText(){return this.configuration.owner.type===_spartacus_product_configurator_common__WEBPACK_IMPORTED_MODULE_3__.$g.OwnerType.CART_ENTRY?"configurator.addToCart.buttonUpdateCart":"configurator.addToCart.button"}}__name(ConfiguratorTextfieldAddToCartButtonComponent,"ConfiguratorTextfieldAddToCartButtonComponent"),ConfiguratorTextfieldAddToCartButtonComponent.\u0275fac=__name(function(t){return new(t||ConfiguratorTextfieldAddToCartButtonComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y36(ConfiguratorTextfieldService))},"ConfiguratorTextfieldAddToCartButtonComponent_Factory"),ConfiguratorTextfieldAddToCartButtonComponent.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__.Xpm({type:ConfiguratorTextfieldAddToCartButtonComponent,selectors:[["cx-configurator-textfield-add-to-cart-button"]],inputs:{configuration:"configuration",productCode:"productCode"},decls:4,vars:7,consts:[[1,"cx-btn","btn","btn-block","btn-primary","cx-add-to-cart-btn",3,"routerLink","click"]],template:__name(function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.TgZ(0,"button",0),_angular_core__WEBPACK_IMPORTED_MODULE_0__.NdJ("click",__name(function(){return ctx.onAddToCart()},"ConfiguratorTextfieldAddToCartButtonComponent_Template_button_click_0_listener")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.ALo(1,"cxUrl"),_angular_core__WEBPACK_IMPORTED_MODULE_0__._uU(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.ALo(3,"cxTranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.qZA()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.Q6J("routerLink",_angular_core__WEBPACK_IMPORTED_MODULE_0__.lcZ(1,2,_angular_core__WEBPACK_IMPORTED_MODULE_0__.DdM(6,_c0))),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.hij(" ",_angular_core__WEBPACK_IMPORTED_MODULE_0__.lcZ(3,4,ctx.getButtonText()),"\n"))},"ConfiguratorTextfieldAddToCartButtonComponent_Template"),dependencies:[_angular_router__WEBPACK_IMPORTED_MODULE_10__.rH,_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.X$D,_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.l2T],encapsulation:2,changeDetection:0});class ConfiguratorTextfieldInputFieldComponent{constructor(){this.PREFIX_TEXTFIELD="cx-configurator-textfield",this.attributeInputForm=new _angular_forms__WEBPACK_IMPORTED_MODULE_11__.p4(""),this.inputChange=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.vpe}ngOnInit(){this.attributeInputForm.setValue(this.attribute.configurationValue)}onInputChange(){const attribute={configurationLabel:this.attribute.configurationLabel,configurationValue:this.attributeInputForm.value};this.inputChange.emit(attribute)}getIdLabel(attribute){return this.PREFIX_TEXTFIELD+"label"+this.getLabelForIdGeneration(attribute)}getId(attribute){return this.PREFIX_TEXTFIELD+this.getLabelForIdGeneration(attribute)}getLabelForIdGeneration(attribute){return attribute.configurationLabel.replace(/\s/g,"")}}__name(ConfiguratorTextfieldInputFieldComponent,"ConfiguratorTextfieldInputFieldComponent"),ConfiguratorTextfieldInputFieldComponent.\u0275fac=__name(function(t){return new(t||ConfiguratorTextfieldInputFieldComponent)},"ConfiguratorTextfieldInputFieldComponent_Factory"),ConfiguratorTextfieldInputFieldComponent.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__.Xpm({type:ConfiguratorTextfieldInputFieldComponent,selectors:[["cx-configurator-textfield-input-field"]],inputs:{attribute:"attribute"},outputs:{inputChange:"inputChange"},decls:6,vars:13,consts:[[1,"cx-configurator-textfield-label",3,"id"],[1,"form-group"],[1,"form-control",3,"formControl","change"]],template:__name(function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.TgZ(0,"label",0),_angular_core__WEBPACK_IMPORTED_MODULE_0__.ALo(1,"cxTranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__._uU(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.TgZ(3,"div",1)(4,"input",2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.NdJ("change",__name(function(){return ctx.onInputChange()},"ConfiguratorTextfieldInputFieldComponent_Template_input_change_4_listener")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.ALo(5,"cxTranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.qZA()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.s9C("id",ctx.getIdLabel(ctx.attribute)),_angular_core__WEBPACK_IMPORTED_MODULE_0__.uIk("aria-label",_angular_core__WEBPACK_IMPORTED_MODULE_0__.lcZ(1,5,"configurator.a11y.nameOfAttribute")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Oqu(ctx.attribute.configurationLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Q6J("formControl",ctx.attributeInputForm),_angular_core__WEBPACK_IMPORTED_MODULE_0__.uIk("aria-label",_angular_core__WEBPACK_IMPORTED_MODULE_0__.xi3(5,7,"configurator.a11y.valueOfAttributeFull",_angular_core__WEBPACK_IMPORTED_MODULE_0__.WLB(10,_c1,ctx.attribute.configurationValue,ctx.attribute.configurationLabel))))},"ConfiguratorTextfieldInputFieldComponent_Template"),dependencies:[_angular_forms__WEBPACK_IMPORTED_MODULE_11__.Fj,_angular_forms__WEBPACK_IMPORTED_MODULE_11__.JJ,_angular_forms__WEBPACK_IMPORTED_MODULE_11__.oH,_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.X$D],encapsulation:2,changeDetection:0});class ConfiguratorTextfieldInputFieldReadonlyComponent{constructor(){this.PREFIX_TEXTFIELD="cx-configurator-textfield"}getIdLabel(attribute){return this.PREFIX_TEXTFIELD+"label"+this.getLabelForIdGeneration(attribute)}getLabelForIdGeneration(attribute){return attribute.configurationLabel.replace(/\s/g,"")}}__name(ConfiguratorTextfieldInputFieldReadonlyComponent,"ConfiguratorTextfieldInputFieldReadonlyComponent"),ConfiguratorTextfieldInputFieldReadonlyComponent.\u0275fac=__name(function(t){return new(t||ConfiguratorTextfieldInputFieldReadonlyComponent)},"ConfiguratorTextfieldInputFieldReadonlyComponent_Factory"),ConfiguratorTextfieldInputFieldReadonlyComponent.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__.Xpm({type:ConfiguratorTextfieldInputFieldReadonlyComponent,selectors:[["cx-configurator-textfield-input-field-readonly"]],inputs:{attribute:"attribute"},decls:7,vars:11,consts:[[1,"cx-visually-hidden",3,"id"],["aria-hidden","true"]],template:__name(function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.TgZ(0,"span",0),_angular_core__WEBPACK_IMPORTED_MODULE_0__._uU(1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.ALo(2,"cxTranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.TgZ(3,"label",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__._uU(4),_angular_core__WEBPACK_IMPORTED_MODULE_0__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.TgZ(5,"div",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__._uU(6),_angular_core__WEBPACK_IMPORTED_MODULE_0__.qZA()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.s9C("id",ctx.getIdLabel(ctx.attribute)),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.hij(" ",_angular_core__WEBPACK_IMPORTED_MODULE_0__.xi3(2,5,"configurator.a11y.valueOfAttributeFull",_angular_core__WEBPACK_IMPORTED_MODULE_0__.WLB(8,_c1,ctx.attribute.configurationValue,ctx.attribute.configurationLabel)),"\n"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.uIk("aria-describedby",ctx.getIdLabel(ctx.attribute)),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Oqu(ctx.attribute.configurationLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.hij(" ",ctx.attribute.configurationValue,"\n"))},"ConfiguratorTextfieldInputFieldReadonlyComponent_Template"),dependencies:[_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.X$D],encapsulation:2,changeDetection:0});class ConfiguratorTextfieldFormComponent{constructor(configuratorTextfieldService,configRouterExtractorService){this.configuratorTextfieldService=configuratorTextfieldService,this.configRouterExtractorService=configRouterExtractorService,this.configuration$=this.configRouterExtractorService.extractRouterData().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.w)(routerData=>{switch(routerData.owner.type){case _spartacus_product_configurator_common__WEBPACK_IMPORTED_MODULE_3__.$g.OwnerType.PRODUCT:return this.configuratorTextfieldService.createConfiguration(routerData.owner);case _spartacus_product_configurator_common__WEBPACK_IMPORTED_MODULE_3__.$g.OwnerType.CART_ENTRY:return this.configuratorTextfieldService.readConfigurationForCartEntry(routerData.owner);case _spartacus_product_configurator_common__WEBPACK_IMPORTED_MODULE_3__.$g.OwnerType.ORDER_ENTRY:return this.configuratorTextfieldService.readConfigurationForOrderEntry(routerData.owner)}})),this.isEditable$=this.configRouterExtractorService.extractRouterData().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(routerData=>routerData.pageType===_spartacus_product_configurator_common__WEBPACK_IMPORTED_MODULE_3__.iB.PageType.CONFIGURATION))}updateConfiguration(attribute){this.configuratorTextfieldService.updateConfiguration(attribute)}}__name(ConfiguratorTextfieldFormComponent,"ConfiguratorTextfieldFormComponent"),ConfiguratorTextfieldFormComponent.\u0275fac=__name(function(t){return new(t||ConfiguratorTextfieldFormComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y36(ConfiguratorTextfieldService),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y36(_spartacus_product_configurator_common__WEBPACK_IMPORTED_MODULE_3__.u6))},"ConfiguratorTextfieldFormComponent_Factory"),ConfiguratorTextfieldFormComponent.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__.Xpm({type:ConfiguratorTextfieldFormComponent,selectors:[["cx-configurator-textfield-form"]],decls:2,vars:3,consts:[[4,"ngIf"],[4,"ngIf","ngIfElse"],["readonly",""],[1,"cx-visually-hidden"],["class","cx-attribute",4,"ngFor","ngForOf"],[3,"configuration"],[1,"cx-attribute"],[3,"attribute","inputChange"],[3,"attribute"]],template:__name(function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.YNc(0,ConfiguratorTextfieldFormComponent_ng_container_0_Template,5,4,"ng-container",0),_angular_core__WEBPACK_IMPORTED_MODULE_0__.ALo(1,"async")),2&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__.Q6J("ngIf",_angular_core__WEBPACK_IMPORTED_MODULE_0__.lcZ(1,1,ctx.configuration$))},"ConfiguratorTextfieldFormComponent_Template"),dependencies:[_angular_common__WEBPACK_IMPORTED_MODULE_12__.sg,_angular_common__WEBPACK_IMPORTED_MODULE_12__.O5,ConfiguratorTextfieldInputFieldComponent,ConfiguratorTextfieldInputFieldReadonlyComponent,ConfiguratorTextfieldAddToCartButtonComponent,_angular_common__WEBPACK_IMPORTED_MODULE_12__.Ov,_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.X$D],encapsulation:2});class TextfieldConfiguratorComponentsModule{}__name(TextfieldConfiguratorComponentsModule,"TextfieldConfiguratorComponentsModule"),TextfieldConfiguratorComponentsModule.\u0275fac=__name(function(t){return new(t||TextfieldConfiguratorComponentsModule)},"TextfieldConfiguratorComponentsModule_Factory"),TextfieldConfiguratorComponentsModule.\u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__.oAB({type:TextfieldConfiguratorComponentsModule}),TextfieldConfiguratorComponentsModule.\u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__.cJS({providers:[(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.i51)({cmsComponents:{TextfieldConfigurationForm:{component:ConfiguratorTextfieldFormComponent}}})],imports:[_angular_router__WEBPACK_IMPORTED_MODULE_10__.Bz,_angular_forms__WEBPACK_IMPORTED_MODULE_11__.u5,_angular_forms__WEBPACK_IMPORTED_MODULE_11__.UX,_ng_select_ng_select__WEBPACK_IMPORTED_MODULE_13__.A0,_angular_common__WEBPACK_IMPORTED_MODULE_12__.ez,_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.LUR,_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.bhT]});class ConfiguratorTextfieldAdapter{}__name(ConfiguratorTextfieldAdapter,"ConfiguratorTextfieldAdapter");class ConfiguratorTextfieldConnector{constructor(adapter){this.adapter=adapter}createConfiguration(productCode,owner){return this.adapter.createConfiguration(productCode,owner)}readConfigurationForCartEntry(parameters){return this.adapter.readConfigurationForCartEntry(parameters)}readConfigurationForOrderEntry(parameters){return this.adapter.readConfigurationForOrderEntry(parameters)}updateConfigurationForCartEntry(parameters){return this.adapter.updateConfigurationForCartEntry(parameters)}addToCart(parameters){return this.adapter.addToCart(parameters)}}__name(ConfiguratorTextfieldConnector,"ConfiguratorTextfieldConnector"),ConfiguratorTextfieldConnector.\u0275fac=__name(function(t){return new(t||ConfiguratorTextfieldConnector)(_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(ConfiguratorTextfieldAdapter))},"ConfiguratorTextfieldConnector_Factory"),ConfiguratorTextfieldConnector.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__.Yz7({token:ConfiguratorTextfieldConnector,factory:ConfiguratorTextfieldConnector.\u0275fac});class ConfiguratorTextfieldEffects{constructor(actions$,configuratorTextfieldConnector){this.actions$=actions$,this.configuratorTextfieldConnector=configuratorTextfieldConnector,this.logger=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.f3M)(_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.mQy),this.createConfiguration$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_14__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_14__.l4)(CREATE_CONFIGURATION),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(action=>action.payload),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.w)(payload=>this.configuratorTextfieldConnector.createConfiguration(payload.productCode,payload.owner).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.w)(configuration=>[new CreateConfigurationSuccess(configuration)]),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.K)(error=>(0,rxjs__WEBPACK_IMPORTED_MODULE_16__.of)(new CreateConfigurationFail((0,_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.cxH)(error,this.logger)))))))),this.addToCart$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_14__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_14__.l4)(ADD_TO_CART),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(action=>action.payload),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.w)(payload=>this.configuratorTextfieldConnector.addToCart(payload).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.w)(()=>[new RemoveConfiguration,new _spartacus_cart_base_core__WEBPACK_IMPORTED_MODULE_17__.$.LoadCart({cartId:payload.cartId,userId:payload.userId})]),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.K)(error=>(0,rxjs__WEBPACK_IMPORTED_MODULE_16__.of)(new AddToCartFail((0,_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.cxH)(error,this.logger)))))))),this.updateCartEntry$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_14__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_14__.l4)("[Configurator] Update cart entry configuration Textfield"),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(action=>action.payload),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.w)(payload=>this.configuratorTextfieldConnector.updateConfigurationForCartEntry(payload).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.w)(()=>[new RemoveConfiguration,new _spartacus_cart_base_core__WEBPACK_IMPORTED_MODULE_17__.$.LoadCart({cartId:payload.cartId,userId:payload.userId})]),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.K)(error=>(0,rxjs__WEBPACK_IMPORTED_MODULE_16__.of)(new UpdateCartEntryConfigurationFail((0,_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.cxH)(error,this.logger)))))))),this.readConfigurationForCartEntry$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_14__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_14__.l4)("[Configurator] Read cart entry configuration Textfield"),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.w)(action=>{const parameters=action.payload;return this.configuratorTextfieldConnector.readConfigurationForCartEntry(parameters).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.w)(result=>[new ReadCartEntryConfigurationSuccess(result)]),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.K)(error=>[new ReadCartEntryConfigurationFail((0,_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.cxH)(error,this.logger))]))}))),this.readConfigurationForOrderEntry$=(0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_14__.GW)(()=>this.actions$.pipe((0,_ngrx_effects__WEBPACK_IMPORTED_MODULE_14__.l4)("[Configurator] Read order entry configuration textfield"),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.w)(action=>{const parameters=action.payload;return this.configuratorTextfieldConnector.readConfigurationForOrderEntry(parameters).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.w)(result=>[new ReadOrderEntryConfigurationSuccess(result)]),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.K)(error=>[new ReadOrderEntryConfigurationFail((0,_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.cxH)(error,this.logger))]))})))}}__name(ConfiguratorTextfieldEffects,"ConfiguratorTextfieldEffects"),ConfiguratorTextfieldEffects.\u0275fac=__name(function(t){return new(t||ConfiguratorTextfieldEffects)(_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(_ngrx_effects__WEBPACK_IMPORTED_MODULE_14__.eX),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(ConfiguratorTextfieldConnector))},"ConfiguratorTextfieldEffects_Factory"),ConfiguratorTextfieldEffects.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__.Yz7({token:ConfiguratorTextfieldEffects,factory:ConfiguratorTextfieldEffects.\u0275fac});const configuratorTextfieldEffects=[ConfiguratorTextfieldEffects],initialState={configurationInfos:[],owner:_spartacus_product_configurator_common__WEBPACK_IMPORTED_MODULE_3__.mR.createInitialOwner()};function reducer(state=initialState,action){switch(action.type){case CREATE_CONFIGURATION_SUCCESS:case READ_CART_ENTRY_CONFIGURATION_SUCCESS:case READ_ORDER_ENTRY_CONFIGURATION_SUCCESS:case UPDATE_CONFIGURATION:return{...state,...action.payload};case REMOVE_CONFIGURATION:return initialState}return state}function getConfiguratorTextfieldReducers(){return{loaderState:_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.kPG.loaderReducer(CONFIGURATION_TEXTFIELD_DATA,reducer)}}__name(reducer,"reducer"),__name(getConfiguratorTextfieldReducers,"getConfiguratorTextfieldReducers");const configuratorTextfieldReducerToken=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.OlP("ConfiguratorReducers"),configuratorTextfieldReducerProvider={provide:configuratorTextfieldReducerToken,useFactory:getConfiguratorTextfieldReducers};class ConfiguratorTextfieldStoreModule{}__name(ConfiguratorTextfieldStoreModule,"ConfiguratorTextfieldStoreModule"),ConfiguratorTextfieldStoreModule.\u0275fac=__name(function(t){return new(t||ConfiguratorTextfieldStoreModule)},"ConfiguratorTextfieldStoreModule_Factory"),ConfiguratorTextfieldStoreModule.\u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__.oAB({type:ConfiguratorTextfieldStoreModule}),ConfiguratorTextfieldStoreModule.\u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__.cJS({providers:[configuratorTextfieldReducerProvider],imports:[_angular_common__WEBPACK_IMPORTED_MODULE_12__.ez,_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.vUS,_ngrx_store__WEBPACK_IMPORTED_MODULE_2__.Aw.forFeature("productConfigurationTextfield",configuratorTextfieldReducerToken),_ngrx_effects__WEBPACK_IMPORTED_MODULE_14__.sQ.forFeature(configuratorTextfieldEffects)]});class TextfieldConfiguratorCoreModule{}__name(TextfieldConfiguratorCoreModule,"TextfieldConfiguratorCoreModule"),TextfieldConfiguratorCoreModule.\u0275fac=__name(function(t){return new(t||TextfieldConfiguratorCoreModule)},"TextfieldConfiguratorCoreModule_Factory"),TextfieldConfiguratorCoreModule.\u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__.oAB({type:TextfieldConfiguratorCoreModule}),TextfieldConfiguratorCoreModule.\u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__.cJS({providers:[ConfiguratorTextfieldConnector],imports:[ConfiguratorTextfieldStoreModule]});const CONFIGURATOR_TYPE_TEXTFIELD$1="TEXTFIELD";class OccConfiguratorTextfieldAddToCartSerializer{constructor(){}convert(source,target){const configurationInfos=[];return source.configuration?.configurationInfos.forEach(info=>this.convertInfo(info,configurationInfos)),{...target,userId:source.userId,cartId:source.cartId,product:{code:source.productCode},quantity:source.quantity,configurationInfos}}convertInfo(source,occConfigurationInfos){const occInfo={configurationLabel:source.configurationLabel,configurationValue:source.configurationValue,status:source.status,configuratorType:CONFIGURATOR_TYPE_TEXTFIELD$1};occConfigurationInfos.push(occInfo)}}__name(OccConfiguratorTextfieldAddToCartSerializer,"OccConfiguratorTextfieldAddToCartSerializer"),OccConfiguratorTextfieldAddToCartSerializer.\u0275fac=__name(function(t){return new(t||OccConfiguratorTextfieldAddToCartSerializer)},"OccConfiguratorTextfieldAddToCartSerializer_Factory"),OccConfiguratorTextfieldAddToCartSerializer.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__.Yz7({token:OccConfiguratorTextfieldAddToCartSerializer,factory:OccConfiguratorTextfieldAddToCartSerializer.\u0275fac,providedIn:"root"});class OccConfiguratorTextfieldNormalizer{constructor(){}convert(source,target){return{...target,...source}}}__name(OccConfiguratorTextfieldNormalizer,"OccConfiguratorTextfieldNormalizer"),OccConfiguratorTextfieldNormalizer.\u0275fac=__name(function(t){return new(t||OccConfiguratorTextfieldNormalizer)},"OccConfiguratorTextfieldNormalizer_Factory"),OccConfiguratorTextfieldNormalizer.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__.Yz7({token:OccConfiguratorTextfieldNormalizer,factory:OccConfiguratorTextfieldNormalizer.\u0275fac,providedIn:"root"});const CONFIGURATION_TEXTFIELD_NORMALIZER=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.OlP("ConfigurationNormalizer"),CONFIGURATION_TEXTFIELD_ADD_TO_CART_SERIALIZER=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.OlP("ConfigurationAddToCartSerializer"),CONFIGURATION_TEXTFIELD_UPDATE_CART_ENTRY_SERIALIZER=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.OlP("ConfigurationUpdateCartEntrySerializer");class OccConfiguratorTextfieldAdapter{constructor(http,occEndpointsService,converterService){this.http=http,this.occEndpointsService=occEndpointsService,this.converterService=converterService}createConfiguration(productCode,owner){return this.http.get(this.occEndpointsService.buildUrl("createTextfieldConfiguration",{urlParams:{productCode}})).pipe(this.converterService.pipeable(CONFIGURATION_TEXTFIELD_NORMALIZER),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(resultConfiguration=>({...resultConfiguration,owner})))}addToCart(parameters){const url=this.occEndpointsService.buildUrl("addTextfieldConfigurationToCart",{urlParams:{userId:parameters.userId,cartId:parameters.cartId}}),occAddToCartParameters=this.converterService.convert(parameters,CONFIGURATION_TEXTFIELD_ADD_TO_CART_SERIALIZER);return this.http.post(url,occAddToCartParameters).pipe(this.converterService.pipeable(_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_9__.Ke))}readConfigurationForCartEntry(parameters){const url=this.occEndpointsService.buildUrl("readTextfieldConfigurationForCartEntry",{urlParams:{userId:parameters.userId,cartId:parameters.cartId,cartEntryNumber:parameters.cartEntryNumber}});return this.http.get(url).pipe(this.converterService.pipeable(CONFIGURATION_TEXTFIELD_NORMALIZER),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(resultConfiguration=>({...resultConfiguration,owner:{...parameters.owner}})))}readConfigurationForOrderEntry(parameters){const url=this.occEndpointsService.buildUrl("readTextfieldConfigurationForOrderEntry",{urlParams:{userId:parameters.userId,orderId:parameters.orderId,orderEntryNumber:parameters.orderEntryNumber}});return this.http.get(url).pipe(this.converterService.pipeable(CONFIGURATION_TEXTFIELD_NORMALIZER),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(resultConfiguration=>({...resultConfiguration,owner:{...parameters.owner}})))}updateConfigurationForCartEntry(parameters){const url=this.occEndpointsService.buildUrl("updateTextfieldConfigurationForCartEntry",{urlParams:{userId:parameters.userId,cartId:parameters.cartId,cartEntryNumber:parameters.cartEntryNumber}}),occUpdateCartEntryParameters=this.converterService.convert(parameters,CONFIGURATION_TEXTFIELD_UPDATE_CART_ENTRY_SERIALIZER);return this.http.post(url,occUpdateCartEntryParameters).pipe(this.converterService.pipeable(_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_9__.Ke))}}__name(OccConfiguratorTextfieldAdapter,"OccConfiguratorTextfieldAdapter"),OccConfiguratorTextfieldAdapter.\u0275fac=__name(function(t){return new(t||OccConfiguratorTextfieldAdapter)(_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(_angular_common_http__WEBPACK_IMPORTED_MODULE_18__.eN),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.Lz0),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.IXI))},"OccConfiguratorTextfieldAdapter_Factory"),OccConfiguratorTextfieldAdapter.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__.Yz7({token:OccConfiguratorTextfieldAdapter,factory:OccConfiguratorTextfieldAdapter.\u0275fac});class OccConfiguratorTextfieldUpdateCartEntrySerializer{constructor(){}convert(source){const configurationInfos=[];return source.configuration?.configurationInfos.forEach(info=>this.convertInfo(info,configurationInfos)),{userId:source.userId,cartId:source.cartId,cartEntryNumber:source.cartEntryNumber,configurationInfos}}convertInfo(source,occConfigurationInfos){const occInfo={configurationLabel:source.configurationLabel,configurationValue:source.configurationValue,status:source.status,configuratorType:"TEXTFIELD"};occConfigurationInfos.push(occInfo)}}function defaultOccConfiguratorTextfieldConfigFactory(){return{backend:{occ:{endpoints:{createTextfieldConfiguration:"products/${productCode}/configurator/textfield",addTextfieldConfigurationToCart:"users/${userId}/carts/${cartId}/entries/configurator/textfield",readTextfieldConfigurationForCartEntry:"users/${userId}/carts/${cartId}/entries/${cartEntryNumber}/configurator/textfield",readTextfieldConfigurationForOrderEntry:"users/${userId}/orders/${orderId}/entries/${orderEntryNumber}/configurator/textfield",updateTextfieldConfigurationForCartEntry:"users/${userId}/carts/${cartId}/entries/${cartEntryNumber}/configurator/textfield"}}}}}__name(OccConfiguratorTextfieldUpdateCartEntrySerializer,"OccConfiguratorTextfieldUpdateCartEntrySerializer"),OccConfiguratorTextfieldUpdateCartEntrySerializer.\u0275fac=__name(function(t){return new(t||OccConfiguratorTextfieldUpdateCartEntrySerializer)},"OccConfiguratorTextfieldUpdateCartEntrySerializer_Factory"),OccConfiguratorTextfieldUpdateCartEntrySerializer.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__.Yz7({token:OccConfiguratorTextfieldUpdateCartEntrySerializer,factory:OccConfiguratorTextfieldUpdateCartEntrySerializer.\u0275fac,providedIn:"root"}),__name(defaultOccConfiguratorTextfieldConfigFactory,"defaultOccConfiguratorTextfieldConfigFactory");class TextfieldConfiguratorOccModule{}__name(TextfieldConfiguratorOccModule,"TextfieldConfiguratorOccModule"),TextfieldConfiguratorOccModule.\u0275fac=__name(function(t){return new(t||TextfieldConfiguratorOccModule)},"TextfieldConfiguratorOccModule_Factory"),TextfieldConfiguratorOccModule.\u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__.oAB({type:TextfieldConfiguratorOccModule}),TextfieldConfiguratorOccModule.\u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__.cJS({providers:[{provide:ConfiguratorTextfieldAdapter,useClass:OccConfiguratorTextfieldAdapter},{provide:CONFIGURATION_TEXTFIELD_NORMALIZER,useExisting:OccConfiguratorTextfieldNormalizer,multi:!0},{provide:CONFIGURATION_TEXTFIELD_ADD_TO_CART_SERIALIZER,useExisting:OccConfiguratorTextfieldAddToCartSerializer,multi:!0},{provide:CONFIGURATION_TEXTFIELD_UPDATE_CART_ENTRY_SERIALIZER,useExisting:OccConfiguratorTextfieldUpdateCartEntrySerializer,multi:!0}],imports:[_angular_common__WEBPACK_IMPORTED_MODULE_12__.ez,_spartacus_core__WEBPACK_IMPORTED_MODULE_1__.pEA.withConfigFactory(defaultOccConfiguratorTextfieldConfigFactory)]});class TextfieldConfiguratorModule{}__name(TextfieldConfiguratorModule,"TextfieldConfiguratorModule"),TextfieldConfiguratorModule.\u0275fac=__name(function(t){return new(t||TextfieldConfiguratorModule)},"TextfieldConfiguratorModule_Factory"),TextfieldConfiguratorModule.\u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__.oAB({type:TextfieldConfiguratorModule}),TextfieldConfiguratorModule.\u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__.cJS({imports:[TextfieldConfiguratorCoreModule,TextfieldConfiguratorComponentsModule,TextfieldConfiguratorOccModule]})}};