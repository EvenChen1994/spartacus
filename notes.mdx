# Checkout

## TODO (pre how to roll checkout discussion - phase 1)

- consistent naming on facade methods returing state (should include state in name?)
- optimize mutliple query events reloads/resets (to avoid cancelled requests)
- future plans after deprecations/braking changes

## TODO (details nice to have in actual spartacus release of new checkout)

- multiple calls for setting cost center (user cost centers emits multiple times) - 2 calls for setting delivery address
- why we LoadCart on failed clearDeliveryMode call
- clearCheckoutDeliveryMode actually incremented/decremented cart process

- try to remove all store dispatches from checkout services
- outlet for order-confirmation-thank-you component (to avoid exteding)
- normalize naming of files/exported things from scheduled replenishment and b2b entry point
- schematics for scheduled replenishment
- clear fields in occ endpoint configs that are no longer needed
- check feature config service in constructors
- adapter normalize error for delivery mode query PR
- error handling for delivery mode query PR for query
- getSelectedDeliveryMode was not working in supported delivery modes PR (basically code from review-submit component)
- put TODO to remove actions from setDeliveryAddressCommand after supported delivery modes query merged
- express checkout needs supported delivery modes query state (new method in service needed) - do in supported delivery mode processes PR
- move default-b2b-occ-config to b2b checkout entry point
- try to reproduce payment hasError reponse
- ask Bill about desired express checkout behaviour (should we always assign defaults or should we preserve user's selected options)
- should we rename checkout events with `Checkout` prefix?
- paymentTypes.\* translations in assets (should be in feature libs?)
- check my organization (creating new user in unit) - error in console (no feedback if it finished)

# Next session (not pair programming - near future)

- TODOs in:
- decide on trigger events vs facade calls in event listeners (eg. clearing delivery address on cost center set)
- decide where to handle events from another step (delivery mode in delivery address listener or vice versa)
- create umbrella event per step - deliveryaddressevent, deliverymodeevent, etc. all of the umbrella events should extend the checkoutevent
- scheduled replenishment events listener to add (move trigger from the scheduled-replenishment service)
- loader buttons in components (just better UX for checkout components)
- unify combineLatest with userId and cartId for all c&q in checkout services
- cleanup (exponensial backoff): JaloError retry for super query (add retry for it)

  ```json
  {
    "errors": [
      {
        "message": "item 8796098958229 no longer valid (was removed): object no longer valid",
        "type": "JaloObjectNoLongerValidError"
      }
    ]
  }
  ```

// jalo
// - 1 retry -> Jalo
// - 2 retry -> Jalo
// - 3 retry -> succ

// jalo
// - 1 retry -> different error (is there point to keep retrying?)
// just throw the error

// different error
// just throw without retries
