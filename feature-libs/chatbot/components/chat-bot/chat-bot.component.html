<div class="chat-window" *ngIf="isOpen">
  <div class="chat-container">
    <section class="chat-header">
      <div></div>
      <h2 class="title">{{ config?.botName }}</h2>
      <div><cx-icon (click)="toggle()" [type]="closeIcon"></cx-icon></div>
    </section>

    <div class="chat-messages-container">
      <ul class="chat-messages">
        <!-- Template for typing indicator -->

        <li
          class="chat-messages-message"
          *ngFor="let message of conversation$ | async"
          [ngClass]="{
            bot: message.author === 'BOT',
            customer: message.author === 'CUSTOMER'
          }"
        >
          <div class="avatar">
            <img [src]="config?.botAvatar" class="avatar-img" />
            <div class="avatar-message">
              <div>
                <div class="text-message">
                  <svg
                    viewBox="0 0 9 16"
                    xmlns="http://www.w3.org/2000/svg"
                    fill-rule="evenodd"
                    clip-rule="evenodd"
                    stroke-linejoin="round"
                    stroke-miterlimit="1.414"
                    class="icon-chat-arrow"
                  >
                    <path fill="none" d="M0 0h9v15.75H0z"></path>
                    <path d="M9 1.5v14.25L0 0l9 1.5z"></path>
                  </svg>
                  <div class="content">
                    <ng-container #indicator>
                      <div class="typing-indicator-dots">
                        <span
                          class="typing-indicator-dot typing-indicator-dot-1"
                          data-dot
                        ></span>
                        <span
                          class="typing-indicator-dot typing-indicator-dot-2"
                          data-dot
                        ></span>
                        <span
                          class="typing-indicator-dot typing-indicator-dot-3"
                          data-dot
                        ></span>
                      </div>
                    </ng-container>
                    <ng-conatiner #content>
                      {{ message.text | cxTranslate }}
                    </ng-conatiner>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </li>

        <div class="chat-options">
          <button
            *ngFor="let option of options$ | async"
            class="btn btn-primary btn-block"
            (click)="option.callback(option.text)"
          >
            {{ option.text | cxTranslate }}
          </button>
        </div>
      </ul>
    </div>
  </div>
  <cx-chat-bot-recommendations
    *ngIf="areRecommendationsOpen"
    [products$]="recommendations$"
    (closeRecommendations)="hideRecommendations()"
    (openProductPage)="toggle()"
  ></cx-chat-bot-recommendations>
</div>

<div class="chat-icon" (click)="toggle()" *ngIf="!isOpen">
  <div class="circle">
    <img [src]="config?.botAvatar" class="avatar-img" />
  </div>
</div>
