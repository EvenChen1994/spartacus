<ng-container
  *ngIf="{
    orderHistory: orders$ | async
  } as type"
>
  <ng-container *ngIf="type.orderHistory">
    <div>
      <!-- HEADER -->
      <div style="padding: 40px 0 0 0">
        <h2>
          {{ 'orderHistory.orderHistory' | cxTranslate }}
        </h2>
      </div>

      <!-- BODY -->
      <div class="cx-order-history-body">
        <ng-container
          *ngIf="type.orderHistory.pagination.totalResults > 0; else noOrder"
        >
          <!-- Select Form and Pagination Top -->
          <div class="cx-order-history-sort top">
            <label
              class="form-group"
              style="
                display: flex;
                justify-content: space-between;
                padding: 1rem 0;
                margin: 0;
                align-items: center;
                width: 40%;
              "
              ><span style="margin-inline-end: 0.5rem; flex: none">
                {{ 'orderHistory.sortBy' | cxTranslate }}
              </span>
              <cx-sorting
                style="width: 100%"
                [sortOptions]="type.orderHistory.sorts"
                [sortLabels]="getSortLabels() | async"
                (sortListEvent)="changeSortCode($event)"
                [selectedOption]="type.orderHistory.pagination.sort"
                placeholder="{{ 'orderHistory.sortBy' | cxTranslate }}"
                [ariaLabel]="'orderHistory.sortOrders' | cxTranslate"
                ariaControls="order-history-table"
              ></cx-sorting>
            </label>
            <div
              *ngIf="type.orderHistory.pagination.totalPages > 1"
              class="cx-order-history-pagination"
            >
              <cx-pagination
                [pagination]="type.orderHistory.pagination"
                (viewPageEvent)="pageChange($event)"
              ></cx-pagination>
            </div>
          </div>
          <!-- TABLE -->
          <table
            id="order-history-table"
            class="table"
            style="
              padding: 1.5rem 0 1.125rem 0;
              margin-bottom: 0;
              border-top: 1px solid;
              border-bottom: 1px solid;
            "
          >
            <thead class="cx-order-history-thead-mobile">
              <th
                scope="col"
                style="padding: 1.5rem 0 1.125rem 0; text-align: start"
              >
                {{ 'orderHistory.orderId' | cxTranslate }}
              </th>
              <th
                scope="col"
                style="padding: 1.5rem 0 1.125rem 0; text-align: start"
              >
                {{ 'orderHistory.date' | cxTranslate }}
              </th>
              <th scope="col">
                {{ 'orderHistory.status' | cxTranslate }}
              </th>
              <th
                scope="col"
                style="padding: 1.5rem 0 1.125rem 0; text-align: start"
              >
                {{ 'orderHistory.buyer' | cxTranslate }}
              </th>
              <th
                scope="col"
                style="padding: 1.5rem 0 1.125rem 0; text-align: start"
              >
                {{ 'orderHistory.unit' | cxTranslate }}
              </th>
              <th
                scope="col"
                style="padding: 1.5rem 0 1.125rem 0; text-align: end"
              >
                {{ 'orderHistory.total' | cxTranslate }}
              </th>
            </thead>
            <tbody>
              <tr
                *ngFor="let order of type.orderHistory.orders"
                (click)="goToOrderDetail(order)"
              >
                <td style="text-align: start; width: 15%; padding: 1.625rem 0">
                  <div style="text-transform: uppercase; display: none">
                    {{ 'orderHistory.orderId' | cxTranslate }}
                  </div>
                  <a
                    [routerLink]="
                      {
                        cxRoute: 'orderDetails',
                        params: order
                      } | cxUrl
                    "
                    style="text-decoration: underline; color: #212738"
                  >
                    {{ order?.code }}</a
                  >
                </td>
                <td style="text-align: start; width: 15%; padding: 1.625rem 0">
                  <div style="text-transform: uppercase; display: none">
                    {{ 'orderHistory.date' | cxTranslate }}
                  </div>
                  <a
                    [routerLink]="
                      {
                        cxRoute: 'orderDetails',
                        params: order
                      } | cxUrl
                    "
                    style="text-decoration: none; color: #212738"
                    >{{ order?.placed | cxDate: 'longDate' }}</a
                  >
                </td>
                <td
                  style="
                    text-align: start;
                    width: 25%;
                    padding: 1.625rem 0;
                    display: inline-block;
                  "
                >
                  <div style="text-transform: uppercase; display: none">
                    {{ 'orderHistory.status' | cxTranslate }}
                  </div>
                  <a
                    [routerLink]="
                      {
                        cxRoute: 'orderDetails',
                        params: order
                      } | cxUrl
                    "
                    style="text-decoration: none; color: #212738"
                  >
                    {{
                      'orderDetails.statusDisplay_' + order?.statusDisplay
                        | cxTranslate
                    }}</a
                  >
                </td>
                <td style="text-align: start; width: 15%; padding: 1.625rem 0">
                  <div style="text-transform: uppercase; display: none">
                    {{ 'orderHistory.buyer' | cxTranslate }}
                  </div>
                  <a
                    [routerLink]="
                      {
                        cxRoute: 'orderDetails',
                        params: order
                      } | cxUrl
                    "
                    style="text-decoration: none; color: #212738"
                  >
                    {{ order?.orgCustomer?.name }}</a
                  >
                </td>
                <td style="text-align: start; width: 15%; padding: 1.625rem 0">
                  <div style="text-transform: uppercase; display: none">
                    {{ 'orderHistory.unit' | cxTranslate }}
                  </div>
                  <a
                    [routerLink]="
                      {
                        cxRoute: 'orderDetails',
                        params: order
                      } | cxUrl
                    "
                    style="text-decoration: none; color: #212738"
                  >
                    {{ order?.orgUnit?.name }}</a
                  >
                </td>
                <td style="width: 15%; padding: 1.625rem 0; text-align: end">
                  <div style="text-transform: uppercase; display: none">
                    {{ 'orderHistory.total' | cxTranslate }}
                  </div>
                  <a
                    [routerLink]="
                      {
                        cxRoute: 'orderDetails',
                        params: order
                      } | cxUrl
                    "
                    style="text-decoration: none; color: #212738"
                  >
                    {{ order?.total.formattedValue }}</a
                  >
                </td>
              </tr>
            </tbody>
          </table>
          <!-- Select Form and Pagination Bottom -->
          <div class="cx-order-history-sort bottom">
            <div
              *ngIf="type.orderHistory.pagination.totalPages > 1"
              class="cx-order-history-pagination"
            >
              <cx-pagination
                [pagination]="type.orderHistory.pagination"
                (viewPageEvent)="pageChange($event)"
              ></cx-pagination>
            </div>
          </div>
        </ng-container>

        <!-- NO ORDER CONTAINER -->
        <ng-template #noOrder>
          <div
            *ngIf="isLoaded$ | async"
            style="display: flex; flex-wrap: wrap; min-height: 415px"
          >
            <div>
              <div>{{ 'orderHistory.noOrders' | cxTranslate }}</div>
              <a
                [routerLink]="{ cxRoute: 'home' } | cxUrl"
                routerLinkActive="active"
                class="btn btn-primary btn-block"
                style="margin: 1.25rem 0"
                >{{ 'orderHistory.startShopping' | cxTranslate }}</a
              >
            </div>
          </div>
        </ng-template>
      </div>
    </div>
  </ng-container>
</ng-container>
