<div *ngIf="loading$ | async; else consentManagementForm">
  <div class="cx-spinner">
    <cx-spinner></cx-spinner>
  </div>
</div>
<ng-template #consentManagementForm>
  <div role="status" [attr.aria-label]="'common.loaded' | cxTranslate"></div>
  <ng-container *ngIf="templateList$ | async as templateList">
    <div class="cx-consent-toggles">
      <div class="consent-form-container">
        <div class="header">
          {{ 'newConsentManagement.header' | cxTranslate }}
        </div>
        <div class="cx-consent-action-links">
          <button
            tabindex="0"
            class="btn btn-link cx-action-link"
            (click)="rejectAll(templateList)"
          >
            {{ 'newConsentManagement.clearAll' | cxTranslate }}
          </button>
          <button
            tabindex="0"
            class="btn btn-link cx-action-link"
            (click)="allowAll(templateList)"
          >
            {{ 'newConsentManagement.selectAll' | cxTranslate }}
          </button>
        </div>
        <cx-new-consent-management-form
          *ngFor="let consentTemplate of templateList"
          [consentTemplate]="consentTemplate"
          [requiredConsents]="requiredConsents"
          (consentChanged)="onConsentChange($event)"
        ></cx-new-consent-management-form>
      </div>
    </div>
  </ng-container>
</ng-template>
